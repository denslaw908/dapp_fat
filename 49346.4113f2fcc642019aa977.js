"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[49346],{203723:(e,t,s)=>{s.d(t,{financialPeriodToShortString:()=>n,financialPeriodToString:()=>l});var i=s(650151),r=s(444372);function l(e){switch(e){case"FQ":return r.t(null,void 0,s(934673));case"FY":return r.t(null,void 0,s(984847));case"FH":return r.t(null,void 0,s(228727));case"TTM":return r.t(null,void 0,s(284634))}(0,i.ensureNever)(e)}function n(e){switch(e){case"FQ":return r.t(null,void 0,s(505581));case"FY":return r.t(null,void 0,s(560729));case"FH":return r.t(null,void 0,s(422740));case"TTM":return r.t(null,void 0,s(284634))}(0,i.ensureNever)(e)}},517241:(e,t,s)=>{function i(e,t,s){let i=e[`${t}#${s}`]||null;return null===i&&(i=e[t]||null),null===i&&Object.keys(e).forEach((s=>{null===i&&s.startsWith(`${t}#`)&&(i=e[s]||null)})),i}s.d(t,{getObsoleteIdeaSymbolInfo:()=>i})},576722:(e,t,s)=>{s.r(t),s.d(t,{StudyCompare:()=>B});var i=s(650151),r=s(517241),l=s(756163),n=s(631114),o=s(388741),a=s(905520),u=s(955722),d=s(931924),h=s(980057),c=s(597331),m=s(316250),y=s(534328);const b=d.enabled("force_exchange_as_title");class _ extends c.PriceAxisView{constructor(e,t){super(),this._studyCompare=e,this._data=t}_updateRendererData(e,t,s){e.visible=!1,t.visible=!1;const r=this._studyCompare.priceScale(),l=this._studyCompare.lastValueData(this._data.plotIndex,!1);if(l.noData||null===r||r.isEmpty())return;const n=this._studyCompare.model(),o=n.timeScale().visibleBarsStrictRange(),a=n.mainSeries().bars().lastIndex();if(null===o||null===a)return;if(a<=o.lastBar())s.background=(0,y.resetTransparency)(l.color),s.textColor=this.generateTextColor(s.background),s.borderColor=void 0,e.borderVisible=!1,t.borderVisible=!1;else{const r=n.backgroundColorAtYPercentFromTop(l.coordinate/(0,i.ensureNotNull)(n.paneForSource(this._studyCompare)).height());s.background=r,s.textColor=(0,y.resetTransparency)(l.color),s.borderColor=s.textColor,e.borderVisible=!0,t.borderVisible=!0}s.coordinate=l.coordinate,s.floatCoordinate=l.floatCoordinate;const u=n.properties().childs().scalesProperties.childs();u.showSeriesLastValue.value()&&(e.text=(0,m.getCurrentModePriceText)(r,l),u.seriesLastValueMode.value()!==h.PriceAxisLastValueMode.LastPriceAndPercentageValue?e.secondLine="":e.secondLine=(0,m.getOppositeModePriceText)(r,l),e.visible=!0),t.text="",u.showSymbolLabels.value()&&(t.text=this._paneText(),t.visible=t.text.length>0)}_paneText(){let e="";const t=this._studyCompare.symbolInfo();return b?e=(0,o.displayedSymbolExchange)(t):this._studyCompare.model().properties().childs().scalesProperties.childs().showSymbolLabels.value()&&(e=(0,o.displayedSymbolName)(t)),e}}var p=s(444372),S=s(844859),v=s(75618),g=s(87913),C=s(638456),I=s(529751),P=s(536794),f=s(816433);const T=C.CheckMobile.any();class V extends v.StudyValuesProvider{constructor(e,t){super(e,t),this._emptyValues[0].title=e.guiPlotName(f.TitleDisplayTarget.StatusLine,"")}getValues(e){return(0,
P.isNumber)(e)||(this._showLastPriceAndChangeOnly()?e=this._study.data().lastIndex():(e=this._model.crosshairSource().appliedIndex(),(0,P.isNumber)(e)||(e=this._study.data().lastIndex()))),super.getValues(e)}_hideValues(){return!1}_showLastPriceAndChangeOnly(){return T&&(null===this._model.crosshairSource().pane||(0,I.isLineToolName)(g.tool.value())||null!==this._model.lineBeingEdited())}}class w extends S.StudyDataWindowView{constructor(e,t){super(e,t),this._studyCompare=e}_hideValues(){return!1}_createValuesProvider(e,t){return new V(e,t)}}var x=s(437642),L=s(326301);class A extends w{constructor(e,t){super(e,t),this._additional=null,this._showSeriesOHLC=t.properties().childs().paneProperties.childs().legendProperties.childs().showSeriesOHLC,this._showSeriesOHLC.subscribe(this,(()=>this.update((0,x.sourceChangeEvent)(e.id()))))}areValuesVisible(){return this._showSeriesOHLC.value()}destroy(){this._showSeriesOHLC.unsubscribeAll(this)}additional(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._additional}_updateImpl(){{const e=(0,L.getDataVendorString)(this._studyCompare.symbolInfo());this._additional=e?p.t(null,void 0,s(957131))+" "+e:null}super._updateImpl()}}var O=s(197860),F=s(191914),R=s(681240);class E extends R.StudyStatusProvider{getSplitTitle(){return this._source.titleInParts(f.TitleDisplayTarget.StatusLine,!0,void 0,!1,!1)}text(){return this._source.isActualInterval()?this._source.isFailed()?`${this._source.title(f.TitleDisplayTarget.StatusLine,!0,void 0,!1,!1)}: ${this.sourceStatusText()}`:`${this._source.title(f.TitleDisplayTarget.StatusLine,!0,void 0,!1,!1)} ${this.sourceStatusText()}`:this._source.title(f.TitleDisplayTarget.StatusLine,!0,void 0,!1,!1)}}var k=s(616427),U=s(641208),D=s(820028);const H=d.enabled("study_overlay_compare_legend_option"),N=d.enabled("force_exchange_as_title"),$=!d.enabled("hide_study_compare_legend_item"),M=d.enabled("hide_unresolved_symbols_in_legend");class B extends n.Study{constructor(e,t,s,i,r,l){super(e,function(e){return e.hasChild("currencyId")||e.addChild("currencyId",new a.Property(null)),e.hasChild("unitId")||e.addChild("unitId",new a.Property(null)),e.addExcludedKey("currencyId",1),e.addExcludedKey("unitId",1),e}(t),s,i,r,l),this._isActingAsSymbolSource=new D.WatchedValue(!0),this._realignToolsLastParams=null,this._lastResolvedSymbolSource="",this.properties().childs().minTick.subscribe(null,(()=>this._recreatePriceFormattingDependencies())),this.properties().childs().minTick.subscribe(null,(()=>this._model.fullUpdate())),this.properties().childs().currencyId.subscribe(this,this._onCurrencyChanged),this.properties().childs().unitId.subscribe(this,this._onUnitChanged),this._symbolResolvingActive=new D.WatchedValue(!1),this._symbolHibernated=new D.WatchedValue(!1),e.mainSeries().onIntervalChanged().subscribe(this,(()=>e.realignLineTools(this)))}destroy(){this._model.mainSeries().onIntervalChanged().unsubscribeAll(this),super.destroy()}properties(){return this._properties}isActingAsSymbolSource(){
return this._isActingAsSymbolSource.readonly()}symbolParams(){return(0,k.symbolParams)(this)}compareSymbolParams(e){return(0,k.compareSymbolParams)(this,e,this._model.unitConversionEnabled())}async setSymbolParams(e){this._setSymbolCurrencyUnitInternal(e)}symbol(){return this.properties().childs().inputs.childs().symbol.value()}symbolChanged(){return this.properties().childs().inputs.childs().symbol}onSymbolIntervalChanged(){return this.symbolChanged()}setSymbol(e){this.setSymbolParams({symbol:e})}symbolInfo(){if(!this._resolvedSymbols)return null;const e=this.symbol();if(!e)return null;let t;return t=this._model.isSnapshot()?this._resolvedSymbols.___snapshot||null:this._resolvedSymbols[this._getSymbolForResolve(e)]||null,this._model.isSnapshot()&&null===t&&(t=(0,r.getObsoleteIdeaSymbolInfo)(this._resolvedSymbols,e,this.currency()),null!==t&&(this._resolvedSymbols.___snapshot=t)),t}symbolResolved(){return this.symbolsResolved()}symbolResolvingActive(){return this._symbolResolvingActive}symbolHibernated(){return this._symbolHibernated}isVisible(){const e=super.isVisible();return this._symbolHibernated.setValue(!e),e}symbolSameAsCurrent(e){return(0,k.symbolSameAsCurrent)(e,this.symbolInfo())}symbolSameAsResolved(e){return(0,U.symbolSameAsResolved)(e,this._lastResolvedSymbolSource,this.symbol())}currency(){return this.properties().childs().currencyId.value()||null}setCurrency(e){this.setSymbolParams({currency:e})}isConvertedToOtherCurrency(){return(0,o.isConvertedToOtherCurrency)(this.symbolInfo())}unit(){return this.properties().childs().unitId.value()||null}setUnit(e){this.setSymbolParams({unit:e})}isConvertedToOtherUnit(){return(0,o.isConvertedToOtherUnit)(this.symbolInfo(),this._model.unitConversionEnabled())}style(){return 2}setStyle(e){}interval(){return this._model.mainSeries().interval()}setInterval(e){}symbolSource(){return this}valueAt(e,t){return this.data().search(e)?.value[1]??null}state(e,t){const s=super.state(e,t);this._model.unitConversionEnabled()||delete s.state.unitId;const r=this.symbol();return s.state.inputs.symbol=(0,o.symbolToSaveInState)(this.symbolInfo()??this._model.chartApi().lastSymbolResolveInfo(r),r),e&&((0,i.ensureDefined)(s.data).symbols={___snapshot:this.symbolInfo()||void 0}),s}symbolTitle(e,t,s){return this.title(e,!0,{},!1,t)}titleInParts(e,t,s,i,r){const l=this._titleInParts(e,t,s,i,r);return[[l[0],...l[1]??[]].join(", ")]}tags(){const e=this.symbol();return e?[e]:[]}statusView(){return $?super.statusView():null}guiPlotName(e,t){return this.properties().childs().inputs.childs().symbol.value()}canOverrideMinTick(){return!0}canBeHiddenByGlobalFlag(){return!1}legendValuesProvider(){return new V(this,this.model())}statusProvider(e){return new E(this)}measureUnitId(){return(0,o.measureUnitId)(this.symbolInfo())}getSymbolString(e){return void 0===e&&(e=this._getSymbolForApi(this.symbol())),(0,u.encodeExtendedSymbolOrGetSimpleSymbolString)(this._getSymbolObject(e))}_createPriceAxisView(e){return new _(this,{plotIndex:"compare"})}_createViews(){
this._legendView||(this._legendView=new A(this,this._model)),this._dataWindowView||(this._dataWindowView=new w(this,this._model)),this._statusView||(this._statusView=new O.StudyStatusView(this)),super._createViews()}_onUnitChanged(){"alwaysOff"!==(0,l.currencyUnitVisibilityProperty)().value()&&this._model.fullUpdate(),this._model.unitConversionEnabled()&&this.isStarted()&&this._tryChangeInputs(),this._unitChanged.fire()}_getSymbolObject(e){const t=super._getSymbolObject(e),s=this.currency();null!==s&&(t["currency-id"]=s);const i=this.unit();return this._model.unitConversionEnabled()&&null!==i&&(t["unit-id"]=i),t}_onSymbolResolvingStart(e,t){this._lastResolvedSymbolSource=t,super._onSymbolResolvingStart(e,t),this._symbolResolvingActive.setValue(!0)}_onSymbolError(){super._onSymbolError(),this._symbolResolvingActive.setValue(!1)}_onSymbolResolved(e,t,s){super._onSymbolResolved(e,t,s),this._recreatePriceFormattingDependencies();const i=t===this.symbol()?(0,o.extractSymbolNameFromSymbolInfo)(s,this.symbol()):null,r=(0,o.symbolCurrency)(s),l=(0,o.symbolUnit)(s,this._model.unitConversionEnabled());this._setSymbolCurrencyUnitInternal({symbol:i??void 0,currency:r,unit:l},s),this._symbolResolvingActive.setValue(!1)}async _changeInputsImpl(e,t){await super._changeInputsImpl(e,t),this._realignLineToolsIfParamsChanged()}_createStudyOnServer(){const e=super._createStudyOnServer();return this._realignLineToolsIfParamsChanged(),e}_tryCreateFormatter(){F.customFormatters?.priceFormatterFactory?.(this.symbolInfo(),this.properties().childs().minTick.value());return(0,o.createSeriesFormatter)(this.symbolInfo(),this.properties().childs().minTick.value())}_tryCreateDefaultFormatter(){return(0,o.createSeriesFormatter)(this.symbolInfo(),"default")}_titleInParts(e,t,s,i,r){const l=this.symbolInfo();return[this._getSymbolTitlePart(l),[this._getExchangeTitlePart(l,r),this._getPriceSourceTitlePart(l)].filter((e=>null!==e))]}_skipHistogramBaseOnAutoScale(){return!0}_getSymbolTitlePart(e){if(null===e)return M?"":this.properties().childs().inputs.childs().symbol.value();const t=(0,o.getSymbolExchange)(e);if(N&&void 0!==t)return t;if(H)switch(this._model.mainSeries().symbolTextSourceProxyProperty().value()){case"description":return e.description;case"ticker-and-description":return`${e.name}, ${e.description}`;case"long-description":return e.long_description??e.description}return e.name}_getExchangeTitlePart(e,t){return null===e||t?null:(0,o.getSymbolExchange)(e)}_getPriceSourceTitlePart(e){return null}_setSymbolCurrencyUnitInternal(e,t){const{symbol:s,currency:i,unit:r}=e,l=this.properties().childs(),n=l.inputs.childs().symbol.value(),a=l.currencyId.value(),u=l.unitId.value();if(void 0!==s&&l.inputs.childs().symbol.setValueSilently(s),void 0!==i&&l.currencyId.setValueSilently(i),void 0!==r&&l.unitId.setValueSilently(r),t)this._resolvedSymbolsByInput[this.symbol()]=t,this._resolvedSymbols[this._getSymbolForResolve(this.symbol())]=t,this._realignToolsLastParams=null;else{const e=this.symbolInfo();null!==e&&(l.currencyId.setValueSilently((0,
o.symbolCurrency)(e)),l.unitId.setValueSilently((0,o.symbolUnit)(e,this._model.unitConversionEnabled())))}l.inputs.childs().symbol.value()!==n&&l.inputs.childs().symbol.fireChanged(),l.currencyId.value()!==a&&l.currencyId.fireChanged(),l.unitId.value()!==u&&l.unitId.fireChanged(),this._realignLineToolsIfParamsChanged()}_realignLineToolsIfParamsChanged(){let e=null===this._realignToolsLastParams;if(null!==this._realignToolsLastParams){const t=this.compareSymbolParams(this._realignToolsLastParams);e=t.symbolChanged||t.intervalChanged||t.currencyChanged||t.unitChanged}e&&(this._model.realignLineTools(this),this._realignToolsLastParams=this.symbolParams())}}},641208:(e,t,s)=>{function i(e,t,s){return e===t||e===s}s.d(t,{symbolSameAsResolved:()=>i})}}]);