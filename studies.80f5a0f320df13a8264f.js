(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[57539,75514],{963894:(e,t)=>{"use strict";t.CircularBuffer=void 0;var s=function(){function e(e){this._start=0,this._size=0,this._buffer=new Array(e)}return e.prototype.size=function(){return this._size},e.prototype.capacity=function(){return this._buffer.length},e.prototype.enqueue=function(e){this._size<this._buffer.length?this._size++:this._start=(this._start+1)%this._buffer.length;var t=(this._start+this._size-1)%this._buffer.length;this._buffer[t]=e},e.prototype.dequeue=function(){if(0===this._size)throw new Error("Buffer is empty");var e=this._buffer[this._start];return this._buffer[this._start]=void 0,this._start=(this._start+1)%this._buffer.length,this._size--,e},e.prototype.get=function(e){if(e>=this._size)throw new Error("Index is out of range");var t=(this._start+e)%this._buffer.length;return this._buffer[t]},e.prototype.forEach=function(e,t){for(var s=0;s<this._size;s++){var i=(this._start+s)%this._buffer.length;e.call(t,this._buffer[i],i,this)}},e.prototype.clear=function(){for(var e=this._buffer.length,t=0;t<e;t++)this._buffer[t]=void 0;this._start=0,this._size=0},e}();t.CircularBuffer=s},497754:(e,t)=>{var s;!function(){"use strict";var i={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var s=arguments[t];if(s){var o=typeof s;if("string"===o||"number"===o)e.push(s);else if(Array.isArray(s)&&s.length){var n=r.apply(null,s);n&&e.push(n)}else if("object"===o)for(var a in s)i.call(s,a)&&s[a]&&e.push(a)}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(s=function(){return r}.apply(t,[]))||(e.exports=s)}()},132734:(e,t,s)=>{"use strict";s.d(t,{Icon:()=>r});var i=s(50959);const r=i.forwardRef(((e,t)=>{const{icon:s="",title:r,ariaLabel:o,ariaLabelledby:n,ariaHidden:a,...l}=e,u=!!(r||o||n);return i.createElement("span",{role:"img",...l,ref:t,"aria-label":o,"aria-labelledby":n,"aria-hidden":a||!u,title:r,dangerouslySetInnerHTML:{__html:s}})}))},79205:(e,t,s)=>{"use strict";s.d(t,{Icon:()=>i.Icon});var i=s(132734)},867023:(e,t,s)=>{"use strict";s.d(t,{ErrorResponse:()=>i});class i{constructor(e){this._status=e.status,this._statusText=e.statusText||""}getInfo(){return{name:this.name,status:this._status,statusText:this._statusText,message:this.message}}}},685503:(e,t,s)=>{"use strict";s.d(t,{HttpErrorResponse:()=>r});var i=s(867023);class r extends i.ErrorResponse{constructor(e){super(e),this.name="HttpErrorResponse",this._status>=200&&this._status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`}}},414879:(e,t,s)=>{"use strict";var i,r;s.r(t),s.d(t,{Months:()=>r,WeekDays:()=>i}),function(e){e[e.SUNDAY=1]="SUNDAY",e[e.MONDAY=2]="MONDAY",e[e.TUESDAY=3]="TUESDAY",e[e.WEDNESDAY=4]="WEDNESDAY",e[e.THURSDAY=5]="THURSDAY",e[e.FRIDAY=6]="FRIDAY",e[e.SATURDAY=7]="SATURDAY"}(i||(i={})),function(e){e[e.JANUARY=0]="JANUARY",e[e.FEBRUARY=1]="FEBRUARY",e[e.MARCH=2]="MARCH",e[e.APRIL=3]="APRIL",
e[e.MAY=4]="MAY",e[e.JUNE=5]="JUNE",e[e.JULY=6]="JULY",e[e.AUGUST=7]="AUGUST",e[e.SEPTEMBER=8]="SEPTEMBER",e[e.OCTOBER=9]="OCTOBER",e[e.NOVEMBER=10]="NOVEMBER",e[e.DECEMBER=11]="DECEMBER"}(r||(r={}))},936410:(e,t,s)=>{"use strict";s.r(t),s.d(t,{monthsFullNames:()=>o,monthsShortNames:()=>n,weekDaysFullNames:()=>a,weekDaysMiniNames:()=>u,weekDaysShortNames:()=>l});var i=s(444372),r=s(414879);const o={[r.Months.JANUARY]:i.t(null,void 0,s(100200)),[r.Months.FEBRUARY]:i.t(null,void 0,s(581069)),[r.Months.MARCH]:i.t(null,void 0,s(193878)),[r.Months.APRIL]:i.t(null,void 0,s(528896)),[r.Months.MAY]:i.t(null,void 0,s(125734)),[r.Months.JUNE]:i.t(null,void 0,s(661487)),[r.Months.JULY]:i.t(null,void 0,s(206608)),[r.Months.AUGUST]:i.t(null,void 0,s(811081)),[r.Months.SEPTEMBER]:i.t(null,void 0,s(632179)),[r.Months.OCTOBER]:i.t(null,void 0,s(137997)),[r.Months.NOVEMBER]:i.t(null,void 0,s(604607)),[r.Months.DECEMBER]:i.t(null,void 0,s(890082))},n={[r.Months.JANUARY]:i.t(null,void 0,s(562310)),[r.Months.FEBRUARY]:i.t(null,void 0,s(302507)),[r.Months.MARCH]:i.t(null,void 0,s(92767)),[r.Months.APRIL]:i.t(null,void 0,s(227072)),[r.Months.MAY]:i.t(null,{context:"short"},s(13132)),[r.Months.JUNE]:i.t(null,void 0,s(800429)),[r.Months.JULY]:i.t(null,void 0,s(853786)),[r.Months.AUGUST]:i.t(null,void 0,s(546450)),[r.Months.SEPTEMBER]:i.t(null,void 0,s(806816)),[r.Months.OCTOBER]:i.t(null,void 0,s(912179)),[r.Months.NOVEMBER]:i.t(null,void 0,s(526899)),[r.Months.DECEMBER]:i.t(null,void 0,s(532084))},a={[r.WeekDays.SUNDAY]:i.t(null,void 0,s(661480)),[r.WeekDays.MONDAY]:i.t(null,void 0,s(419573)),[r.WeekDays.TUESDAY]:i.t(null,void 0,s(682160)),[r.WeekDays.WEDNESDAY]:i.t(null,void 0,s(894226)),[r.WeekDays.THURSDAY]:i.t(null,void 0,s(879137)),[r.WeekDays.FRIDAY]:i.t(null,void 0,s(503570)),[r.WeekDays.SATURDAY]:i.t(null,void 0,s(130348))},l={[r.WeekDays.SUNDAY]:i.t(null,void 0,s(377493)),[r.WeekDays.MONDAY]:i.t(null,void 0,s(837150)),[r.WeekDays.TUESDAY]:i.t(null,void 0,s(811916)),[r.WeekDays.WEDNESDAY]:i.t(null,void 0,s(711532)),[r.WeekDays.THURSDAY]:i.t(null,void 0,s(771388)),[r.WeekDays.FRIDAY]:i.t(null,void 0,s(922928)),[r.WeekDays.SATURDAY]:i.t(null,void 0,s(232273))},u={[r.WeekDays.SUNDAY]:i.t(null,{context:"day_of_week"},s(875005)),[r.WeekDays.MONDAY]:i.t(null,{context:"day_of_week"},s(930961)),[r.WeekDays.TUESDAY]:i.t(null,{context:"day_of_week"},s(244254)),[r.WeekDays.WEDNESDAY]:i.t(null,{context:"day_of_week"},s(392578)),[r.WeekDays.THURSDAY]:i.t(null,{context:"day_of_week"},s(608765)),[r.WeekDays.FRIDAY]:i.t(null,{context:"day_of_week"},s(923230)),[r.WeekDays.SATURDAY]:i.t(null,{context:"day_of_week"},s(894748))}},675128:(e,t,s)=>{"use strict";function i(e){let t=null;return()=>(null===t&&(t=e()),t)}s.d(t,{lazyValue:()=>i})},232650:(e,t,s)=>{"use strict";s.d(t,{openFinancialsWebview:()=>c});var i=s(670926),r=s(675128),o=s(862170),n=s(207815)
;const a=new Set(["number_of_employees","web_site_url","founded","ceo","market_cap_basic","dividends_yield","price_earnings_ttm","earnings_per_share_basic_ttm","currency_code","fundamental_currency_code","float_shares_outstanding","total_shares_outstanding","total_revenue_fy_h","total_revenue_fq_h","total_revenue_fh_h","net_income_fy_h","net_income_fq_h","net_income_fh_h","total_assets_fy_h","total_assets_fq_h","total_assets_fh_h","total_liabilities_fy_h","total_liabilities_fq_h","total_liabilities_fh_h","cash_f_operating_activities_fy_h","cash_f_operating_activities_fq_h","cash_f_operating_activities_fh_h","cash_f_investing_activities_fy_h","cash_f_investing_activities_fq_h","cash_f_investing_activities_fh_h","cash_f_financing_activities_fy_h","cash_f_financing_activities_fq_h","cash_f_financing_activities_fh_h","fiscal_period_fy_h","fiscal_period_fq_h","fiscal_period_fh_h","interest_income_fy_h","interest_income_fq_h","interest_income_fh_h","non_interest_income_fy_h","non_interest_income_fq_h","non_interest_income_fh_h","earnings_release_date_fq_h","earnings_release_date_fy_h","earnings_release_date_fh_h","earnings_release_next_date_fq","earnings_release_next_date_fy","earnings_release_next_date_fh","earnings_release_next_time","earnings_release_next_date","is_next_earnings_release_date_estimated","earnings_per_share_forecast_next_fq","earnings_per_share_forecast_next_fy","earnings_per_share_forecast_next_fh","earnings_per_share_forecast_fq_h","earnings_per_share_forecast_fy_h","earnings_per_share_forecast_fh_h","earnings_per_share_fq_h","earnings_per_share_fy_h","earnings_per_share_fh_h","earnings_fiscal_period_fq_h","earnings_fiscal_period_fy_h","earnings_fiscal_period_fh_h","next_earnings_fiscal_period_fq","next_earnings_fiscal_period_fy","next_earnings_fiscal_period_fh","revenue_fq_h","revenue_fy_h","revenue_fh_h","revenue_forecast_fq_h","revenue_forecast_fy_h","revenue_forecast_fh_h","revenue_forecast_next_fq","revenue_forecast_next_fy","revenue_forecast_next_fh","fundamental_currency_code","dividend_payout_ratio_ttm","dividends_yield_current","dividend_ex_date_upcoming","dividend_amount_upcoming","dividend_amount_recent","dividend_ex_date_recent","dividend_amount_h","dividend_payment_date_upcoming","dividend_payment_date_recent","total_revenue_fy","gross_profit_fy","ebitda_fy","ebit_fy","net_income_fy","fiscal_period_fy","fiscal_period_fy_h","fiscal_period_fq_h","fiscal_period_fh_h","total_debt_fy_h","total_debt_fq_h","total_debt_fh_h","free_cash_flow_fy_h","free_cash_flow_fq_h","free_cash_flow_fh_h","cash_n_equivalents_fy_h","cash_n_equivalents_fq_h","cash_n_equivalents_fh_h","loans_net_fy_h","loans_net_fq_h","loans_net_fh_h","total_deposits_fy_h","total_deposits_fq_h","total_deposits_fh_h","loan_loss_allowances_fy_h","loan_loss_allowances_fq_h","loan_loss_allowances_fh_h","insurance_reserves_fy_h","insurance_reserves_fq_h","insurance_reserves_fh_h","policy_claims_fy_h","policy_claims_fq_h","policy_claims_fh_h","premiums_earned_fy_h","premiums_earned_fq_h","premiums_earned_fh_h","common_equity_tier1_ratio_fy_h","common_equity_tier1_ratio_fq_h","common_equity_tier1_ratio_fh_h","tier1_capital_ratio_fy_h","tier1_capital_ratio_fq_h","tier1_capital_ratio_fh_h","total_capital_ratio_fy_h","total_capital_ratio_fq_h","total_capital_ratio_fh_h","fiscal_period_fy_h","fiscal_period_fq_h","fiscal_period_fh_h","reserve_to_total_capital_fy_h","reserve_to_total_capital_fq_h","reserve_to_total_capital_fh_h","unearned_premium_to_total_capital_fy_h","unearned_premium_to_total_capital_fq_h","unearned_premium_to_total_capital_fh_h","fundamental_currency_code","total_current_assets_fy","total_current_assets_fq","total_current_assets_fh","total_current_liabilities_fy","total_current_liabilities_fq","total_current_liabilities_fh","total_non_current_assets_fy","total_non_current_assets_fq","total_non_current_assets_fh","total_non_current_liabilities_fy","total_non_current_liabilities_fq","total_non_current_liabilities_fh","fiscal_period_fy","fiscal_period_fq","fiscal_period_fh","fundamental_currency_code","price_earnings_fq_h","price_earnings_fy_h","price_earnings_fh_h","price_sales_fq_h","price_sales_fy_h","price_sales_fh_h","fiscal_period_fy_h","fiscal_period_fq_h","fiscal_period_fh_h","market_cap_basic","diluted_net_income_ttm","total_revenue_ttm","price_earnings_current","price_sales_current","fundamental_currency_code","revenue_seg_by_business_h","revenue_seg_by_region_h","fiscal_period_fy","interest_income_fy","interest_income_fq","interest_income_fh","non_interest_income_fy","non_interest_income_fq","non_interest_income_fh","interest_expense_fy","interest_expense_fq","interest_expense_fh","loan_loss_provision_fy","loan_loss_provision_fq","loan_loss_provision_fh","non_interest_expense_fy","non_interest_expense_fq","non_interest_expense_fh","non_oper_income_fy","non_oper_income_fq","non_oper_income_fh","unusual_expense_inc_fy","unusual_expense_inc_fq","unusual_expense_inc_fh","pretax_income_fy","pretax_income_fq","pretax_income_fh","total_revenue_fy","total_revenue_fq","total_revenue_fh","gross_profit_fy","gross_profit_fq","gross_profit_fh","net_income_fy","net_income_fq","net_income_fh","cost_of_goods_fy","cost_of_goods_fq","cost_of_goods_fh","operating_expenses_fy","operating_expenses_fq","operating_expenses_fh","oper_income_fy","oper_income_fq","oper_income_fh","total_non_oper_income_fy","total_non_oper_income_fq","total_non_oper_income_fh","income_tax_fy","income_tax_fq","income_tax_fh","after_tax_other_income_fy","after_tax_other_income_fq","after_tax_other_income_fh","fiscal_period_fy","fiscal_period_fq","fiscal_period_fh","equity_in_earnings_fy","equity_in_earnings_fq","equity_in_earnings_fh","minority_interest_exp_fy","minority_interest_exp_fq","minority_interest_exp_fh","discontinued_operations_fy","discontinued_operations_fq","discontinued_operations_fh","fundamental_currency_code","fund_view_mode"]),l=(0,
r.lazyValue)((()=>new o.QuoteSessionSnapshoter({name:"financials-webview-quotes",fields:[...a]})));let u;class h extends i.WebviewControllerBase{open(e){const t=this._createOpenRequest(i.WebviewPageName.Financials,e);l().getSnapshot(t.symbol(),a);t.execute().ChartQuoteSnapshotProvider={getQuoteSnapshot(){const e=n.QUOTE_FIELDS_CACHE.get(t.symbol());return e?.values??{}}}}static getInstance(){return u||(u=new h),u}}function c(e){h.getInstance().open(e)}},224743:(e,t,s)=>{"use strict";s.d(t,{globalCloseDelegate:()=>i,globalCloseMenu:()=>r});const i=new(s(547465).Delegate);function r(){i.fire()}},695257:(e,t)=>{"use strict";var s=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),_=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,f={};function m(e,t,s){this.props=e,this.context=t,this.refs=f,this.updater=s||p}function S(){}function g(e,t,s){this.props=e,this.context=t,this.refs=f,this.updater=s||p}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},S.prototype=m.prototype;var v=g.prototype=new S;v.constructor=g,y(v,m.prototype),v.isPureReactComponent=!0;var b=Array.isArray,w=Object.prototype.hasOwnProperty,C={current:null},x={key:!0,ref:!0,__self:!0,__source:!0};function D(e,t,i){var r,o={},n=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(n=""+t.key),t)w.call(t,r)&&!x.hasOwnProperty(r)&&(o[r]=t[r]);var l=arguments.length-2;if(1===l)o.children=i;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];o.children=u}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===o[r]&&(o[r]=l[r]);return{$$typeof:s,type:e,key:n,ref:a,props:o,_owner:C.current}}function P(e){return"object"==typeof e&&null!==e&&e.$$typeof===s}var I=/\/+/g;function T(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,r,o,n){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case s:case i:l=!0}}if(l)return n=n(l=e),e=""===o?"."+T(l,0):o,b(n)?(r="",null!=e&&(r=e.replace(I,"$&/")+"/"),A(n,t,r,"",(function(e){return e}))):null!=n&&(P(n)&&(n=function(e,t){return{$$typeof:s,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}
}(n,r+(!n.key||l&&l.key===n.key?"":(""+n.key).replace(I,"$&/")+"/")+e)),t.push(n)),1;if(l=0,o=""===o?".":o+":",b(e))for(var u=0;u<e.length;u++){var h=o+T(a=e[u],u);l+=A(a,t,r,h,n)}else if(h=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=_&&e[_]||e["@@iterator"])?e:null}(e),"function"==typeof h)for(e=h.call(e),u=0;!(a=e.next()).done;)l+=A(a=a.value,t,r,h=o+T(a,u++),n);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function R(e,t,s){if(null==e)return e;var i=[],r=0;return A(e,i,"","",(function(e){return t.call(s,e,r++)})),i}function V(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var M={current:null},E={transition:null},k={ReactCurrentDispatcher:M,ReactCurrentBatchConfig:E,ReactCurrentOwner:C};t.Children={map:R,forEach:function(e,t,s){R(e,(function(){t.apply(this,arguments)}),s)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!P(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=r,t.Profiler=n,t.PureComponent=g,t.StrictMode=o,t.Suspense=h,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=k,t.cloneElement=function(e,t,i){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=y({},e.props),o=e.key,n=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(n=t.ref,a=C.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)w.call(t,u)&&!x.hasOwnProperty(u)&&(r[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)r.children=i;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:s,type:e.type,key:o,ref:n,props:r,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=D,t.createFactory=function(e){var t=D.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=P,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:V}},t.memo=function(e,t){return{$$typeof:c,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=E.transition;E.transition={};try{e()}finally{E.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){
return M.current.useCallback(e,t)},t.useContext=function(e){return M.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return M.current.useDeferredValue(e)},t.useEffect=function(e,t){return M.current.useEffect(e,t)},t.useId=function(){return M.current.useId()},t.useImperativeHandle=function(e,t,s){return M.current.useImperativeHandle(e,t,s)},t.useInsertionEffect=function(e,t){return M.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return M.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return M.current.useMemo(e,t)},t.useReducer=function(e,t,s){return M.current.useReducer(e,t,s)},t.useRef=function(e){return M.current.useRef(e)},t.useState=function(e){return M.current.useState(e)},t.useSyncExternalStore=function(e,t,s){return M.current.useSyncExternalStore(e,t,s)},t.useTransition=function(){return M.current.useTransition()},t.version="18.2.0"},50959:(e,t,s)=>{"use strict";e.exports=s(695257)},386288:e=>{e.exports={subtitle:"subtitle-cEWFvaCX",text:"text-cEWFvaCX",group:"group-cEWFvaCX",groupIcon:"groupIcon-cEWFvaCX",beforeMarketOpen:"beforeMarketOpen-cEWFvaCX",afterMarketClose:"afterMarketClose-cEWFvaCX",groupTitle:"groupTitle-cEWFvaCX",groupRow:"groupRow-cEWFvaCX",groupCell:"groupCell-cEWFvaCX"}},862170:(e,t,s)=>{"use strict";s.d(t,{QuoteSessionSnapshoter:()=>h});var i=s(547465),r=s(904653),o=s(623213),n=s(778003),a=s(235267),l=s(207815);const u=new Map([["change","ch"],["last_price","lp"],["change_percent","chp"],["update_mode_seconds",null]]);new Map([["ch","change"],["lp","last_price"],["chp","change_percent"]]);class h{constructor(e){if(this._onSymbolData=new i.Delegate,this._incomplete=new Set,this._connected=!1,this._batcher=null,this._handler=e=>{switch(e.method){case"connected":this._connected||(this._connected=!0,this._handleConnected());break;case"quote_symbol_data":this._connected&&this._handleSymbolData(e.params[0]);break;case"quote_completed":this._connected&&this._handleCompleteData(e.params[0]);break;case"disconnected":this._connected&&(this._connected=!1,this._batcher=null)}},0===e.fields.length)throw new Error('Support for empty "fields" array is not implemented');const{provider:t=a.QuoteSession}=e;this._fields=new Set(e.fields),this._session=new t(window.ChartApiInstance,["snapshoter",e.name,(0,o.randomHash)()].filter(Boolean).join("_")),this._session.connect(this._handler)}getSnapshotSync(e,t){const s=h.cache.get(e);return s&&this._isSnapshotReady(s,t)?s:null}getSnapshotsForAllSync(e,t){return e.map((e=>this.getSnapshotSync(e,t)))}getSnapshot(e,t,s){const i=s?.signal??null;return new Promise(((s,o)=>{if(i&&i.aborted)throw(0,r.createAbortError)();const n=()=>{this._onSymbolData.unsubscribe(this,a),o((0,r.createAbortError)())},a=(r=e)=>{if(r!==e)return!1;const o=h.cache.get(e);return!(!o||!this._isSnapshotReady(o,t))&&(this._onSymbolData.unsubscribe(this,a),i?.removeEventListener("abort",n),s(o),!0)};if(!a()&&(i?.addEventListener("abort",n,{once:!0}),this._onSymbolData.subscribe(this,a),!this._incomplete.has(e))){if(this._incomplete.add(e),
!this._connected)return;if(null===this._batcher){const t=this._batcher={symbols:new Set([e]),promise:Promise.resolve().then((()=>{this._batcher===t&&(this._session.quoteAddSymbols([...t.symbols]),this._batcher=null)}))}}else this._batcher.symbols.add(e)}}))}getSnapshotsForAll(e,t,s){return Promise.all(e.map((e=>this.getSnapshot(e,t,s))))}static relax(e){return e}static isSuccess(e){return"error"!==e.status}static hasAllFields(e,t){for(const s of Array.from(t))if(!e.hasOwnProperty(s))return!1;return!0}_isSnapshotReady(e,t){return"error"===e.status||this._hasAllFields(e,t)}_hasAllFields(e,t){return h.hasAllFields(e.values,Array.from(t))}_handleConnected(){if(this._fields.size>0){const e=[...this._fields].flatMap((e=>{const t=u.get(e);return null!==t?t??e:[]}));this._session.quoteSetFields(e)}this._incomplete.size>0&&this._session.quoteAddSymbols([...this._incomplete])}_handleCompleteData(e){const t=h.cache.get(e)??{symbolname:e,status:"ok",values:{}};h.cache.update(t,this._fields,!0),this._session.quoteRemoveSymbols([e]),this._incomplete.delete(e),this._onSymbolData.fire(e)}_handleSymbolData(e){(0,n.normalizeUpdateMode)(e.values);const t=e.symbolname;h.cache.update(e,this._fields,!1),"error"===e.status?this._handleCompleteData(t):this._onSymbolData.fire(t)}}h.cache=l.QUOTE_FIELDS_CACHE},493239:(e,t,s)=>{"use strict";s.d(t,{DECEMBER:()=>b,FIRST_DAY_OF_WEEK:()=>_,FRIDAY:()=>c,JANUARY:()=>y,JULY:()=>S,LAST_DAY_OF_WEEK:()=>p,MARCH:()=>f,MAY:()=>m,MONDAY:()=>a,NOVEMBER:()=>v,SATURDAY:()=>d,SEPTEMBER:()=>g,SUNDAY:()=>n,THURSDAY:()=>h,TUESDAY:()=>l,WEDNESDAY:()=>u,add_date:()=>N,add_days_considering_dst:()=>L,add_minutes:()=>B,cal_to_utc:()=>Q,clone:()=>F,days_per_year:()=>H,get_cal:()=>G,get_cal_from_unix_timestamp_ms:()=>j,get_cal_utc:()=>J,get_day_of_month:()=>A,get_day_of_week:()=>R,get_day_of_year:()=>V,get_days_in_month:()=>U,get_minutes:()=>T,get_minutes_from_midnight:()=>M,get_minutes_with_hours:()=>E,get_month:()=>P,get_timezone:()=>Z,get_year:()=>D,is_leap_year:()=>Y,millisecondsPerDay:()=>x,minutesPerDay:()=>w,minutesPerWeek:()=>C,set_hms:()=>k,set_seconds:()=>O,time_seconds:()=>z,time_seconds_diff:()=>W,utc_to_cal:()=>q,utc_to_cal_ts:()=>$});var i=s(685182);const r={0:0,1:31,2:59,3:90,4:120,5:151,6:181,7:212,8:243,9:273,10:304,11:334};class o{constructor(e){this._invalid=!1,this._name=e;let t=i.tzData[e];t||(t={time:[],offset:[]},this._invalid=!0),t.time.length!==t.offset.length&&(t={time:[],offset:[]},this._invalid=!0);const s=t;if(!s.time_utc){const e=t.time,i=t.offset,r=e.length,o=new Array(r);for(let t=0;t<r;t++)e[t]*=1e3,i[t]*=1e3,o[t]=e[t]-i[t];s.time_utc=o}this.tz=s}offset_utc(e){return o.offset(this.tz.time_utc,this.tz.offset,e)}offset_loc(e){return o.offset(this.tz.time,this.tz.offset,e)}name(){return this._name}is_valid(){return!this._invalid}correction_loc(e){const t=this.tz.time,s=this.tz.offset,i=K(t,e);if(i<1)return 0;const r=s[i]-s[i-1];if(r>0){if(e-t[i-1]<=r)return r}return 0}static offset(e,t,s){const i=K(e,s);return-1===i?0:t[i]}}
const n=1,a=2,l=3,u=4,h=5,c=6,d=7,_=n,p=d,y=0,f=2,m=4,S=6,g=8,v=10,b=11,w=1440,C=10080,x=864e5;function D(e){return e.getUTCFullYear()}function P(e){return e.getUTCMonth()}function I(e){return e.getUTCHours()}function T(e){return e.getUTCMinutes()}function A(e){return e.getUTCDate()}function R(e){return e.getUTCDay()+1}function V(e){const t=e.getUTCMonth();let s=r[t];return t>y+1&&Y(e.getUTCFullYear())&&(s+=1),s+e.getUTCDate()}function M(e){return 60*I(e)+T(e)}function E(e){return M(e)}function k(e,t,s,i,r,o){e.setUTCHours(t),e.setUTCMinutes(s),e.setUTCSeconds(i),e.setUTCMilliseconds(r),void 0!==o&&function(e,t){const s=e.getTime(),i=t.correction_loc(s);e.setTime(s+i)}(e,o)}function L(e,t,s){const i=e.offset_utc(t.getTime()),r=F(t);N(r,s);const o=e.offset_utc(r.getTime());return r.setTime(r.getTime()+i-o),r}function N(e,t){e.setTime(e.getTime()+t*x)}function B(e,t){e.setTime(e.getTime()+60*t*1e3)}function O(e,t){const s=86400,i=t%s<0?-1:0,r=Math.trunc(t/s)+i,o=t-r*s,n=Math.trunc(o/3600),a=Math.trunc(o%3600/60);k(e,n,a,o-3600*n-60*a,0),N(e,r)}function F(e){return new Date(e.getTime())}function U(e,t){let s;switch(e){case 0:case 2:case 4:case 6:case 7:case 9:case 11:s=31;break;case 1:s=28,Y(t)&&s++;break;default:s=30}return s}function H(e){return Y(e)?366:365}function Y(e){return e%4==0&&(e%100!=0||e%400==0)}function z(e){return 1e3*e}function W(e,t){return ee(e)-ee(t)}function q(e,t){return new Date($(e,t))}function $(e,t){return t+e.offset_utc(t)}function G(e,t,s,i,r,o,n){const a=new Date(Date.UTC(t,s,i,r||0,o||0,n||0)),l=e.offset_utc(+a);return new Date(a.valueOf()-l)}function j(e,t){return new Date(t+e.offset_utc(t))}function J(e,t,s,i=0,r=0,o=0){return new Date(Date.UTC(e,t,s,i,r,o))}function Q(e,t,s){let i=t.getTime();s&&(i+=e.correction_loc(i));return i-e.offset_loc(i)}function Z(e){return new o(e)}function K(e,t){const s=e.length;if(0===s)return-1;if(isNaN(t))throw Error("Key is NaN");let i=0,r=s-1,o=X((i+r)/2);for(;;){if(e[o]>t){if(r=o-1,r<i)return o}else if(i=o+1,r<i)return o<s-1?o+1:-1;o=X((i+r)/2)}}function X(e){return 0|e}function ee(e){return e<0?X(e/1e3)-(e%1e3!=0?1:0):X(e/1e3)}},311943:(e,t,s)=>{"use strict";s.d(t,{LollipopGroupIcons:()=>i,LollipopTooltipMainCommonRow:()=>u});var i,r=s(50959),o=s(497754),n=s.n(o),a=s(79205),l=s(386288);function u(e){const{name:t,value:s,style:i,valueStyle:o,onValueClick:u,valueRightIcon:h,className:c}=e;return r.createElement("div",{className:n()(l.groupRow,c),style:i},t&&r.createElement("div",{className:l.groupCell},r.createElement("span",{className:l.text},t)),r.createElement("div",{className:l.groupCell},r.createElement("span",{className:l.text,style:o,onClick:u},s),h&&r.createElement(a.Icon,{icon:h.iconContent,className:n()(l.groupIcon,h.iconClass,"apply-common-tooltip"),title:h.tooltipText})))}!function(e){e[e.BeforeMarketOpen=l.beforeMarketOpen]="BeforeMarketOpen",e[e.AfterMarketClose=l.afterMarketClose]="AfterMarketClose"}(i||(i={}))},670926:(e,t,s)=>{"use strict";s.d(t,{WebviewControllerBase:()=>o,WebviewPageName:()=>i});var i,r=s(167653);!function(e){
e.Financials="financials",e.Forecast="forecast",e.Details="details",e.Technicals="technicals",e.CorporateBonds="corporate-bonds",e.Seasonals="seasonals",e.StockBonds="stock-bonds"}(i||(i={}));class o{_createOpenRequest(e,t=new URLSearchParams){const s=t.get("symbol")??r.linking.symbol.value();return t.set("symbol",s),{execute(){const s=new URL(`webview/${e}/`,location.origin);return s.search=t.toString(),window.open(s,"_blank")},symbol:()=>s}}}},554255:(e,t,s)=>{"use strict";function i(e,t){const s=Math.floor(t/1e4)%1e4,i=Math.floor(t/100)%100-1,r=t%100;return e.format(new Date(Date.UTC(s,i,r)))}s.d(t,{formatYYYYMMDD:()=>i})},412338:(e,t,s)=>{"use strict";s.d(t,{getVolumeUnit:()=>r});var i=s(444372);function r(e){switch(e.volume_type){case"base":return e.base_currency||void 0;case"quote":return e.currency||void 0;case"tick":return i.t(null,void 0,s(824821))}}},194275:(e,t,s)=>{"use strict";s.d(t,{roundToThirdDigit:()=>r});var i=s(808708);function r(e,t){const s=new i.NumericFormatter({precision:3}),r=new i.NumericFormatter({precision:2}),o=Math.abs(Math.round(1e3*e)/1e3),n=o.toFixed(3).split(".")[1];return`${e<0?"âˆ’":""}${(t||"0"!==n[n.length-1]?s:r).format(o)}`}},744380:(e,t,s)=>{"use strict";s.d(t,{IntervalsVisibilitiesProperty:()=>o});var i=s(905520),r=s(816541);class o extends i.Property{state(e,t){return(0,r.nonDefaultIntervalsVisibilities)(super.state(e,t))??void 0}storeStateIfUndefined(){return!1}}},320994:(e,t,s)=>{"use strict";s.d(t,{BitmapCoordinatesPaneRenderer:()=>r});var i=s(871934);class r{draw(e,t){new i.CanvasRenderingTarget2D(e,t.mediaSize,t.bitmapSize).useBitmapCoordinateSpace((e=>this._drawImpl(e)))}drawBackground(e,t){new i.CanvasRenderingTarget2D(e,t.mediaSize,t.bitmapSize).useBitmapCoordinateSpace((e=>this._drawBackgroundImpl(e)))}_drawBackgroundImpl(e){}}},708162:(e,t,s)=>{"use strict";s.d(t,{CompositeRenderer:()=>i});class i{constructor(){this._renderers=[],this._globalAlpha=1}setGlobalAlpha(e){this._globalAlpha=e}append(e){e&&this._renderers.push(e)}insert(e,t){this._renderers.splice(t,0,e)}clear(){this._renderers.length=0}isEmpty(){return 0===this._renderers.length}draw(e,t){for(let s=0;s<this._renderers.length;s++)e.save(),e.globalAlpha=this._globalAlpha,this._renderers[s].draw(e,t),e.restore()}drawBackground(e,t){e.save(),e.globalAlpha=this._globalAlpha;for(let s=0;s<this._renderers.length;s++){const i=this._renderers[s];i.drawBackground&&i.drawBackground(e,t)}e.restore()}hitTest(e,t){let s=null;for(let i=this._renderers.length-1;i>=0;i--){const r=this._renderers[i].hitTest(e,t);null!==r&&(null===s||r.target()>s.target())&&(s=r)}return s}doesIntersectWithBox(e,t){return this._renderers.some((s=>!!s.doesIntersectWithBox&&s.doesIntersectWithBox(e,t)))}}},820807:(e,t,s)=>{"use strict";s.d(t,{MediaCoordinatesPaneRenderer:()=>r});var i=s(871934);class r{draw(e,t){new i.CanvasRenderingTarget2D(e,t.mediaSize,t.bitmapSize).useMediaCoordinateSpace((e=>this._drawImpl(e)))}drawBackground(e,t){
new i.CanvasRenderingTarget2D(e,t.mediaSize,t.bitmapSize).useMediaCoordinateSpace((e=>this._drawBackgroundImpl(e)))}_drawBackgroundImpl(e){}}},839800:(e,t,s)=>{"use strict";s.d(t,{sortSources:()=>r,sortSourcesPreOrdered:()=>i});const i={KeyFactsToday:10000001,LatestUpdates:10000002,BarMarks:10000003,TimeScaleMarks:10000004,ChartEventsSource:10000005,Dividends:10000006,Splits:10000007,Earnings:10000008,RollDates:10000009,FutureContractExpiration:10000010,LineToolOrder:10000011,LineToolPosition:10000012,LineToolExecution:10000013,AlertLabelInactive:10000014,AlertLabel:10000015};function r(e,t){if(0===e.length)return[];if(!t)return[...e].sort(((e,t)=>e.zorder()-t.zorder()));if(!(t.model().mainPane()===t))return[...e].sort(((e,t)=>e.zorder()-t.zorder()));const s=t.model().panes(),i=s.indexOf(t),r=e=>s.findIndex((t=>t.hasDataSource(e)));return e.map((e=>{const s=!t.hasDataSource(e);return{source:e,isMultipane:s,aboveSeries:e.zorder()>t.model().mainSeries().zorder(),paneIndex:s?r(e):i}})).sort(((e,t)=>e.isMultipane||t.isMultipane?e.isMultipane&&!t.isMultipane?t.aboveSeries?-1:1:!e.isMultipane&&t.isMultipane?e.aboveSeries?1:-1:e.paneIndex-t.paneIndex:e.source.zorder()-t.source.zorder())).map((e=>e.source))}},436966:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Sessions:()=>_});var i=s(650151),r=s(807958),o=s(901466),n=s(196302),a=s(89831),l=s(840514),u=s(931924),h=s(437642),c=s(87347);const d=new a.PriceFormatter;class _ extends l.CustomSourceBase{constructor(e,t,s,i){super(e,t),this._studySource=null,this._paneViews=[],this._metaInfo=null,this._destroyed=!1,this._isStarted=!1,this._loadedGraphics=null,this._doubleClickHandler=i,this._properties=s,this._properties.subscribe(this,this._onPropertiesChanged),this._requestAndProcessMetaInfo(),t.timeScale().onReset().subscribe(this,this._clearData),t.timeScale().logicalRangeChanged().subscribe(this,this.updateAllViews.bind(this,(0,h.viewportChangeEvent)())),t.mainSeries().properties().childs().interval.subscribe(this,this._processHibernate)}start(){this._isStarted=!0,this._processHibernate()}restart(){this._clearData(),u.enabled("stop_study_on_restart")&&this.stop(),this.start()}isStarted(){return this._isStarted}stop(){this._isStarted=!1,null!==this._studySource&&this._studySource.stop()}isHoveredEnabled(){return!1}paneViews(e){return this._paneViews}updateAllViews(e){this._paneViews.forEach((t=>t.update(e)))}updateViewsForPane(e,t){this.updateAllViews(t)}destroy(){this._destroyed=!0,null!==this._studySource&&(this._studySource.dataCleared().unsubscribeAll(this),this._studySource.dataUpdated().unsubscribeAll(this),this._studySource.destroy(),this._studySource=null),this._model.timeScale().logicalRangeChanged().unsubscribeAll(this),this._model.timeScale().onReset().unsubscribeAll(this),this._model.mainSeries().properties().childs().interval.unsubscribeAll(this),this._properties.unsubscribeAll(this)}series(){return this._model.mainSeries()}priceScale(){return this.series().priceScale()}graphics(){return this._loadedGraphics||(0,i.ensureNotNull)(this._studySource).graphics()}valueAt(e,t){
return null}properties(){return this._properties}graphicsInfo(){return(0,i.ensureNotNull)(this._metaInfo).graphics}firstValue(e){return this._model.mainSeries().firstValue()}formatter(){return d}stateData(){return null!==this._metaInfo?{graphics:(0,n.saveStudyGraphics)(this.graphics(),this._model.timeScale().visibleBarsStrictRange()),metaInfo:this._metaInfo.state()}:null}restoreStateData(e){void 0!==e&&(this._loadStudyGraphics(e.graphics),this._setMetaInfo(new r.StudyMetaInfo(e.metaInfo)),this._createPaneViews())}metaInfo(){return(0,i.ensureNotNull)(this._metaInfo)}async _requestAndProcessMetaInfo(){if(this._model.isSnapshot())return;const e=await(0,c.studyMetaInfoRepository)().findById({type:"java",studyId:"Sessions@tv-basicstudies"});this._destroyed||null===this._loadedGraphics&&(this._setMetaInfo(e),null!==this._metaInfo&&(this._studySource=new o.StudyDataSource(this._model.chartApi(),this._model.mainSeries().seriesSource(),"sessions_",this._metaInfo),this._createPaneViews(),this._studySource.dataCleared().subscribe(this,this.updateAllViews.bind(this,(0,h.sourceChangeEvent)(this.id()))),this._studySource.dataUpdated().subscribe(this,this.updateAllViews.bind(this,(0,h.sourceChangeEvent)(this.id()))),this._studySource.setInputs({}),this._processHibernate()))}_loadStudyGraphics(e){const t=e.backgrounds;if(void 0!==t){const e=t.findIndex((e=>"inSession"===e.styleId));-1!==e&&t.splice(e,1)}this._loadedGraphics=(0,n.loadStudyGraphics)(e)}_setMetaInfo(e){const t=e.graphics.backgrounds;void 0!==t&&void 0!==t.inSession&&delete t.inSession,this._metaInfo=e}_clearData(){null!==this._studySource&&this._studySource.clearData()}_createPaneViews(){const e={doubleClickHandler:this._doubleClickHandler};(0,n.createGraphicsPaneViews)(this,this._model,e).then((e=>{this._paneViews=e.regularPaneViews,this._model.lightUpdate()}))}_onPropertiesChanged(){this._processHibernate(),this.updateAllViews((0,h.sourceChangeEvent)(this.id()))}_processHibernate(){if(null!==this._studySource){const e=this._canBeHibernated(),t=this._isHibernated(),s=this._studySource.isStarted();!t&&e&&s?this._studySource.stop():!t||e||s||this._studySource.start()}}_canBeHibernated(){if(this._model.mainSeries().isDWM())return!0;const e=this._properties.childs().sessionHighlight.childs(),{preMarket:t,postMarket:s,electronic:i,outOfSession:r}=e.backgrounds.childs(),{sessBreaks:o}=e.vertlines.childs(),n=t.childs().available.value()&&t.childs().visible.value()||s.childs().available.value()&&s.childs().visible.value()||i.childs().available.value()&&i.childs().visible.value()||r.childs().available.value()&&r.childs().visible.value(),a=o.childs().available.value()&&o.childs().visible.value();return!n&&!a}_isHibernated(){return this._isStarted&&(null===this._studySource||!this._studySource.isStarted())}}},37241:(e,t,s)=>{"use strict";s.d(t,{prepareStudyProperties:()=>w,prepareStudyPropertiesForLoadChart:()=>f});var i=s(998034),r=s(130551),o=s(735566),n=s(536794),a=s(807958),l=s(257145),u=s(85858),h=s(192809),c=s(266954),d=s(890390),_=s(744380),p=s(974145);const y=(0,
o.getLogger)("Chart.Study");function f(e,t,s,r,o,l){return function(e,t,s,r,o,l,h){const c=function(e,t,s,r,o){e.version&&s.version&&e.version!==s.version&&y.logWarn("Serialized metaInfo version "+e.version+" is not equal to the saved state version "+s.version);const l=t||e,h=(0,n.clone)(l.defaults)??{},c=a.StudyMetaInfo.getStudyPropertyRootName(l),d=a.StudyMetaInfo.getStudyPropertyRootName(e);let _=S();(0,i.default)(_,m(e)),(0,i.default)(_,(0,n.clone)(e.defaults)),(0,i.default)(_,h),(0,i.default)(_,(0,u.factoryDefaults)(c)),(0,i.default)(_,(0,u.factoryDefaults)(d)),(0,i.default)(_,g(l,r,c)),(0,i.default)(_,g(e,r,d)),(0,i.default)(_,s),_=r.updateStudyState(_,e,t),void 0!==o&&t&&(_=o(s,_,e,t));a.StudyMetaInfo.versionOf(l)>=1&&(0,i.default)(_,v(h,_));return _}(e,t,s,r,l);return x(t||e,o,c,h,!0)}(e,t,s,r,a.StudyMetaInfo.getStudyPropertyRootName(e),o,l)}function m(e){const t={};if(e.plots)for(let s=0;s<e.plots.length;s++){const i=e.plots[s],r=i.id;if((0,p.isColorerPlot)(i))continue;const o={display:15,color:"#0496FF",linestyle:l.LINESTYLE_SOLID,linewidth:2,plottype:p.LineStudyPlotStyle.Line,trackPrice:!1};(0,p.isBarColorerPlot)(i)&&(o.transparency=0),o.plottype=i.type,o.title=r,t[r]=o}return{styles:t}}function S(){const e=(0,n.clone)((0,u.defaults)("study"));return e.intervalsVisibilities=(0,n.clone)(c.intervalsVisibilitiesDefaults),e}function g(e,t,s){let i=(0,n.clone)((0,u.defaults)(s,t));return"Overlay"!==e.shortId&&"Compare"!==e.shortId||(i.currencyId=null,i.unitId=null),e.isTVScript&&e.TVScriptSourceCode!==i.TVScriptSourceCode&&(i=(0,n.clone)((0,u.factoryDefaults)(s))),i}function v(e,t){const s={};return h.StudyVersioning.mergeInputsObjPart(s,e.inputs??{}),h.StudyVersioning.mergeInputsObjPart(s,t.inputs),{inputs:s}}function b(e,t,s,o){if(a.StudyMetaInfo.versionOf(e)<1)throw new Error("This function cannot work with metainfo of the old format version. Required format version >= 1");const l=a.StudyMetaInfo.getStudyPropertyRootName(e),h=(0,n.clone)(e.defaults),c=(0,u.factoryDefaults)(l),d=S();if((0,i.default)(d,m(e)),(0,i.default)(d,h),(0,i.default)(d,c),(0,i.default)(d,g(e,o,l)),(0,i.default)(d,t),(0,i.default)(d,v(h,d)),null!==s){const t=s.model().studiesColorRotatorFactory().getColorRotator(e);null!==t&&("Overlay@tv-basicstudies"===e.id?d.lineStyle.color=t.getColor(d.lineStyle.color,c.lineStyle.color===d.lineStyle.color):(0,i.default)(d,function(e,t){for(const s of Object.keys(e.styles)){const i=e.styles[s];if((0,r.isObject)(i)&&"color"in i){const e=i.color;i.color=t.getColor(e)}}return e}(d,t)))}return o.updateStudyInputsIfNeeded(d,d.version??e.version,e),d}function w(e,t,s,i,r){return function(e,t,s,i,r,o){const l=b(e,t,s,i),u=a.StudyMetaInfo.getSourceInputIds(e);return u.forEach(((e,t)=>{const s=l.inputs[e];t<o.length?l.inputs[e]=`${o[t].id()}$0`:(0,n.isString)(s)&&s.includes("$")&&(l.inputs[e]="close")})),x(e,r,l)}(e,t,s,i,a.StudyMetaInfo.getStudyPropertyRootName(e),r)}
const C=["id","description","description_localized","shortDescription","_metainfoVersion","is_price_study","is_hidden_study","priceScale","fullId","shortId","scriptIdPart","packageId","productId","isTVScriptStub","defaults","symbolSource","historyCalculationMayChange","format","linkedToSeries","isTVLibrary","docs","exports","exportTypes","extra","usesPrivateLib","financialPeriod","groupingKey","pine","isRGB","isTVScript","TVScriptMetaInfoExprs","usePlotsZOrder","isTVScriptStrategy","TVScriptSourceCode","lookaheadFutureData","hasAlertFunction","defaultStrategyAlertMessage","tags","canBeChild","canNotBeChild","_serverMetaInfoVersion","warnings"];function x(e,t,s,i,r){for(const e of C)delete s[e];const o=["visible","precision","minTick","intervalsVisibilities","inputs.first_visible_bar_time","inputs.last_visible_bar_time","inputs.subscribeRealtime","patchMetaInfoDefaults"];for(let t=0;t<e.inputs.length;++t){const s=e.inputs[t];s.isHidden&&(o.push(`inputs.${t}`),o.push(`inputs.${s.id}`))}const n=new d.DefaultProperty({defaultName:t,state:s,excludedDefaultsKeys:o,excludedStateKeys:["version"],theme:i});n.removeProperty("intervalsVisibilities"),n.addChild("intervalsVisibilities",new _.IntervalsVisibilitiesProperty(s&&s.intervalsVisibilities)),"PivotPointsStandard@tv-basicstudies"!==e.id&&"PivotPointsHighLow@tv-basicstudies"!==e.id||!n.hasChild("font")||n.removeProperty("font");const l=a.StudyMetaInfo.versionOf(e);return n.hasChild("version")?n.childs().version?.setValue(l):n.addProperty("version",l),e.TVScriptMetaInfoExprs&&!r&&n.addProperty("patchMetaInfoDefaults",!0),n}},859849:(e,t,s)=>{"use strict";s.r(t),s.d(t,{study_ESD$TV_DIVIDENDS:()=>Se,study_ESD$TV_EARNINGS:()=>ve,study_ESD$TV_SPLITS:()=>ge});var i=s(262609),r=s.n(i),o=s(650151),n=s(790188),a=s(444372),l=s(969680),u=s(586563),h=s(536794),c=s(534328),d=s(837462),_=s(951827),p=s(910282),y=s(311943),f=s(731974),m=s(257145),S=s(398453),g=s(338242);const v={fillPath:new Path2D("M8.961.92a3 3 0 0 1 3.078 0l7.5 4.48A3 3 0 0 1 21 7.975V20a3 3 0 0 1-3 3H3a3 3 0 0 1-3-3V7.975A3 3 0 0 1 1.461 5.4l7.5-4.48z"),strokePath:new Path2D("M9.867 2.742c.39-.23.875-.23 1.266 0l7.5 4.406c.382.225.617.635.617 1.078V20c0 .69-.56 1.25-1.25 1.25H3c-.69 0-1.25-.56-1.25-1.25V8.226c0-.443.235-.853.617-1.078l7.5-4.406z")},b={fillPath:new Path2D("M8.961 23.08a3 3 0 0 0 3.078 0l7.5-4.48A3 3 0 0 0 21 16.025V4a3 3 0 0 0-3-3H3a3 3 0 0 0-3 3v12.025A3 3 0 0 0 1.461 18.6l7.5 4.48z"),strokePath:new Path2D("M9.866 21.257c.391.23.877.23 1.268 0l7.5-4.414a1.25 1.25 0 0 0 .616-1.078V4c0-.69-.56-1.25-1.25-1.25H3c-.69 0-1.25.56-1.25 1.25v11.765c0 .443.234.853.616 1.078l7.5 4.414z")},w={fillPath:new Path2D("M3 0h15c1.662 0 3 1.338 3 3v15c0 1.662-1.338 3-3 3H3c-1.662 0-3-1.338-3-3V3c0-1.662 1.338-3 3-3z"),strokePath:new Path2D("M3 1.75h15c.693 0 1.25.557 1.25 1.25v15c0 .693-.557 1.25-1.25 1.25H3c-.692 0-1.25-.558-1.25-1.25V3c0-.692.558-1.25 1.25-1.25z")};function C(e,t,s,i,r){const{horizontalPixelRatio:o,verticalPixelRatio:n}=s;e.save(),e.translate(t.x-i.lollipop.width*o/2,t.y-i.lollipop.height*n/2),
e.scale(o,n),i.lollipop.fillCircle&&i.lollipop.backgroundColor&&(e.fillStyle=i.lollipop.backgroundColor,e.fill(r.fillPath)),e.strokeStyle=i.lollipop.strokeStyle,e.lineWidth=Math.round(i.lollipop.lineWidth*o)/o,(0,g.setLineStyle)(e,m.LINESTYLE_SOLID),i.lollipop.fillCircle&&i.lollipop.fillStyle&&(e.fillStyle=i.lollipop.fillStyle,e.fill(r.strokePath)),e.stroke(r.strokePath),e.restore()}class x extends S.LollipopRenderer{_drawLollipop(e,t,s){const i=this._data.style;switch(i.type){case"Positive":!function(e,t,s,i){C(e,t,s,i,v)}(e,t,s,i);break;case"Negative":!function(e,t,s,i){C(e,t,s,i,b)}(e,t,s,i);break;default:!function(e,t,s,i){C(e,t,s,i,w)}(e,t,s,i)}}}var D=s(194275),P=s(328786),I=s(472134),T=s(183800),A=s(226235),R=s(682345),V=s(149204),M=s(85290),E=s(315507);const k=a.t(null,void 0,s(363872)),L=a.t(null,void 0,s(844543)),N=a.t(null,void 0,s(964747)),B=a.t(null,void 0,s(680110)),O=a.t(null,void 0,s(980767)),F=a.t(null,void 0,s(571858)),U=a.t(null,void 0,s(588488)),H=a.t(null,void 0,s(137260)),Y=a.t(null,void 0,s(316183)),z=a.t(null,void 0,s(679505)),W=a.t(null,void 0,s(722677)),q=a.t(null,void 0,s(613551)),$=a.t(null,void 0,s(609254)),G=a.t(null,void 0,s(772453)),j=a.t(null,void 0,s(278031)),J=a.t(null,void 0,s(552274)),Q=a.t(null,void 0,s(14834)),Z={dark:(0,n.getHexColorByName)("color-cold-gray-900"),light:(0,n.getHexColorByName)("color-white")},K={positive:(0,n.getHexColorByName)("color-minty-green-600"),negative:(0,n.getHexColorByName)("color-ripe-red-600"),future:(0,n.getHexColorByName)("color-grapes-purple-a400"),unknown:(0,n.getHexColorByName)("color-cold-gray-350")},X={positive:(0,n.getHexColorByName)("color-minty-green-500"),negative:(0,n.getHexColorByName)("color-ripe-red-500"),future:(0,n.getHexColorByName)("color-grapes-purple-a200"),unknown:(0,n.getHexColorByName)("color-cold-gray-700")};function ee(e){return e?K:X}const te=(0,_.getPercentageFormatter)(),se=(0,_.getVolumeFormatter)();class ie extends P.LollipopStudyPaneViewBase{}class re extends ie{constructor(e,t){super(e,t)}styles(e){return e?{positive:(0,n.getHexColorByName)("color-minty-green-600"),negative:(0,n.getHexColorByName)("color-ripe-red-600"),future:(0,n.getHexColorByName)("color-grapes-purple-a400"),unknown:(0,n.getHexColorByName)("color-cold-gray-350")}:{positive:(0,n.getHexColorByName)("color-minty-green-500"),negative:(0,n.getHexColorByName)("color-ripe-red-500"),future:(0,n.getHexColorByName)("color-grapes-purple-a200"),unknown:(0,n.getHexColorByName)("color-cold-gray-700")}}extraData(e){const t=e[8],s=14===t,i=e[1],r=e[2],o=e[3],n=e[4],a=s?null:e[5],l=null!=a&&null!=r?a-r:null,u=e[6],h=s?null:e[7];let c;return null!=t?t<20?c="Future":null!==l&&(c=l<0?"Negative":"Positive"):null!==l?c=l<0?"Negative":"Positive":n>Date.now()&&(c="Future"),{standardized:i,reported:a,estimate:r,revenueValue:h,revenueEstimate:u,period:o,date:n,type:c,timeType:t??void 0}}afterUpdate(e,t,s,i){const r=this._source.getEstimate();if(r){const o=r.value.slice();o[4]*=1e3,this.addLollipop(e,t,s,i,r.index,o)}}getStyle(e){const t=this._getLollipopStatus(e)
;if(void 0===e.type)return super.getStyle(e,t);const s=t;let i=s;e.stack&&(i+="_stack:"+e.stack);let r=this._getStyleObject(e.type,i);if(null!==r)return r;if(this._stylesCache||(this._stylesCache={}),!this._stylesCache[i]){r=this._getStyleObject(e.type,s);const t=(0,h.clone)(r);t&&(e.stack&&(t.lollipop.incHeight=25*e.stack),this._stylesCache[i]=t)}return this._stylesCache[i]}_createTooltipContent(e){const t=e.standardized,s=null!=t,r=e.reported,n=null!=r,a=e.estimate,u=null!=a,h=n&&u?r-a:null;let c=e.revenueEstimate,d=!1;null!=c&&(d=!0,c*=1e6);let _=e.revenueValue,p=!1;null!=_&&(p=!0,_*=1e6);const f=p&&d?_-c:null,m=ee(this._model.dark().value());let S,g,v,b,w;switch(e.type){case"Future":g=m.future,S=A;break;case"Negative":g=m.negative,S=T;break;case"Positive":g=m.positive,S=I;break;default:g=m.unknown,S=A}switch(e.timeType){case 12:case 22:v=E,b=y.LollipopGroupIcons.AfterMarketClose,w=Q;break;case 11:case 21:v=M,b=y.LollipopGroupIcons.BeforeMarketOpen,w=J}const C=10===e.timeType||14===e.timeType,x={name:W,value:this._formatDate(e.date,C)};v&&(x.valueRightIcon={iconContent:v,iconClass:b,tooltipText:w});const P=[x];e.period&&P.push({name:$,value:i.unix(e.period).format("MMM 'YY")});const R={title:p||d?k:L,icon:S,style:{color:g},anchor:this._getMoreFinancialsLink(),main:{type:"common",title:P,content:[]}},V={title:L,content:[]};if(s&&V.content.push({name:N,value:(0,D.roundToThirdDigit)(t)}),n&&V.content.push({name:B,value:(0,D.roundToThirdDigit)(r)}),u&&V.content.push({name:O,value:(0,D.roundToThirdDigit)(a)}),null!==h){const e=100*Math.abs(h/a);let t=(0,D.roundToThirdDigit)(h);isFinite(e)&&(t+=" ("+te.format(e)+")"),V.content.push({name:F,value:(0,l.forceLTRStr)(t),style:{fontWeight:"bold",color:g}})}if((0,o.ensureDefined)(R.main.content).push(V),p||d){const e={title:j,content:[]};if(p&&e.content.push({name:B,value:se.format(_)}),d&&e.content.push({name:O,value:se.format(c)}),null!==f){const t=100*Math.abs(f/c);let s=se.format(f);isFinite(t)&&(s+=" ("+te.format(t)+")"),e.content.push({name:F,value:(0,l.forceLTRStr)(s),style:{fontWeight:"bold",color:f>=0?m.positive:m.negative}})}(0,o.ensureDefined)(R.main.content).push(e)}return[R]}_showBarLine(e){return super._showBarLine(e)||this._model.mainSeries().properties().childs().esdShowBreaks.value()}_createRendererForLollipop(e,t){return new x(e,new f.HitTestResult(f.HitTarget.Custom,t),this._textWidthCache)}_recreateStyles(e){const t=e.dark().value(),s=ee(t),i=s.unknown,r={barLine:{lineStyle:m.LINESTYLE_DASHED,lineWidth:1,strokeStyle:i},lollipop:{width:21,height:21,bottom:2,lineWidth:1.5,importance:"earnings",strokeStyle:i,backgroundColor:t?Z.dark:Z.light,fillCircle:!0,text:{label:"E",strokeStyle:i,font:(0,d.makeFont)(12,p.CHART_FONT_FAMILY,"bold")}}},o={lollipop:{fillStyle:(0,c.generateColor)(i,85)}},a={lollipop:{fillStyle:i,text:{strokeStyle:(0,n.getHexColorByName)("color-cold-gray-50")}}};this._defaultStyle=(0,u.deepCopy)(r),this._hoveredStyle=(0,h.merge)((0,u.deepCopy)(r),o),this._activeStyle=(0,h.merge)((0,u.deepCopy)(r),a);const l=(e,t)=>{const s=(0,u.deepCopy)(r)
;return s.barLine.strokeStyle=e,s.lollipop.strokeStyle=e,s.lollipop.text.strokeStyle=e,s.type=t,o.lollipop.fillStyle=(0,c.generateColor)(e,85),a.lollipop.fillStyle=e,{default:s,hovered:(0,h.merge)((0,u.deepCopy)(s),o),active:(0,h.merge)((0,u.deepCopy)(s),a)}};a.lollipop.text.strokeStyle=(0,n.getHexColorByName)("color-grapes-purple-50");const _=l(s.future,"Future");r.lollipop.height=23,r.lollipop.text.deltaY=1,a.lollipop.text.strokeStyle=(0,n.getHexColorByName)("color-minty-green-50");const y=l(s.positive,"Positive");r.lollipop.bottom=.5,r.lollipop.text.deltaY=-.5,a.lollipop.text.strokeStyle=(0,n.getHexColorByName)("color-ripe-red-50");const f=l(s.negative,"Negative");this._earningTypeStyles={Future:_,Positive:y,Negative:f},this._stylesCache=null}_getStyleObject(e,t){const s=this._earningTypeStyles[e];switch(t){case"default":return s.default;case"hovered":return s.hovered;case"active":return s.active}return null}}const oe=(0,n.getHexColorByName)("color-tan-orange-600"),ne=(0,n.getHexColorByName)("color-tan-orange-500");function ae(e){return e?oe:ne}class le extends ie{extraData(e){const t=e[1];return{numerator:e[2],denominator:t,date:e[3]}}_createTooltipContent(e){let t=U;return(0,h.isNumber)(e.numerator)&&(0,h.isNumber)(e.denominator)&&(t+=": "+e.numerator+"/"+e.denominator),[{title:t,icon:R,style:{color:ae(this._model.dark().value())},anchor:this._getMoreFinancialsLink(),main:{type:"common",title:this._formatDate(e.date)}}]}_recreateStyles(e){const t=e.dark().value(),s=ae(t),i={barLine:{lineStyle:m.LINESTYLE_DASHED,lineWidth:1,strokeStyle:s},lollipop:{width:23,height:23,bottom:1,lineWidth:1.5,importance:"splits",strokeStyle:s,backgroundColor:t?Z.dark:Z.light,fillCircle:!0,text:{label:"S",strokeStyle:s,font:(0,d.makeFont)(12,p.CHART_FONT_FAMILY,"bold")}}},r={lollipop:{fillStyle:(0,c.generateColor)(s,85)}},o={lollipop:{fillStyle:s,text:{strokeStyle:(0,n.getHexColorByName)("color-tan-orange-50")}}};this._defaultStyle=i,this._hoveredStyle=(0,h.merge)((0,u.deepCopy)(i),r),this._activeStyle=(0,h.merge)((0,u.deepCopy)(i),o),this._stylesCache=null}}const ue=(0,n.getHexColorByName)("color-tv-blue-600"),he=(0,n.getHexColorByName)("color-tv-blue-500");function ce(e){return e?ue:he}class de extends ie{constructor(){super(...arguments),this._getMoreFinancialsLinkInitialTabId="dividends"}extraData(e){return{amountDividends:e[1],date:e[2],adjustedAmountDividends:e[3],paymentDate:e[4]}}_createTooltipContent(e){const{date:t,amountDividends:s,paymentDate:i,adjustedAmountDividends:r}=e,o=[{name:q,value:this._formatDate(t)}];return(0,h.isNumber)(s)&&o.push({name:Y,value:(0,D.roundToThirdDigit)(s)}),(0,h.isNumber)(r)&&o.push({name:z,value:(0,D.roundToThirdDigit)(r)}),(0,h.isNumber)(i)&&o.push({name:G,value:this._formatDate(i)}),[{title:H,icon:V,style:{color:ce(this._model.dark().value())},anchor:this._getMoreFinancialsLink(),main:{type:"common",title:o}}]}_recreateStyles(e){const t=e.dark().value(),s=ce(t),i={barLine:{lineStyle:m.LINESTYLE_DASHED,lineWidth:1,strokeStyle:s},lollipop:{width:23,height:23,bottom:1,lineWidth:1.5,
importance:"dividends",strokeStyle:s,backgroundColor:t?Z.dark:Z.light,fillCircle:!0,text:{label:"D",strokeStyle:s,font:(0,d.makeFont)(12,p.CHART_FONT_FAMILY,"bold")}}},r={lollipop:{fillStyle:(0,c.generateColor)(s,85)}},o={lollipop:{fillStyle:s,text:{strokeStyle:(0,n.getHexColorByName)("color-tv-blue-50")}}};this._defaultStyle=i,this._hoveredStyle=(0,h.merge)((0,u.deepCopy)(i),r),this._activeStyle=(0,h.merge)((0,u.deepCopy)(i),o),this._stylesCache=null}_getMoreFinancialsLinkText(){return a.t(null,{replace:{symbol:this._model.mainSeries().symbolInfo()?.name??""}},s(218248))}}var _e=s(839800),pe=s(758868);const ye=_e.sortSourcesPreOrdered.Dividends,fe=_e.sortSourcesPreOrdered.Splits,me=_e.sortSourcesPreOrdered.Earnings;class Se extends pe.LollipopStudyBase{id(){return"ESD$TV_DIVIDENDS"}zorder(){return ye}isValid(e){const t=e[2];return(0,h.isNumber)(t)}state(e,t){const s=super.state(e,t);return s.data.version=2,s}restoreData(e){(e.version??1)<2&&e.data.forEach((e=>{e.value[3]=null})),super.restoreData(e)}_createViews(){this._paneView=new de(this._model,this),super._createViews()}_externalVisibilityProperty(){return this._model.mainSeries().properties().childs().esdShowDividends}}class ge extends pe.LollipopStudyBase{id(){return"ESD$TV_SPLITS"}zorder(){return fe}isValid(e){const t=e[3];return(0,h.isNumber)(t)}_createViews(){this._paneView=new le(this._model,this),super._createViews()}_externalVisibilityProperty(){return this._model.mainSeries().properties().childs().esdShowSplits}}class ve extends pe.LollipopStudyBase{constructor(){super(...arguments),this._estimatePlotRow=null}id(){return"ESD$TV_EARNINGS"}zorder(){return me}isValid(e){const t=e[3],s=e[4];return(0,h.isNumber)(t)&&(0,h.isNumber)(s)}restoreData(e){super.restoreData(e);let t=null;if(e.estimate)t=this._restorePointset(e.estimate);else if(e.pointSets&&null==e.pointSetsVersion){const s=this._getSymbol();if(null!==s){const i=s.split(":")[1].toUpperCase();e.pointSets[s]?t=this._restorePointset(e.pointSets[s]):e.pointSets[i]&&(t=this._restorePointset(e.pointSets[i]))}}else if(e.pointSets&&"1"===e.pointSetsVersion){const s=this._getSymbol();if(null!==s){const i=s.split(":")[1].toUpperCase();e.pointSets[s]?t=e.pointSets[s].estimate:e.pointSets[i]&&(t=e.pointSets[i].estimate)}}else null!=e.estimatePlotRow&&"2"===e.pointSetsVersion&&(t=e.estimatePlotRow);this._estimatePlotRow=t}getEstimate(){return this._estimatePlotRow}_createViews(){this._paneView=new re(this._model,this),super._createViews()}_externalVisibilityProperty(){return this._model.mainSeries().properties().childs().esdShowEarnings}_getSymbol(){return this._series.symbolInfo()?.base_name[0].toLowerCase()??null}_restorePointset(e){return{index:e.index,value:[e.tickmark,void 0,e.estimate,(0,h.isNumber)(e.period)?e.period:r()(e.period).unix(),(0,h.isNumber)(e.date)?e.date:r()(e.date).unix()]}}}},590178:(e,t,s)=>{"use strict";s.d(t,{ExtendedStudyDataSource:()=>o});var i=s(901466),r=s(454184);class o extends i.StudyDataSource{constructor(e,t,s,i){super(e,t.seriesSource(),s,i),this._series=t}_createStudyError(e){
return(0,r.createStudyError)(this._getStudyErrorDescription(e),this._series.symbolInfo()?.exchange)}}},190484:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Fundamental:()=>v});var i=s(444372),r=s(631114),o=s(203723),n=s(492380);class a extends n.StudyPriceAxisView{constructor(e,t){super(e,t),this._fundamental=e}_updatePaneRendererData(e){e.text="",this._showPaneLabel()&&(e.text=this._fundamental.labelTitle(),e.visible=!0)}}var l=s(514294);class u extends l.StudyPriceLineAxisView{constructor(e,t){super(e,t),this._model=e.model()}_isVisible(){return this._model.properties().childs().scalesProperties.childs().showFundamentalLastValue.value()&&this._study.properties().childs().styles.childs()[this._plotname].childs().trackPrice.value()}}var h=s(681240),c=s(454184);const d=i.t(null,void 0,s(576751));class _ extends h.StudyStatusProvider{sourceStatusText(){const e=this._source.status();return e.type===c.StudyStatusType.Error&&(e.errorDescription.error.startsWith("resolve_error ")||e.errorDescription.error.startsWith("Symbol resolve error:"))?d:super.sourceStatusText()}}var p=s(644036),y=s(974145),f=s(132565),m=s(584785),S=s(397535),g=s(816433);class v extends r.Study{constructor(e,t,s,i,r,o){super(e,t,s,i,r,o),this._linePlot=null;const n=i.plots.findIndex((e=>"line"===e.type));if(-1!==n){const e=i.plots[n],s=t.childs().styles.childs()[e.id];s.hasChild("plottype")&&(this._linePlot={plotIndex:n,plotType:s.childs().plottype})}}labelTitle(){return this.title(g.TitleDisplayTarget.StatusLine,!0)}hasStateForAlert(){return!1}titleInParts(e,t,s,i,r){return[this._title(e,!!t)]}statusProvider(e){return new _(this)}firstValue(){const e=super.firstValue();if(null!==e||null===this._linePlot||this._linePlot.plotType.value()!==y.LineStudyPlotStyle.StepLine&&this._linePlot.plotType.value()!==y.LineStudyPlotStyle.StepLineWithDiamonds)return e;const t=this._model.timeScale().visibleBarsStrictRange();if(null===t)return null;if(!this.properties().childs().visible.value()||!this.isActualInterval())return this._ownFirstValue;const s=this.data().search(t.firstBar()-1,m.PlotRowSearchMode.NearestLeft,this._linePlot.plotIndex+1);return null===s?null:s.value[this._linePlot.plotIndex+1]??null}priceRange(e,t,s){if(s.forceOverlayOnly)return null;let i=super.priceRange(e,t,s);if(null===i){const e=this.firstValue();null!==e&&(i=this._postProcessPriceRange(new S.PriceRange(e,e),s))}return i}_createPriceAxisView(e){return new a(this,{plotIndex:e})}_createPriceLineAxisView(e){return new u(this,e)}_defaultErrorTitle(){return"Metric error"}_title(e,t){const r=this.metaInfo();let n;if(n=t?r.shortDescription:r.description,void 0!==r.financialPeriod){const e=t?(0,o.financialPeriodToShortString)(r.financialPeriod):(0,o.financialPeriodToString)(r.financialPeriod);n=`${i.t(n,{context:"study"},s(783477))} Â· ${e}`}const a=this._titleInputs((0,p.toInputDisplayFlags)(e),!0),l=Object.keys(a);return l.length>0&&(n=`${i.t(a[l[0]],{context:"study"},s(783477))} Â· ${n}`),n}_titleInputsOptions(e,t,s){return{...super._titleInputsOptions(e,t,s),skipOptionalEmptySymbolInputs:!0,
allowedInputTypes:["symbol"]}}_fillPrecalculatedAutoscaleInfo(e,t,s){const i=super._fillPrecalculatedAutoscaleInfo(e,t,s);if(null!==this._linePlot&&(this._linePlot.plotType.value()===y.LineStudyPlotStyle.StepLine||this._linePlot.plotType.value()===y.LineStudyPlotStyle.StepLineWithDiamonds)){const t=this.data().search(e,m.PlotRowSearchMode.NearestLeft);if(null!==t){const e=t.value[this._linePlot.plotIndex+1];i.baseValueMinMax=(0,f.mergeMinMax)(i.baseValueMinMax,{min:e,max:e})}}return i}}},780631:(e,t,s)=>{"use strict";s.r(t),s.d(t,{LinearRegressionStudy:()=>n});var i=s(650151),r=s(707771),o=s(384597);class n extends o.NonSeriesStudy{startIndex(){const e=this.customData();if(null==e||null==this._indexes)return null;const t=this._indexes[e.startIndex];return t!==r.INVALID_TIME_POINT_INDEX?t:null}endIndex(){const e=this.customData();if(null==e||null==this._indexes)return null;const t=this._indexes[e.endIndex];return t!==r.INVALID_TIME_POINT_INDEX?t:null}baseLine(){const e=this.customData();return null!=e?e.baseLine:null}downLine(){const e=this.customData();return null!=e?e.downLine:null}upLine(){const e=this.customData();return null!=e?e.upLine:null}pearsons(){const e=this.customData();return null!=e&&void 0!==e.pearsons?e.pearsons:null}isVisible(){if(!this.properties().childs().visible.value()||!this.isActualInterval())return!1;const e=(0,i.ensureDefined)(this.properties().childs().styles.childs());return 0!==e.upLine.childs().display.value()||0!==e.downLine.childs().display.value()||0!==e.baseLine.childs().display.value()}_createViews(){super._createViews(),Promise.all([s.e(63317),s.e(27860),s.e(3205),s.e(88003),s.e(20507)]).then(s.bind(s,950129)).then((({LinearRegressionPaneView:e})=>{this._setPaneViews([new e(this.model(),this)])}))}}},758868:(e,t,s)=>{"use strict";s.d(t,{LollipopStudyBase:()=>h});var i=s(631114),r=s(707771),o=s(880865),n=s(197860),a=s(448381),l=s(437642);const u=Date.UTC(2024,1,1);class h extends i.Study{constructor(e,t,s,i,r,o){super(e,t,s,i,r,o),this._restartRequired=!1,this.setOwnerSource(e.mainSeries());const n=this._externalVisibilityProperty();null!==n&&(this._destroyPropertyBinder=(0,a.bindProperties)(n,this._properties.childs().visible))}destroy(){this._paneView.destroy(),this._destroyPropertyBinder?.(),super.destroy()}updateAllViewsAndRepaint(){this.updateAllViews((0,l.sourceChangeEvent)(this.id())),this._model.updateSource(this)}autoScaleInfo(){return{range:null}}lollipopsAtIndex(e){return!this.hideLollipops()&&this.data().contains(e)?1:0}hideLollipops(){{const e=this._model.mainSeries().intervalObj().value().inMilliseconds(u);if(e<432e6)return!1;return e/this._model.timeScale().barSpacing()>432e6}}async start(){const e=super.start();return this._model.mainSeries().dataEvents().symbolResolved().subscribe(this,this._initPlotStash),this._initPlotStash(),e}stop(){super.stop(),this._model.mainSeries().dataEvents().symbolResolved().unsubscribe(this,this._initPlotStash)}restoreData(e){e.data=e.data.filter((e=>e.index!==r.INVALID_TIME_POINT_INDEX&&this.isValid(e.value))),
this._transformData(e.data),e.end=e.data.length,super.restoreData(e)}onClickOutside(e,t){this._paneView.processClickOutside(e,t)}preferNoScale(){return!0}showInObjectTree(){return!1}isSavedInStudyTemplates(){return!1}isRemovedByStudyTemplates(){return!1}removeByRemoveAllStudies(){return!1}isDraggable(){return!1}copiable(){return!1}statusView(){return null}hasStateForAlert(){return!1}isSavedInChart(e){return Boolean(e)}isSpeciallyZOrderedSource(){return!0}isUserDeletable(){return!1}canHaveChildren(){return!1}isIncludedInAutoScale(){return!1}isCurrencySource(){return!1}isUnitSource(){return!1}_externalVisibilityProperty(){return null}_transformData(e){for(let t=e.length-1;t>=0;--t){const s=e[t],i=s.index!==r.INVALID_TIME_POINT_INDEX&&this.isValid(s.value);this._updatePlotStash(s,i)}}_createViews(){this._paneViews=[this._paneView],this._priceAxisViews=[],this._dataWindowView||(this._dataWindowView=new o.DataWindowView),this._legendView=null,this._statusView||(this._statusView=new n.StudyStatusView(this))}_seriesDataRangeToSave(e){return this._model.timeScale().visibleBarsStrictRange()}_initPlotStash(){this._plotStash={}}_updatePlotStash(e,t){if(this._restartRequired||!this._plotStash)return;const s=e.value.slice(),i=s.shift(),r=String(i);t?this._plotStash[r]?String(this._plotStash[r])!==String(s)&&(this._restartRequired=!0):this._plotStash[r]=s:this._plotStash[r]&&(this._restartRequired=!0)}}},328786:(e,t,s)=>{"use strict";s.d(t,{LollipopStudyPaneViewBase:()=>_});var i=s(86441),r=s(650151),o=s(444372),n=s(224743),a=s(493239),l=s(886338),u=s(700134),h=s(232650),c=s(437199),d=s(931924);class _ extends c.LollipopPaneView{constructor(){super(...arguments),this._getMoreFinancialsLinkInitialTabId="overview",this._symbolName=null}addLollipop(e,t,s,r,o,n,a){if(null===this._symbolName&&(this._symbolName=this._model.mainSeries().symbolInfo()?.name??null,null===this._symbolName))return;const l=`${this._source.metaInfo().id}_${this._lollipopId(n)}_${this._symbolName}`,u=this._lollipops[l],h=void 0!==u?u.itemIndex:this._lollipopsCounter++,c=this._model.lastHittestData(),d=this._model.hoveredSource()===this._source&&null!==c&&c.activeItem&&c.activeItem.itemIndex===h;this._lollipops[l]={id:l,itemIndex:h,visible:!0,basePoint:new i.Point(s.indexToCoordinate(o),e),hovered:d,stack:a,...this.extraData(n)}}renderer(e){return this._invalidated&&(this._updateImpl(e),this._invalidated=!1),this._source.hideLollipops()?null:this._renderer}_lollipopId(e){return e[0].toString()}_updateImpl(e){this._renderer.clear();const t=this._source.data(),s=this._model.timeScale(),i=s.visibleBarsStrictRange(),o=this._model.mainSeries().bars(),n=this._model.mainSeries(),a=n.priceScale(),l=n.firstBar();if(a.isEmpty()||s.isEmpty()||!l||!t||null===i)return;const u=this._model.mainPane();if(!u)return;if(this._source.hideLollipops())return void this._activeLollipopInfo.setValue(null);for(const e in this._lollipops)this._lollipops.hasOwnProperty(e)&&((0,r.ensureDefined)(this._lollipops[e]).visible=!1)
;const h=this._getY(),c=i.firstBar(),d=i.lastBar(),_=this._source.zorder(),p=u.lollipopDataSources().filter((e=>e!==this._source&&e.zorder()>_&&e.isVisible()));t.range(c,d).each(((e,t)=>{let i=0;for(const t of p)i+=t.lollipopsAtIndex(e);return this.addLollipop(h,o,s,a,e,t,i),!1})),this.afterUpdate(h,o,s,a),this._createRenderers(e)}_formatDate(e,t){let s,i=!0;if(i=l.Version.parse(this._source.metaInfo().version).isLessOrEqual(new l.Version(137,0)),i){let t="Etc/UTC";this._model.mainSeries().isDWM()||(t=this._model.timezoneExceptExchange().value()??"");const i=(0,a.get_timezone)(t);s=(0,a.utc_to_cal)(i,e)}else s=new Date(e);return(t?"â‰ˆ ":"")+this._model.dateFormatter().format(s)}_getMoreFinancialsLink(){if(!/\betf\b/i.test(this._model.mainSeries().symbolInfo()?.description||""))return{text:this._getMoreFinancialsLinkText(),onClick:()=>{n.globalCloseDelegate.fire(),d.enabled("mobile_app_action_open_financials_webview")?(0,h.openFinancialsWebview)(new URLSearchParams):(0,u.showFinancialsDialog)({initialTabId:this._getMoreFinancialsLinkInitialTabId})}}}_getMoreFinancialsLinkText(){return o.t(null,{replace:{symbol:this._model.mainSeries().symbolInfo()?.name??""}},s(148358))}_onSymbolOrIntervalChanged(){super._onSymbolOrIntervalChanged(),this._symbolName=null}}},698703:(e,t,s)=>{"use strict";s.r(t),s.d(t,{study_PivotPointsStandard:()=>V});var i=s(650151),r=s(384597),o=s(871934),n=s(688857);class a{constructor(e,t,s,i){this._priceAxisFontSize=11,this._prices=[],this._labelWidth=0,this._pixelRatioParams=e,this._recreateCanvasAndContext((0,o.size)({width:0,height:0})),this.reset({font:t,fontSize:s,backColors:i})}destroy(){delete this._canvas,delete this._cache}canvas(){return this._canvas}reset(e){this._renderParams=e,this._prices=[],this._cache.font=e.fontSize+"px "+e.font,this._labelWidth=["P","S1","R1","S2","R2","S3","R3","S4","R4","S5","R5","/"].reduce(((e,t)=>{const s=this._cache.measureText(t).width;return Math.max(s,e)}),0)}rowHeight(){return this._priceAxisFontSize+4}labelRectByIndex(e){return{left:0,top:Math.round(this._topByIndex(e)),width:Math.round(this._labelWidth+4),height:Math.round(this._renderParams.fontSize+8)}}setPrices(e){let t=!1;const s=(e,t)=>{const s=void 0===e,r=void 0===t;return(!s&&!r||s===r)&&(0,i.ensureDefined)(e).formatted===(0,i.ensureDefined)(t).formatted};if(e.length!==this._prices.length)t=!0;else for(let i=0;i<this._prices.length;i++)if(!s(this._prices[i],e[i])){t=!0;break}if(t){const t=this._labelWidth+6,s=this._renderParams.fontSize,i=Math.max(e.length,22)*(s+8);this._recreateCanvasAndContext((0,o.size)({width:t,height:i})),this._prices=e,this._cache.save(),(0,n.drawScaled)(this._cache,this._pixelRatioParams.horizontalPixelRatio,this._pixelRatioParams.verticalPixelRatio,(()=>{this._cache.translate(.5,.5),this._cache.font=this._renderParams.fontSize+"px "+this._renderParams.font,this._cache.textBaseline="middle";for(let e=0;e<this._prices.length;e++){if(!this._prices[e])continue;const t=["P","S1","R1","S2","R2","S3","R3","S4","R4","S5","R5"][e]
;this._cache.fillStyle=this._renderParams.backColors[e],this._cache.fillText(t,0,this._centerByIndex(e)),this._cache.fillText("/",0,this._centerByIndex(e+11))}})),this._cache.restore(),this._prices=e}}_recreateCanvasAndContext(e){this._canvas=document.createElement("canvas"),this._canvas.width=e.width*this._pixelRatioParams.horizontalPixelRatio,this._canvas.height=e.height*this._pixelRatioParams.verticalPixelRatio,this._cache=(0,i.ensureNotNull)(this._canvas.getContext("2d"))}_centerByIndex(e){return Math.round((e+.5)*(this._renderParams.fontSize+8))}_topByIndex(e){return Math.round(e*(this._renderParams.fontSize+8))}}var l=s(910282),u=s(597331),h=s(534328);const c=["P","S1","R1","S2","R2","S3","R3","S4","R4","S5","R5"];class d extends u.PriceAxisView{constructor(e,t){super(),this._source=e,this._data=t;const s=t.name;this._completeName="P"===s.toUpperCase()?"P":`S${s[1]}/R${s[1]}`}_updateRendererData(e,t,s){e.visible=!1,t.visible=!1;const i=this._source.properties().childs();if(!i.visible.value())return;const r=this._completeName,o=i.levelsStyle.childs().visibility.childs();if(!o[r]||!o[r].value())return;const n=this._source.model().timeScale(),a=this._source.priceScale();if(n.isEmpty()||null===n.visibleBarsStrictRange()||null!==a&&a.isEmpty())return;const l=this._source.customData();if(!l||!l.pivots)return;const u=this._source.pricesView().prices()[c.indexOf(this._data.name.toUpperCase())];if(!u)return;s.background=(0,h.resetTransparency)(u.color),s.textColor=this.generateTextColor(s.background),s.coordinate=u.coordinate,s.floatCoordinate=u.coordinate;const d=this._source.model().properties().childs().scalesProperties.childs();d.showStudyLastValue.value()&&(e.text=u.formatted,e.visible=!0),d.showStudyPlotLabels.value()&&(t.text=this._source.priceLabelText(this._data.name),t.visible=!0)}}var _=s(542301),p=s(844859),y=s(197860),f=s(584785);const m=["p","s1","r1","s2","r2","s3","r3","s4","r4","s5","r5"],S={P:"P",S1:"S1/R1",S2:"S2/R2",S3:"S3/R3",S4:"S4/R4",S5:"S5/R5",R1:"S1/R1",R2:"S2/R2",R3:"S3/R3",R4:"S4/R4",R5:"S5/R5"};class g{constructor(e){this._visiblePivots=new Set,this._invidated=!0,this._prices=[],this._source=e}visiblePivots(){return this._visiblePivots}update(){this._invidated=!0}prices(){return this._invidated&&(this._updateImpl(),this._invidated=!1),this._prices}_updateImpl(){this._visiblePivots.clear();const e=this._source.model(),t=this._source.priceScale();if(null===t)return;if(e.timeScale().isEmpty()||t.isEmpty())return;const s=e.timeScale().visibleBarsStrictRange();if(null===s)return;if(!this._source.customData()||!this._source.customData().pivots)return;const i=e.mainSeries().bars().search(s.lastBar(),f.PlotRowSearchMode.NearestLeft);if(null===i)return;const r=this._source.indexes();if(!r)return;const o=i.index,n=this._source.customData().pivots,a=this._source.properties().childs(),l=this._source.firstValue();for(let e=0;e<n.length;e++){if(!n[e])continue;const s=r[n[e].startIndex],i=r[n[e].endIndex],u=a.inputs.childs().showHistoricalPivots.value();if(s<=o&&(i>=o||u)){this._visiblePivots.add(n[e]),
this._prices=[];for(let s=0;s<m.length;s++){const i=m[s],r=n[e][i];if(void 0===r||null===l)continue;const o=t.priceToCoordinate(r,l),u=i.toUpperCase(),h=S[u],c=a.levelsStyle.childs().colors.childs()[h].value();this._prices.push({formatted:t.formatPrice(r,l),price:r,coordinate:o,color:c})}}}}}var v=s(86441),b=s(257145),w=s(708162),C=s(654397),x=s(731974),D=s(320994);class P extends D.BitmapCoordinatesPaneRenderer{constructor(e,t,s){super(),this._drawRects=[],this._cacheProvider=e,this._point=t,this._label=s}hitTest(e){for(const t of this._drawRects)if(e.x>=t.left&&e.x<=t.left+t.width&&e.y>=t.top&&e.y<=t.top+t.height)return new x.HitTestResult(x.HitTarget.Regular);return null}_drawImpl(e){const t=this._cacheProvider(e),{horizontalPixelRatio:s,verticalPixelRatio:i,context:r}=e;this._drawRects=[];const o=e=>{const o=t.labelRectByIndex(e),n={left:Math.round(this._point.x-o.width+a),top:Math.round(this._point.y-o.height/2),width:o.width,height:o.height};return r.drawImage(t.canvas(),Math.round(o.left*s),Math.round(o.top*i),o.width*s,o.height*i,Math.round(n.left*s),Math.round(n.top*i),n.width*s,n.height*i),this._drawRects.push(n),o.width},n=this._label.split("/");let a=0;for(let e=0;e<n.length;e++){const t=["P","S1","R1","S2","R2","S3","R3","S4","R4","S5","R5"].indexOf(n[e]);e>0&&(a+=o(t+11)/2),a+=o(t)/2}}}function I(e){return"P"===e?e:"S"+e[1]+"/R"+e[1]}function T(e,t,s){const i=t;void 0===e[i]?e[i]={text:s,ids:[I(s)]}:(e[i].text+="/"+s,e[i].ids.push(I(s)))}class A{constructor(e,t){this._pivots=[],this._invalidated=!0,this._renderer=new w.CompositeRenderer,this._model=e,this._source=t,this._cacheProvider=this._source.getCache.bind(this._source)}update(e){this._invalidated=!0}renderer(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._renderer}_updateImpl(){this._renderer.clear();const e=this._source.ownerSource();if(null===e)return;this._source.pricesView().prices(),this._pivots=[];const t=this._source.customData();if(!t||!t.pivots)return;const s=this._source.properties().childs();if(!s.visible.value())return;const r=t.pivots,o=this._source.indexes(),n=this._model.timeScale(),a=this._source.priceScale(),l=e.firstValue();if(!a||a.isEmpty()||n.isEmpty()||!r||!o||null===l)return;const u=(0,i.ensureNotNull)(n.visibleBarsStrictRange()),h=u.firstBar(),c=u.lastBar();for(let e=0;e<r.length;e++){if(!r[e])continue;const t=o[r[e].startIndex],i=o[r[e].endIndex];if(i<h||t>c)continue;const u={},d=s.levelsStyle.childs().visibility.childs();d.P.value()&&T(u,r[e].p,"P"),d["S1/R1"].value()&&(T(u,r[e].s1,"S1"),T(u,r[e].r1,"R1")),d["S2/R2"].value()&&(T(u,r[e].s2,"S2"),T(u,r[e].r2,"R2")),d["S3/R3"].value()&&(T(u,r[e].s3,"S3"),T(u,r[e].r3,"R3")),d["S4/R4"].value()&&(T(u,r[e].s4,"S4"),T(u,r[e].r4,"R4")),d["S5/R5"].value()&&(T(u,r[e].s5,"S5"),T(u,r[e].r5,"R5"));const _=n.indexToCoordinate(t),p=n.indexToCoordinate(i);for(const t of Object.keys(u)){const s=parseFloat(t),i=a.priceToCoordinate(s,l);this._pivots.push({x1:_,x2:p,y:i,label:u[t].text,labelIds:u[t].ids,src:r[e]})}}
const d=s.levelsStyle.childs().colors,_=s.levelsStyle.childs().widths,p=this._source.visiblePivots();for(let e=0;e<this._pivots.length;e++){const t=this._pivots[e];if(!p.has(t.src))continue;const i={color:d.childs()[t.labelIds[0]].value(),linewidth:_.childs()[t.labelIds[0]].value(),linestyle:b.LINESTYLE_SOLID,y:t.y,left:t.x1,right:t.x2},r=new C.HorizontalLineRenderer;r.setData(i),r.setHitTest(new x.HitTestResult(x.HitTarget.Regular)),this._renderer.append(r),s.levelsStyle.childs().showLabels.value()&&this._renderer.append(new P(this._cacheProvider,new v.Point(t.x1,t.y),t.label))}}}var R=s(397535);class V extends r.NonSeriesStudy{constructor(e,t,s,i,r,o){super(e,t,s,i,r,o),this._cache=null,this._cachedPixelRatioParams=null;const n=["P","S1/R1","S2/R2","S3/R3","S4/R4","S5/R5"],a=this.properties().childs().levelsStyle.childs().visibility;for(let e=0;e<n.length;e++)a.childs()[n[e]].subscribe(this,(()=>this.processHibernate()))}pricesView(){return this._pricesView}indexes(){return this._indexes}properties(){return this._properties}getCache(e){if(null===this._cache||null==this._cachedPixelRatioParams||(t=e,s=this._cachedPixelRatioParams,t.horizontalPixelRatio!==s.horizontalPixelRatio||t.verticalPixelRatio!==s.verticalPixelRatio)){this._cache&&this._cache.destroy();const t=this._getActualCacheParams(),s={horizontalPixelRatio:e.horizontalPixelRatio,verticalPixelRatio:e.verticalPixelRatio};this._cache=new a(s,t.font,t.fontSize,t.backColors),this._cache.setPrices((0,i.ensureNotNull)(this._pricesView).prices()),this._cachedPixelRatioParams=s,this._cache.reset(t)}var t,s;return this._cache}priceLabelText(e){return this._metaInfo.value().shortDescription+":"+e.toUpperCase()}updateAllViews(e){super.updateAllViews(e),this._pricesView.update()}visiblePivots(){return this._pricesView.visiblePivots()}isVisible(){if(!this.properties().childs().visible.value()||!this.isActualInterval())return!1;const e=["P","S1/R1","S2/R2","S3/R3","S4/R4","S5/R5"],t=this.properties().childs().levelsStyle.childs().visibility;for(let s=0;s<e.length;s++)if(t.childs()[e[s]].value())return!0;return!1}stop(){super.stop(),this._cache&&(this._cache.destroy(),this._cache=null)}priceRange(e,t,s){if(s.targetPriceScale!==this.priceScale())return null;const i=this.customData()?.pivots;if(!i||!this._indexes)return null;if(!this.priceScale())return null;const r=i,o=this._indexes;let n=null;for(let s=0;s<r.length;s++){if(!r[s])continue;const i=o[r[s].startIndex];if(o[r[s].endIndex]<e||i>t)continue;const a=[],l=this.properties().childs().levelsStyle.childs().visibility.childs();l.P.value()&&a.push(r[s].p),l["S1/R1"].value()&&a.push(r[s].s1,r[s].r1),l["S2/R2"].value()&&a.push(r[s].s2,r[s].r2),l["S3/R3"].value()&&a.push(r[s].s3,r[s].r3),l["S4/R4"].value()&&a.push(r[s].s4,r[s].r4),l["S5/R5"].value()&&a.push(r[s].s5,r[s].r5);for(let e=0;e<a.length;e++)a[e]&&(null===n?n=new R.PriceRange(a[e],a[e]):n.apply(a[e],a[e]))}const a=this.priceScale();return a&&a.isLog()&&n?new R.PriceRange(a.priceToLogical(n.minValue()),a.priceToLogical(n.maxValue())):n}_createViews(){
this._cache&&(this._cache.destroy(),this._cache=null),this._priceAxisViews=[];const e=["P","S1","R1","S2","R2","S3","R3","S4","R4","S5","R5"];this._paneViews.length=0,this._labelPaneViews=[];const t=new A(this._model,this);this._paneViews.push(t);for(let t=0;t<e.length;t++){const s=new d(this,{name:e[t]});this._priceAxisViews.push(s),this._labelPaneViews.push(new _.PanePriceAxisView(s,this,this._model))}this._dataWindowView||(this._dataWindowView=new p.StudyDataWindowView(this,this._model)),this._statusView||(this._statusView=new y.StudyStatusView(this)),this._legendView=null,this._pricesView=new g(this)}_postProcessGraphics(){}_getActualCacheParams(){const e=this.properties().childs(),t=e.levelsStyle.childs().colors.childs();return{font:l.CHART_FONT_FAMILY,fontSize:e.fontsize.value(),backColors:[t.P.value(),t["S1/R1"].value(),t["S1/R1"].value(),t["S2/R2"].value(),t["S2/R2"].value(),t["S3/R3"].value(),t["S3/R3"].value(),t["S4/R4"].value(),t["S4/R4"].value(),t["S5/R5"].value(),t["S5/R5"].value()]}}}},31857:(e,t,s)=>{"use strict";s.r(t),s.d(t,{study_ESD$TV_ROLLDATES:()=>k});var i=s(758868),r=s(154834),o=s(790188),n=s(444372),a=s(214258),l=s(825957),u=s(328786),h=s(257145),c=s(837462),d=s(910282),_=s(534328),p=s(554255),y=s(528474);const f=[n.t(null,void 0,s(100200)),n.t(null,void 0,s(581069)),n.t(null,void 0,s(193878)),n.t(null,void 0,s(528896)),n.t(null,void 0,s(125734)),n.t(null,void 0,s(661487)),n.t(null,void 0,s(206608)),n.t(null,void 0,s(811081)),n.t(null,void 0,s(632179)),n.t(null,void 0,s(137997)),n.t(null,void 0,s(604607)),n.t(null,void 0,s(890082))];var m=s(731974),S=s(338242),g=s(398453);const v=new Path2D("m13 6.02.5-.52-.5-.52-3.33-3.5-1.09 1.04 2.13 2.23H6.23L2.13.95l-1.01 1.1 4.3 4 .22.2H10.71L8.58 8.48l1.09 1.04 3.34-3.5Zm-9.4.45-3 3 1.06 1.06 3-3L3.6 6.47Z");class b extends g.LollipopRenderer{_drawLollipop(e,t,s){const i=this._data.style;e.save(),e.translate(t.x,t.y),e.scale(s.horizontalPixelRatio,s.verticalPixelRatio),e.beginPath(),e.strokeStyle=i.outerBorderColor,e.lineWidth=1,e.arc(0,0,11,0,2*Math.PI),e.stroke(),e.fillStyle=i.backgroundColor,e.beginPath(),e.arc(0,0,10.5,0,2*Math.PI),e.fill(),e.translate(-6.5,-5.5),e.fillStyle=i.iconColor,e.fill(v),e.translate(6.5,5.5),i.borderColor&&(e.strokeStyle=i.borderColor,e.lineWidth=1.5,(0,S.setLineStyle)(e,h.LINESTYLE_SOLID),e.beginPath(),e.arc(0,0,9.75,0,2*Math.PI),e.stroke()),e.restore()}}var w=s(85752);const C=n.t(null,void 0,s(716110)),x=n.t(null,void 0,s(198605)),D=n.t(null,void 0,s(560249)),P=n.t(null,void 0,s(722677)),I={dark:{background:(0,o.getHexColorByName)("color-cold-gray-900"),foreground:(0,o.getHexColorByName)("color-deep-blue-a200"),linkColor:(0,o.getHexColorByName)("color-tv-blue-500")},light:{background:(0,o.getHexColorByName)("color-white"),foreground:(0,o.getHexColorByName)("color-deep-blue-a400"),linkColor:(0,o.getHexColorByName)("color-tv-blue-500")}},T={barLine:{lineStyle:h.LINESTYLE_DASHED,lineWidth:1,strokeStyle:""},lollipop:{width:21,height:21,bottom:2,lineWidth:1.5,strokeStyle:"",backgroundColor:"",fillCircle:!0,fillStyle:"",text:{
label:"",strokeStyle:"",font:(0,c.makeFont)(12,d.CHART_FONT_FAMILY,"bold")}},iconColor:"",backgroundColor:"",outerBorderColor:""},A=["F","G","H","J","K","M","N","Q","U","V","X","Z"];function R(e,t){const s=Math.floor(t/100),i=t-100*s-1;return{name:`${e}${A[i]}${s}`,expirationDate:`${f[i]} ${s}`}}class V extends u.LollipopStudyPaneViewBase{extraData(e){const t=[];for(let s=0;s<4;++s){const i=3*s+1;if(!Boolean(e[i]))break;t.push({currentContractCode:e[i],nextContractCode:e[i+1],switchDate:e[i+2]})}return{items:t}}_createRendererForLollipop(e,t){return new b(e,new m.HitTestResult(m.HitTarget.Custom,t),this._textWidthCache)}_createTooltipContent(e){return e.items.map((e=>{const t=[{name:P,value:(0,p.formatYYYYMMDD)(this._model.dateFormatter(),e.switchDate)}],i=this._model.dark().value()?I.dark:I.light,r=this._model.mainSeries(),o=this._model.mainSeries().symbolInfo();if(null!==o&&void 0!==o.root){const s=o.listed_exchange,n={color:i.linkColor,cursor:"pointer"},a=R(o.root,e.currentContractCode);t.push({name:x,value:a.name,valueStyle:n,onValueClick:()=>this._model.undoModel().setSymbol(r,`${s}:${a.name}`)}),t.push({name:" ",value:a.expirationDate});const l=R(o.root,e.nextContractCode);t.push({name:D,value:l.name,valueStyle:n,onValueClick:()=>this._model.undoModel().setSymbol(r,`${s}:${l.name}`)}),t.push({name:" ",value:l.expirationDate})}return{title:C,informationButtonProps:{ariaLabel:n.t(null,void 0,s(750619)),icon:"question",onClick:()=>(0,l.showSupportDialog)({solutionId:a.solutionIds.SWITCHING_CONTINUOUS_FUTURES_CONTRACTS})},icon:w,style:{color:i.foreground},main:{type:"common",title:t}}}))}_lollipopId(e){return e[3].toString()}_showBarLine(e){return super._showBarLine(e)||this._model.mainSeries().properties().childs().showContinuousContractSwitchesBreaks.value()}_recreateStyles(e){const t=this._model.dark().value()?I.dark:I.light,s=t.foreground,i=t.background,o=(0,r.default)(T);o.iconColor=s,o.borderColor=s,o.backgroundColor=i,o.outerBorderColor=i,o.barLine.strokeStyle=s,this._defaultStyle=o;const n=(0,r.default)(o);n.backgroundColor=(0,y.blendColors)(i,(0,_.applyAlpha)(s,.15)),this._hoveredStyle=n;const a=(0,r.default)(o);a.backgroundColor=s,a.iconColor=i,a.borderColor=void 0,this._activeStyle=a,this._stylesCache=null}}var M=s(839800),E=s(536794);class k extends i.LollipopStudyBase{id(){return"ESD$TV_ROLLDATES"}zorder(){return M.sortSourcesPreOrdered.RollDates}isValid(e){const t=e[4];return(0,E.isNumber)(t)}_createViews(){this._paneView=new V(this._model,this),super._createViews()}_externalVisibilityProperty(){return this._model.mainSeries().properties().childs().showContinuousContractSwitches}}},445296:(e,t,s)=>{"use strict";s.r(t),s.d(t,{ReplayStudyStrategy:()=>n});var i=s(252010),r=s(454184),o=s(925049);class n extends i.StudyStrategy{constructor(e,t,s,i,r,o){t.merge({strategy:{orders:{showLabels:!0,showQty:!0,visible:!0}}}),super(e,t,s,i,r,o,!0),this._notifyStudyTurnaroundCounter=0,this._notificationsInProgress=new Map,this._replayStudyProperties=null,this._assignRecoveryState=()=>{
const e=this.properties().childs().inputs,t=this._recoveryState();"recoveryState"in e.childs()&&e.childs().recoveryState.setValue(JSON.stringify(t))};const n=this.properties().childs().inputs;e.mainSeries().onIntervalChanged().subscribe(this,this._assignRecoveryState),e.replayStudyStrategyProperties().then((e=>{this._isDestroyed||(this._replayStudyProperties=e,this._replayStudyProperties.subscribe(this,(()=>{this.properties().childs().inputs.mergeAndFire(e.state())})),this.properties().childs().inputs.mergeAndFire(e.state()))})),n.subscribe(this,((e,t)=>{"recoveryState"!==t&&this._assignRecoveryState()}))}destroy(){this._notificationsInProgress.forEach((e=>{e.reject("The study has been destroyed")})),this._model.mainSeries().onIntervalChanged().unsubscribeAll(this),this._replayStudyProperties?.unsubscribeAll(this),super.destroy()}clearRecoveryStateAndReport(){const e=this.properties().childs().inputs;"recoveryState"in e.childs()&&e.childs().recoveryState.setValue("{}"),this._reportData=null}clearData(){this._assignRecoveryState(),super.clearData()}showInObjectTree(){return!1}statusView(){return null}async notifyStudy(e){await this._waitForComplete();const t="notify_"+ ++this._notifyStudyTurnaroundCounter,s=(0,o.createDeferredPromise)();return this._notificationsInProgress.set(t,s),this._sendNotifyCommand(t,e),s.promise}removeByRemoveAllStudies(){return!1}isRemovedByStudyTemplates(){return!1}isSavedInChart(e){return!1}isSavedInStudyTemplates(){return!1}_onData(e){if("notify_study_ok"===e.method){const t=e.params[1];this._notificationsInProgress.get(t)?.resolve(),this._notificationsInProgress.delete(t)}if("notify_study_error"===e.method){const t=e.params[1],s=e.params[2];this._notificationsInProgress.get(t)?.reject(s),this._notificationsInProgress.delete(t)}super._onData(e)}async _waitForComplete(){if(this.status().type!==r.StudyStatusType.Completed)return new Promise(((e,t)=>{const s=i=>{i.type===r.StudyStatusType.Completed?(this.onStatusChanged().unsubscribe(null,s),e()):i.type===r.StudyStatusType.Error&&(this.onStatusChanged().unsubscribe(null,s),t(i.errorDescription))};this.onStatusChanged().subscribe(null,s)}))}_recoveryState(){const e=this.reportData();if(!e){const e=this.properties().childs().inputs.childs().recoveryState.value();return JSON.parse(e)}const{activeOrders:t,filledOrders:s}=e;return{activeOrders:t,filledOrders:s}}}},901466:(e,t,s)=>{"use strict";s.r(t),s.d(t,{StudyDataSource:()=>p});var i=s(650151),r=s(547465),o=s(132565),n=s(359035),a=s(807958),l=s(259710),u=s(587482),h=s(284881),c=s(808825);const d=(0,s(735566).getLogger)("Chart.StudyDataSource");var _;!function(e){e[e.Idle=0]="Idle",e[e.AwaitingConnection=1]="AwaitingConnection",e[e.AwaitingParent=2]="AwaitingParent",e[e.AwaitingFirstDataUpdate=3]="AwaitingFirstDataUpdate",e[e.Active=4]="Active"}(_||(_={}));class p{constructor(e,t,s,i,n=!1){this._inputs=null,this._status=_.Idle,this._studyId=null,this._turnaroundCounter=1,this._studyStatus={type:c.StudyStatusType.Undefined},this._studyStatusChanged=new r.Delegate,this._dataCleared=new r.Delegate,
this._dataUpdated=new r.Delegate,this._boundOnGatewayIsConnectedChanged=this._onGatewayIsConnectedChanged.bind(this),this._ongoingDataUpdate=Promise.resolve(),this._gateway=e,this._metaInfo=i,this._forceUseExclamationMark=n,this._seriesSource=t,this._turnaroundPrefix=s,this._plots=new o.PlotList((0,u.studyPlotFunctionMap)(i),u.studyEmptyPlotValuePredicate),this._gateway.isConnected().subscribe(this._boundOnGatewayIsConnectedChanged),this._graphics=new h.LiveStudyGraphics(i.graphics)}destroy(){this.stop(),this._gateway.isConnected().unsubscribe(this._boundOnGatewayIsConnectedChanged),this._seriesSource.dataEvents().created().unsubscribeAll(this)}metaInfo(){return this._metaInfo}inputs(){return this._inputs}setInputs(e){this._inputs=e,null!==this._studyId&&(this._turnaroundCounter++,this._onStudyStatusChangedTo({type:c.StudyStatusType.Undefined}),this._gateway.modifyStudy(this._studyId,this._turnaround(),e,this._onMessage.bind(this)),this._status===_.Active&&this._changeStatusTo(_.AwaitingFirstDataUpdate))}isStarted(){return this._status!==_.Idle}isActive(){return this._status===_.Active}start(){this.isStarted()?d.logNormal("start: data source is already started, nothing to do"):((0,i.assert)(null!==this._inputs,"Inputs should be defined when starting a study data source"),this._gateway.isConnected().value()?this._createStudy():this._changeStatusTo(_.AwaitingConnection))}stop(){this.isStarted()?(null!==this._studyId&&(this._gateway.isConnected().value()&&this._gateway.removeStudy(this._studyId),this._studyId=null,this._onStudyStatusChangedTo({type:c.StudyStatusType.Undefined})),this._changeStatusTo(_.Idle)):d.logNormal("stop: data source is already stopped, nothing to do")}studyId(){return this._studyId}studyStatus(){return this._studyStatus}studyStatusChanged(){return this._studyStatusChanged}plots(){return this._plots}graphics(){return this._graphics}clearData(){this._plots.clear(),this._graphics.clear(),this._dataCleared.fire()}stopAndStealData(){(0,i.assert)(this._status===_.Active,"Couldn't steal data from non-active data source"),this.stop();const e=this._plots,t=this._graphics.extract();return this._plots=new o.PlotList((0,u.studyPlotFunctionMap)(this._metaInfo),u.studyEmptyPlotValuePredicate),{plots:e,graphics:t}}dataCleared(){return this._dataCleared}dataUpdated(){return this._dataUpdated}moveData(e){this._ongoingDataUpdate=this._ongoingDataUpdate.then((()=>{this._plots.move(e)}))}pendingUpdatesReady(){return this._ongoingDataUpdate}_createStudyError(e){return{type:c.StudyStatusType.Error,errorDescription:this._getStudyErrorDescription(e)}}_getStudyErrorDescription(e){return"string"==typeof e?{error:e.split(":",2)[0]}:e}_changeStatusTo(e){(0,i.assert)(this._status!==e,"Source and destination status should be distinct"),d.logNormal(`Status changed from ${_[this._status]} to ${_[e]}`),this._status=e}_createStudy(){const e=this._seriesSource.instanceId();null!==e?this._createStudyUsingParentId(e):(this._changeStatusTo(_.AwaitingParent),
this._seriesSource.dataEvents().created().subscribe(this,this._onSeriesCreated,!0))}_createStudyUsingParentId(e){(0,i.assert)(this._status!==_.Active,'Status should not be "Active" when creating a study'),(0,i.assert)(this._studyStatus.type===c.StudyStatusType.Undefined,'Study status should be "Undefined" when creating a study'),(0,i.assert)(null===this._studyId,"Study id should be empty when creating a study"),this._studyId=(0,l.makeNextStudyId)(),this._gateway.createStudy(this._studyId,this._turnaround(),e,a.StudyMetaInfo.getStudyIdWithLatestVersion(this.metaInfo(),this._forceUseExclamationMark),(0,i.ensureNotNull)(this._inputs),this._onMessage.bind(this),{id:this._metaInfo.id}),this._changeStatusTo(_.AwaitingFirstDataUpdate)}_onGatewayIsConnectedChanged(e){e?this._onGatewayConnected():this._onGatewayDisconnected()}_onGatewayConnected(){this._status===_.AwaitingConnection&&this._createStudy()}_onGatewayDisconnected(){this._status!==_.Idle&&this._status!==_.AwaitingConnection&&(this._studyId=null,this._changeStatusTo(_.AwaitingConnection),this._studyStatus.type!==c.StudyStatusType.Undefined&&this._onStudyStatusChangedTo({type:c.StudyStatusType.Undefined})),this._turnaroundCounter=1}_onSeriesCreated(){this._status===_.AwaitingParent&&this._createStudyUsingParentId((0,i.ensure)(this._seriesSource.instanceId()))}_onStudyStatusChangedTo(e){const t=this._studyStatus;this._studyStatus=e,d.logNormal(`Study status type changed from ${c.StudyStatusType[t.type]} to ${c.StudyStatusType[e.type]}`),this._studyStatusChanged.fire(t,e)}_onMessage(e){if("data_update"===e.method){const{customId:t,turnaround:s,plots:r,nonseries:o}=e.params;t===this._studyId&&this._checkTurnaround(s)&&this._onDataUpdate(r,(0,i.ensureDefined)(o))}else if("study_loading"===e.method){const[t,s]=e.params;t===this._studyId&&this._checkTurnaround(s)&&this._onStudyLoading(e.time)}else if("study_completed"===e.method){const[t,s]=e.params;t===this._studyId&&this._checkTurnaround(s)&&this._onStudyCompleted(e.time)}else if("study_error"===e.method){const[t,s,i,r]=e.params;t===this._studyId&&this._checkTurnaround(s)&&this._onStudyError(i,r,e.time)}else"clear_data"===e.method&&this._checkTurnaround(e.params.turnaround)&&this.clearData()}_onDataUpdate(e,t){const s=(0,n.unpackNonSeriesData)(t.d);return this._ongoingDataUpdate=this._ongoingDataUpdate.then((()=>s),(()=>s)).then(this._onDataUnpacked.bind(this,e,t.indexes)),this._ongoingDataUpdate}_onDataUnpacked(e,t,s){this._status!==_.Idle&&(this._status===_.AwaitingFirstDataUpdate&&(this._changeStatusTo(_.Active),this.clearData()),this._mergePlots(e),null!==s&&(s.indexes_replace?((0,i.assert)("nochange"!==t),this._graphics.replaceIndexesTo(t)):("nochange"!==t&&this._graphics.replaceIndexesTo(t),void 0!==s.graphicsCmds&&this._graphics.processCommands(s.graphicsCmds))),this._dataUpdated.fire(e,s,t))}_onStudyLoading(e){this._onStudyStatusChangedTo({type:c.StudyStatusType.Loading,startTime:Date.now()})}_onStudyError(e,t,s){this.clearData(),this._onStudyStatusChangedTo(this._createStudyError(e))}_onStudyCompleted(e){
this._onStudyStatusChangedTo({type:c.StudyStatusType.Completed})}_mergePlots(e){this._plots.merge(e)}_turnaround(){return`${this._turnaroundPrefix}${this._turnaroundCounter}`}_checkTurnaround(e){const t=this._turnaround();return e===t||e===this._seriesSource.turnaround()||e===`${this._seriesSource.turnaround()}_${t}`}}},231406:(e,t,s)=>{"use strict";s.r(t),s.d(t,{study_ScriptWithDataOffset:()=>l});var i=s(650151),r=s(810715),o=s(132565),n=s(631114),a=s(587482);class l extends n.Study{constructor(e,t,s,i,r,n){super(e,t,s,i,r,n),this._underlyingData=new o.PlotList((0,a.studyPlotFunctionMap)(i),a.studyEmptyPlotValuePredicate)}clearData(){super.clearData(),this._underlyingData.clear()}_mergeData(e){this._invalidateLastNonEmptyPlotRowCache();const t=this._underlyingData.firstIndex();this._underlyingData.merge(e),t!==this._underlyingData.firstIndex()&&(this._data=new o.PlotList((0,a.studyPlotFunctionMap)(this._metaInfo.value()),a.studyEmptyPlotValuePredicate));let s=null;const i=this._data.lastIndex()??this._underlyingData.firstIndex(),n=this._underlyingData.lastIndex();if(null!==i&&null!==n)for(const e of this._underlyingData.rangeIterator(i,n))null===s&&(s=e),this._data.add(e.index,(0,r.clone)(e.value));for(const e of this._plotsForStrategyProcessing()){new u(e.strategyIndex,e.targetIndex,i).rebuildData(this._data)}return s}_plotsForStrategyProcessing(){const e=this._metaInfo.value(),t=[];return e.plots.forEach(((s,r)=>{if("dataoffset"!==s.type)return;const o=e.plots.findIndex((e=>e.id===s.target));(0,i.assert)(o>=0,`target plot not found for strategy plot ${s.id}`),t.push({strategyIndex:r,targetIndex:o})})),t}}class u{constructor(e,t,s){this._strategyPlotIndex=e,this._targetPlotIndex=t,this._startIndex=s}rebuildData(e){const t=this._targetPlotIndex+1,s=this._strategyPlotIndex+1;let i=null,r=null;const o=this._startIndex??e.firstIndex(),n=e.lastIndex();if(null!==o&&null!==n)for(const{index:a,value:l}of e.rangeIterator(o,n)){const o=l[t],n=l[s]?Math.round(l[s]):null;if(l[t]=null,l[s]=null,!n||n>0)continue;const u=a+n,h={pointIndex:u,value:o};if(r){if(r.pointIndex!==h.pointIndex){if(u>=0){const s=e.valueAt(u);s&&(s[t]=o)}let s=!1;if(i&&r&&(s=i.value<=r.value&&r.value<=o||i.value>=r.value&&r.value>=o),s){if(r.pointIndex>=0){const s=e.valueAt(r.pointIndex);s&&(s[t]=null)}}else i=r;r=h}}else r=h}}}},141653:(e,t,s)=>{"use strict";s.r(t),s.d(t,{TpoPeriodicStudy:()=>h,createTpoPeriodicStudy:()=>c});var i=s(650151),r=s(870855),o=s(388741),n=s(37241),a=s(87347),l=s(340993),u=s(407232);class h extends u.TpoStudyBase{splitMergeSupported(){return!0}_splitsAndMergesActionsValue(){return this._splitsAndMerges[this._splitsAndMergesActionsKey()]??this._splitsAndMerges[this._splitsAndMergesActionsKey(1)]??null}_updateSplitsAndMergesActionsValue(e){this._splitsAndMerges[this._splitsAndMergesActionsKey()]=e,this._removeSplitsAndMergesActionsValue(1)}_removeSplitsAndMergesActionsValue(e=2){delete this._splitsAndMerges[this._splitsAndMergesActionsKey(e)],2===e&&this._removeSplitsAndMergesActionsValue(1)}_splitsAndMergesActionsKey(e=2){
const t=this._model.mainSeries(),s=t.proSymbol(),i=this.properties().childs().inputs.childs(),r=[s,this._chartStyleMode||(0,o.isTimeBasedStyle)(t.style())?"common":t.style(),i.blockSize.value(),i.periodsNum.value(),i.period.value()];return e>1&&r.push(t.sessionId()),r.join(";")}_splitsAndMergesInputsDeps(){return["blockSize","periodsNum","period"]}}async function c(e,t){const s=(0,i.ensureDefined)(r.SYMBOL_STRING_DATA[18]),o=await(0,a.studyMetaInfoRepository)().findById({type:"java",studyId:s.type}),u=(0,n.prepareStudyProperties)(o,{},null,(0,a.studyMetaInfoRepository)().studyVersioning(),[]);return(0,l.addStudyInfoToMap)("study_TPOPeriodic",{studyConstructor:h,colorRotationMode:"shift"}),new h(e,u,[],o,o,!1,!0,t)}},861715:(e,t,s)=>{"use strict";s.r(t),s.d(t,{TpoSessionsStudy:()=>r});var i=s(407232);class r extends i.TpoStudyBase{splitMergeSupported(){return!1}}},928047:(e,t,s)=>{"use strict";s.r(t),s.d(t,{VolumeFootprintStudy:()=>u,createVolumeFootprintStudy:()=>h});var i=s(650151),r=s(631114),o=s(37241),n=s(87347),a=s(870855),l=s(340993);class u extends r.Study{constructor(){super(...arguments),this._rowSize=.1}rowSize(){return this._rowSize}hasStateForAlert(){return!1}paneViews(){return this._paneViews}priceScale(){return this._model.mainSeries().priceScale()}firstValue(){return this._model.mainSeries().firstValue()}stateCustomFields(){return{rowSize:this._rowSize}}restoreStateCustomFields(e){this._rowSize=e.rowSize??this._rowSize}_onDataUpdated(e,t,s,i){super._onDataUpdated(e,t,s,i),t?.indexes_replace||(this._rowSize=(t?.data).rowSize??this._rowSize)}}async function h(e){const t=(0,i.ensureDefined)(a.SYMBOL_STRING_DATA[17]),s=await(0,n.studyMetaInfoRepository)().findById({type:"java",studyId:t.type}),r=(0,o.prepareStudyProperties)(s,{},null,(0,n.studyMetaInfoRepository)().studyVersioning(),[]);return(0,l.addStudyInfoToMap)("study_VolumeFootprint",{studyConstructor:u,colorRotationMode:"shift"}),new u(e,r,[],s,s,!1)}},926801:(e,t,s)=>{"use strict";s.r(t),s.d(t,{SessionVolume2Study:()=>A});var i=s(650151),r=s(963894),o=s(444372),n=s(132565),a=s(657619),l=s(479483),u=s(833214),h=s(454184),c=s(590178),d=s(587482),_=s(196302);class p{constructor(e,t){this._rough=e,this._detailed=t}forEach(e,t){this._mostDetailedHorizLines().forEach((s=>{e.call(t,s,s,this)}))}has(e){let t=!1;return this._mostDetailedHorizLines().forEach((s=>{t=t||s===e})),t}get size(){return this._rough.size}[Symbol.iterator](){const e=this._mostDetailedHorizLines().entries();return{[Symbol.iterator](){return this},next(){const t=e.next();return!0===t.done?t:{value:t.value[1]}}}}entries(){throw new Error("Not implemented")}keys(){throw new Error("Not implemented")}values(){throw new Error("Not implemented")}_mostDetailedHorizLines(){const e=new Map;this._rough.forEach((t=>e.set(t.startIndex,t)));for(let t=this._detailed.length-1;t>=0;t--){this._detailed[t].forEach((t=>{e.has(t.startIndex)&&e.set(t.startIndex,t)}))}return e}}class y{constructor(e,t){this._mergedHorizLinesSet=e,this._roughIterator=t}[Symbol.iterator](){return this}next(){
const e=this._roughIterator.next();if(!0===e.done)return e;const t=e.value[0];return{value:[t,(0,i.ensureDefined)(this._mergedHorizLinesSet.get(t))]}}}class f{constructor(e,t){this._roughHorizLineSets=e,this._detailedHorizLineSets=t}forEach(e,t){this._roughHorizLineSets.forEach(((s,r)=>{e.call(t,(0,i.ensureDefined)(this.get(r)),r,this)}))}get(e){const t=this._roughHorizLineSets.get(e);if(void 0!==t)return new p(t,this._detailedHorizLineSets.map((t=>t.get(e))).filter((e=>void 0!==e)))}has(e){return this._roughHorizLineSets.has(e)}get size(){return this._roughHorizLineSets.size}[Symbol.iterator](){return new y(this,this._roughHorizLineSets.entries())}entries(){throw new Error("Not implemented")}keys(){throw new Error("Not implemented")}values(){throw new Error("Not implemented")}}class m{constructor(e,t){this._rough=e,this._detailed=t}forEach(e,t){this._rough.forEach(((s,i)=>{for(const s of this._detailed){const r=s.get(i);if(void 0!==r)return void e.call(t,r,i,this)}e.call(t,s,i,this)}))}get(e){for(const t of this._detailed){const s=t.get(e);if(void 0!==s)return s}return this._rough.get(e)}has(e){for(const t of this._detailed){if(t.has(e))return!0}return this._rough.has(e)}get size(){return this._rough.size}[Symbol.iterator](){throw new Error("Not implemented")}entries(){throw new Error("Not implemented")}keys(){throw new Error("Not implemented")}values(){throw new Error("Not implemented")}}class S{constructor(e,t){this._graphics=e,this._styleId=t}forEach(e,t){this._graphics.hhistsByTimePointIndex().forEach((s=>{s.forEach((s=>{if(s.styleId===this._styleId){const i={firstBarTime:s.firstBarTime,lastBarTime:s.lastBarTime,rate:s.rate,priceHigh:s.priceHigh,priceLow:s.priceLow};e.call(t,i,i,this)}}))}))}has(e){let t=!1;return this._graphics.hhistsByTimePointIndex().forEach((s=>{s.forEach((s=>{s.styleId===this._styleId&&s===e&&(t=!0)}))})),t}get size(){let e=0;return this._graphics.hhistsByTimePointIndex().forEach((t=>{t.forEach((t=>{t.styleId===this._styleId&&e++}))})),e}[Symbol.iterator](){const e=this._graphics.hhistsByTimePointIndex()[Symbol.iterator]();let t,s;return{[Symbol.iterator](){return this},next(){for(;;){if(void 0===t&&(s=void 0,t=e.next(),!t.done&&!t.value))return{done:!0,value:void 0};const i=t.value;s||(s=i[Symbol.iterator]());const r=s.next();if(!r.done)return{value:r.value};{const e=t;if(t=void 0,r.value)return{value:r.value,done:e.done}}}}}}entries(){throw new Error("Not implemented")}keys(){throw new Error("Not implemented")}values(){throw new Error("Not implemented")}}class g{constructor(e,t){this._graphicsInfo=e,this._graphics=t}forEach(e,t){if(void 0===this._graphicsInfo.hhists)return;const s=Object.keys(this._graphicsInfo.hhists);for(const r of s)e.call(t,(0,i.ensureDefined)(this.get(r)),r,this)}get(e){if(void 0!==this._graphicsInfo.hhists)return new S(this._graphics,e)}has(e){return void 0!==this._graphicsInfo.hhists&&e in this._graphicsInfo.hhists}get size(){return void 0===this._graphicsInfo.hhists?0:Object.keys(this._graphicsInfo.hhists).length}[Symbol.iterator](){
const e=Object.keys(this._graphicsInfo?.hhists??{})[Symbol.iterator]();return{[Symbol.iterator](){return this},next:()=>{const t=e.next();return t.done?{done:!0,value:t.value?[t.value,(0,i.ensureDefined)(this.get(t.value))]:void 0}:{value:[t.value,(0,i.ensureDefined)(this.get(t.value))],done:t.done}}}}entries(){throw new Error("Not implemented")}keys(){throw new Error("Not implemented")}values(){throw new Error("Not implemented")}}class v{constructor(e,t,s){this._graphicsInfo=e,this._roughStudyGraphics=t,this._detailedStudyGraphics=s}horizlines(){return new f(this._roughStudyGraphics.horizlines(),this._detailedStudyGraphics.map((e=>e.horizlines())))}vertlines(){return this._roughStudyGraphics.vertlines()}lines(){return this._roughStudyGraphics.lines()}hlines(){return this._roughStudyGraphics.hlines()}textmarks(){return this._roughStudyGraphics.textmarks()}shapemarks(){return this._roughStudyGraphics.shapemarks()}backgrounds(){return this._roughStudyGraphics.backgrounds()}polygons(){return this._roughStudyGraphics.polygons()}trendchannels(){return this._roughStudyGraphics.trendchannels()}hhists(){return new g(this._graphicsInfo,this)}hhistsByTimePointIndex(){return new m(this._roughStudyGraphics.hhistsByTimePointIndex(),this._detailedStudyGraphics.map((e=>e.hhistsByTimePointIndex())))}dwglabels(){return this._roughStudyGraphics.dwglabels()}dwglines(){return this._roughStudyGraphics.dwglines()}dwgpolylines(){return this._roughStudyGraphics.dwgpolylines()}dwgboxes(){return this._roughStudyGraphics.dwgboxes()}dwgtables(){return this._roughStudyGraphics.dwgtables()}dwgtablecells(){return this._roughStudyGraphics.dwgtablecells()}dwglinefills(){return this._roughStudyGraphics.dwglinefills()}tpos(){return this._roughStudyGraphics.tpos()}tpoBlockSets(){return this._roughStudyGraphics.tpoBlockSets()}tpoLevels(){return this._roughStudyGraphics.tpoLevels()}tpoVolumeRows(){return this._roughStudyGraphics.tpoVolumeRows()}tpoSummaryInfo(){return this._roughStudyGraphics.tpoSummaryInfo()}logs(){return this._roughStudyGraphics.logs()}performance(){return this._roughStudyGraphics.performance()}footprints(){return this._roughStudyGraphics.footprints()}footprintLevels(){return this._roughStudyGraphics.footprintLevels()}}var b=s(437642),w=s(87347);const C="tv-volumebyprice",x=(0,a.studyIdString)("VbPSessionsRough",C),D=(0,a.studyIdString)("VbPSessionsDetailed",C),P=(0,a.studyIdString)("VbPSessionsDetailedAlerts",C),I=Number.MAX_SAFE_INTEGER,T=o.t(null,void 0,s(419431));class A extends u.VolumeProfileWithPriceRangeStudy{constructor(e,t,s,i,o,n){super(e,t,s,i,o,n),this._isPackageAvailable=R(),this._alertsStudyMetaInfo=null,this._roughDataSource=null,this._detailedDataSource=null,this._detailedDataBuffer=new r.CircularBuffer(7),this._loadedGraphics=null,this._loadedPlots=null,this._mergedGraphics=(0,_.emptyStudyGraphics)(),this._mergedPlots=this._emptyPlotList(),this._isPackageAvailable||this._setStatus({type:h.StudyStatusType.Error,errorDescription:{error:T}}),this._setAlertsStudyMetaInfo()}destroy(){
null!==this._detailedDataSource&&(this._detailedDataSource.dataUpdated().unsubscribe(this,this._onRoughOrDetailedDataUpdated),this._detailedDataSource.dataCleared().unsubscribe(this,this._onRoughOrDetailedDataCleared),this._detailedDataSource.studyStatusChanged().unsubscribe(this,this._onStudyStatusChanged),this._detailedDataSource.destroy(),this._detailedDataSource=null),null!==this._roughDataSource&&(this._roughDataSource.dataUpdated().unsubscribe(this,this._onRoughOrDetailedDataUpdated),this._roughDataSource.dataCleared().unsubscribe(this,this._onRoughOrDetailedDataCleared),this._roughDataSource.studyStatusChanged().unsubscribe(this,this._onStudyStatusChanged),this._roughDataSource.destroy(),this._roughDataSource=null),super.destroy()}data(){return this._loadedPlots||this._mergedPlots}graphics(){return this._loadedGraphics||this._mergedGraphics}clearData(){null!==this._roughDataSource&&this._roughDataSource.clearData(),null!==this._detailedDataSource&&this._detailedDataSource.clearData()}restoreData(e){this._invalidateLastNonEmptyPlotRowCache(),this._loadedPlots=this._emptyPlotList(),this._loadedPlots.restoreState(e),void 0!==e.graphics&&(this._loadedGraphics=(0,_.loadStudyGraphics)(e.graphics)),this._postProcessGraphics(),this._setStatus({type:h.StudyStatusType.Completed},!0)}isFailed(){return!this._isPackageAvailable||null!==this._roughDataSource&&this._roughDataSource.studyStatus().type===h.StudyStatusType.Error||null!==this._detailedDataSource&&this._detailedDataSource.studyStatus().type===h.StudyStatusType.Error}isLoading(){return null!==this._roughDataSource&&this._roughDataSource.studyStatus().type===h.StudyStatusType.Loading||null!==this._detailedDataSource&&this._detailedDataSource.studyStatus().type===h.StudyStatusType.Loading}isStarted(){return null!==this._roughDataSource&&this._roughDataSource.isStarted()||null!==this._detailedDataSource&&this._detailedDataSource.isStarted()}sourceId(){throw new Error("Invalid operation")}idForAlert(){return super._collectDepsForAlert().idForAlert}canHaveChildren(){return!1}isChildStudy(){return!1}hasChildren(){return!1}getAllChildren(){return[]}isHibernated(){return!(this.isVisible()||null!==this._roughDataSource&&this._roughDataSource.isStarted()||null!==this._detailedDataSource&&this._detailedDataSource.isStarted())}_alertMetaInfo(){return this._alertsStudyMetaInfo}_stopStudyOnServer(){this._chartApi&&this._chartApi.isConnected().value()&&(this._roughDataSource?.isStarted()&&this._roughDataSource.stop(),this._detailedDataSource?.isStarted()&&this._detailedDataSource.stop())}async _startAfterSymbolsResolved(e,t){if(!this.isStarted()||this.isRestarting())if(this._restarting=!1,this._isPackageAvailable=R(),this._isPackageAvailable){if(this._allInputsAreValid()){if(this._inputs=this._apiInputs(),null===this._roughDataSource){const e=await(0,w.studyMetaInfoRepository)().findById({type:"java",studyId:x});this._roughDataSource=new c.ExtendedStudyDataSource(this.model().chartApi(),this.model().mainSeries(),"vbpsessionsrough_",e),
this._roughDataSource.studyStatusChanged().subscribe(this,this._onStudyStatusChanged),this._roughDataSource.dataCleared().subscribe(this,this._onRoughOrDetailedDataCleared),this._roughDataSource.dataUpdated().subscribe(this,this._onRoughOrDetailedDataUpdated)}else this._roughDataSource.stop();if(this._roughDataSource.setInputs(V(this._roughDataSource.metaInfo().inputs,this._inputs)),null===this._detailedDataSource){const e=await(0,w.studyMetaInfoRepository)().findById({type:"java",studyId:D});this._detailedDataSource=new c.ExtendedStudyDataSource(this.model().chartApi(),this.model().mainSeries(),"vbpsessionsdetailed_",e),this._detailedDataSource.studyStatusChanged().subscribe(this,this._onStudyStatusChanged),this._detailedDataSource.dataCleared().subscribe(this,this._onRoughOrDetailedDataCleared),this._detailedDataSource.dataUpdated().subscribe(this,this._onRoughOrDetailedDataUpdated)}else this._detailedDataSource.stop();this._detailedDataSource.setInputs(M(this._inputs)),this._roughDataSource.start(),this._detailedDataSource.start(),this._createStudyGraphics(),this._subscribeToSessionId(),this._setStatus(this._statusValueFromDataSources()),this._onStart.fire(),null===this._alertsStudyMetaInfo&&await this._setAlertsStudyMetaInfo()}}else this._setStatus({type:h.StudyStatusType.Error,errorDescription:{error:T}})}async _changeInputsImpl(e,t){if(null!==this._roughDataSource){if((0,l.areStudyInputsEqual)(this._roughDataSource.metaInfo().inputs,t,e)){if(null!==this._detailedDataSource){const t=M(e),s=(0,l.rangeDependentStudyInputsToTimeRange)(t);if(this._moreDetailedDataRequiredForTimeRange(s)){if(this._detailedDataSource.isActive()){const e=this._detailedDataSource.stopAndStealData();if(e.plots.size()>0||!(0,_.isStudyGraphicsEmpty)(e.graphics)){const t=(0,i.ensureNotNull)(this._detailedDataSource.inputs());e.plots=this._extractEffectiveDetailedPlotValues(e.plots,t),this._detailedDataBuffer.enqueue({lod:E(t),value:e})}}this._detailedDataSource.setInputs(t),this._detailedDataSource.start()}}}else this._inputs=e,this._roughDataSource.setInputs(V(this._roughDataSource.metaInfo().inputs,e)),this._detailedDataBuffer.clear(),null!==this._detailedDataSource&&this._detailedDataSource.setInputs(M(e));null!==this._detailedDataSource&&this._createStudyGraphics()}}_collectDepsForAlert(){const e=super._collectDepsForAlert();if(null===this._alertsStudyMetaInfo)throw new Error("Alerts study metainfo is not ready yet. Have you checked the alert availability using hasStateForAlert()?");return{...e,studyDependencies:e.studyDependencies.map((e=>{const t=e.study===k(this.metaInfo());return{id:e.id,inputs:t?(s=e.inputs,{...s,subscribeRealtime:!0}):e.inputs,study:t&&null!==this._alertsStudyMetaInfo?k(this._alertsStudyMetaInfo):e.study};var s}))}}_getAlertCreationAvailable(){return!1}_statusValueFromDataSources(){const e={type:h.StudyStatusType.Undefined};if(null===this._roughDataSource||null===this._detailedDataSource)return e;const t=this._roughDataSource.studyStatus(),s=this._detailedDataSource.studyStatus()
;if(t.type===h.StudyStatusType.Error)return t;if(s.type===h.StudyStatusType.Error)return s;if(t.type===h.StudyStatusType.Loading||s.type===h.StudyStatusType.Loading){const e=t.type===h.StudyStatusType.Loading?t.startTime:1/0,i=s.type===h.StudyStatusType.Loading?s.startTime:1/0;return{type:h.StudyStatusType.Loading,startTime:Math.min(e,i)}}return t.type===h.StudyStatusType.Completed?{type:h.StudyStatusType.Completed}:e}_emptyPlotList(){return new n.PlotList((0,d.studyPlotFunctionMap)(this.metaInfo()),d.studyEmptyPlotValuePredicate)}_createStudyPlots(){const e=(0,i.ensureNotNull)(this._roughDataSource),t=(0,i.ensureNotNull)(this._detailedDataSource);this._mergedPlots.clear();const s=[];s.push({lod:I,value:e.plots()}),this._detailedDataBuffer.forEach((e=>{s.push({lod:e.lod,value:e.value.plots})}));const r=(0,i.ensureNotNull)(t.inputs());s.push({lod:E(r),value:this._extractEffectiveDetailedPlotValues(t.plots(),r)}),s.sort(((e,t)=>t.lod-e.lod));for(const e of s)e.value.each(((e,t)=>{for(const e of t)if(void 0===e)return!1;return this._mergedPlots.add(e,t),!1}));this._invalidateLastNonEmptyPlotRowCache()}_createStudyGraphics(){const e=(0,i.ensureNotNull)(this._roughDataSource),t=(0,i.ensureNotNull)(this._detailedDataSource),s=[];this._detailedDataBuffer.forEach((e=>{s.push({lod:e.lod,value:e.value.graphics})})),void 0!==this._inputs&&s.push({lod:E(this._inputs),value:t.graphics()}),s.sort(((e,t)=>e.lod-t.lod));const r=s.map((e=>e.value));this._mergedGraphics=new v(this.metaInfo().graphics,e.graphics(),r),this._postProcessGraphics()}_extractEffectiveDetailedPlotValues(e,t){const s=(0,l.rangeDependentStudyInputsToTimeRange)(t),r=this.model().timeScale().timePointToIndex(s.from),o=this.model().timeScale().timePointToIndex(s.to);return e.size()>0?e.range(r||(0,i.ensureNotNull)(e.firstIndex()),o||(0,i.ensureNotNull)(e.lastIndex())):this._emptyPlotList()}_moreDetailedDataRequiredForTimeRange(e){const{from:t,to:s}=e;let r=!1;return(0,i.ensureNotNull)(this._roughDataSource).graphics().hhistsByTimePointIndex().forEach(((e,i)=>{if(r)return;if(null===i)return;const o=this.model().timeScale().indexToTimePoint(i);if(null===o||o<t||s<o)return;const n=s-t;let a=!1;this._detailedDataBuffer.forEach((e=>{if(e.lod<=n){e.value.graphics.hhistsByTimePointIndex().has(i)&&(a=!0)}})),a||(r=!0)})),r}_onStudyStatusChanged(){const e=this.status();this._setStatus(this._statusValueFromDataSources()),e.type!==this.status().type&&this._updateAlertCreationAvailable(),(0,i.ensureDefined)(this._statusView).update((0,b.sourceChangeEvent)(this.id()))}_onRoughOrDetailedDataCleared(){null!==this._roughDataSource&&null!==this._detailedDataSource&&(this._invalidateLastNonEmptyPlotRowCache(),this._detailedDataBuffer.clear(),this._createStudyPlots(),this._createStudyGraphics(),this.updateAllViews((0,b.sourceChangeEvent)({sourceId:this.id(),clearData:!0})),this.model().updateSource(this))}_onRoughOrDetailedDataUpdated(e){null!==this._roughDataSource&&null!==this._detailedDataSource&&(e.length>0&&this._createStudyPlots(),this.updateAllViews((0,
b.sourceChangeEvent)(this.id())),this.model().updateSource(this))}async _setAlertsStudyMetaInfo(){this._alertsStudyMetaInfo=await(0,w.studyMetaInfoRepository)().findById({type:"java",studyId:P}),this._updateAlertCreationAvailable()}}function R(){return void 0!==window.pro&&window.pro.hasPackage(C)}function V(e,t){const s={};for(const i of e)s[i.id]=t[i.id];return s}function M(e){const t=e.last_visible_bar_time-e.first_visible_bar_time;return{...e,first_visible_bar_time:e.first_visible_bar_time-t,last_visible_bar_time:e.last_visible_bar_time+t}}function E(e){const{from:t,to:s}=(0,l.rangeDependentStudyInputsToTimeRange)(e);return s-t}function k(e){return`${e.id}-${e.version}`}},238308:(e,t,s)=>{"use strict";s.r(t),s.d(t,{SessionVolumeStudy:()=>u,createSessionVolumeStudy:()=>h});var i=s(650151),r=s(870855),o=s(37241),n=s(87347),a=s(340993),l=s(833214);class u extends l.VolumeProfileWithPriceRangeStudy{constructor(e,t,s,i,r,o,n=!1){super(e,t,s,i,r,o),this._chartStyleMode=n}paneViews(e){return this._chartStyleMode?this._paneViews:super.paneViews(e)}priceScale(){return this._chartStyleMode?this._model.mainSeries().priceScale():super.priceScale()}hasStateForAlert(){return!this._chartStyleMode&&super.hasStateForAlert()}}async function h(e){const t=(0,i.ensureDefined)(r.SYMBOL_STRING_DATA[20]),s=await(0,n.studyMetaInfoRepository)().findById({type:"java",studyId:t.type}),l=(0,o.prepareStudyProperties)(s,{},null,(0,n.studyMetaInfoRepository)().studyVersioning(),[]);return(0,a.addStudyInfoToMap)("study_VbPSessions",{studyConstructor:u,colorRotationMode:"shift"}),new u(e,l,[],s,s,!1,!0)}},833214:(e,t,s)=>{"use strict";s.r(t),s.d(t,{VbPVisibleWrapper:()=>y,VolumeProfileBaseStudy:()=>d,VolumeProfileStudyWithThemedColors:()=>_,VolumeProfileWithPriceRangeStudy:()=>p});var i=s(650151),r=s(820028),o=s(397535);var n=s(597331),a=s(534328);class l extends n.PriceAxisView{constructor(e,t){super(),this._source=e,this._styleId=t}_updateRendererData(e,t,s){e.visible=!1;const i=this._source.priceScale(),r=this._source.properties().childs();if(!i||i.isEmpty()||!r.visible.value())return;const o=this._source.properties().childs().graphics.childs().horizlines?.childs()[this._styleId].childs();if(!(o&&o.visible&&o.visible.value()&&this._isLabelVisibleAccordinglyToProperties()))return;const n=this._source.model().timeScale().logicalRange(),l=this._source.firstValue();if(null===l||null===n)return;const u={price:NaN,time:-1/0},h=this._source.graphics().horizlines().get(this._styleId);if(void 0===h)return;for(const e of h){if(void 0===e.level)continue;const t=n.contains(e.startIndex,!0);t===n.contains(e.endIndex,!0)&&0!==t||u.time<e.endIndex&&(u.time=e.endIndex,u.price=e.level)}if(isNaN(u.price))return;const c=(0,a.resetTransparency)(o.color.value());s.background=c,s.textColor=this.generateTextColor(c),s.coordinate=i.priceToCoordinate(u.price,l),e.text=i.formatPrice(u.price,l,{signPositive:i.isPercentage()}),e.visible=!0}_isLabelVisibleAccordinglyToProperties(){const e=this._source.model().properties().childs().scalesProperties.childs()
;return(e.showStudyLastValue.value()||e.showFundamentalLastValue.value())&&this._source.properties().childs().showLabelsOnPriceScale.value()}}var u=s(631114),h=s(12384),c=s(78358);class d extends u.Study{preferredZOrder(){return 0}async _createGraphicsPaneViews(){const e=this.metaInfo().graphics,t=this.model(),i={regularPaneViews:[],forceOverlayPaneViews:[]},r=this._needExtendToBarsEnding();if(e.hhists){const{HHistPaneView:e}=await Promise.all([s.e(63317),s.e(27860),s.e(3205),s.e(88003),s.e(20507)]).then(s.bind(s,910529)),o=this.properties().childs().graphics.childs().polygons?.childs();i.regularPaneViews.push(new e(this,t,void 0,o?.histBoxBg,r))}if(e.horizlines){const{HorizLinePaneView:e}=await Promise.all([s.e(63317),s.e(27860),s.e(3205),s.e(88003),s.e(20507)]).then(s.bind(s,614478));i.regularPaneViews.push(new e(this,t,void 0,r))}return i}_createGraphicsPriceAxisViews(){return Object.keys(this.metaInfo().graphics.horizlines??{}).map((e=>new l(this,e)))}_createStudyPlotPaneView(e){return new h.StudyPlotPaneView(this,this._series,this._model,e,this._needExtendToBarsEnding())}_apiInputs(){return{...super._apiInputs(),mapRightBoundaryToBarStartTime:!!this._needExtendToBarsEnding()||void 0}}_needExtendToBarsEnding(){return void 0!==this.metaInfo().defaults.inputs?.mapRightBoundaryToBarStartTime}}class _ extends d{constructor(e,t,s,i,r,o){t.setThemedColors((0,c.volumeProfileThemedColors)(t.childs().graphics.childs().polygons?.hasChild("histBoxBg"))),super(e,t,s,i,r,o)}}class p extends _{priceRange(e,t,s){if(s.targetPriceScale!==this.priceScale())return null;let r=!1;this.graphics().hhists().forEach(((e,t)=>{r=r||(0,i.ensureDefined)(this.properties().childs().graphics.childs().hhists?.childs()[t]).value()}));const n=function(e,t,s,i){let r=null;return e.forEach((e=>{e.forEach((e=>{const i=e.firstBarTime;null!==i&&i<=s&&e.lastBarTime>=t&&(null===r?r={low:{l:e.priceLow,h:e.priceHigh},high:{h:e.priceHigh}}:(e.priceLow<r.low.l&&(r.low.l=e.priceLow,r.low.h=e.priceHigh),r.high.h=Math.max(r.high.h,e.priceHigh)))}))})),null===r?null:i?new o.PriceRange(r.low.l-.8*(r.low.h-r.low.l),r.high.h):new o.PriceRange(r.low.l,r.high.h)}(this.graphics().hhists(),e,t,r);if(null===n)return null;const a=(0,i.ensureNotNull)(this.priceScale());return a.isLog()?new o.PriceRange(a.priceToLogical(n.minValue()),a.priceToLogical(n.maxValue())):n}}class y extends p{alertCreationAvailable(){return new r.WatchedValue(!1).readonly()}_needExtendToBarsEnding(){return!1}}},78358:(e,t,s)=>{"use strict";s.d(t,{volumeProfileThemedColors:()=>_});var i=s(553407);const{colorColdGray200:r,colorColdGray900:o,colorBerryPink400Alpha50:n,colorBerryPink400Alpha75:a,colorSkyBlue400Alpha50:l,colorSkyBlue400Alpha5:u,colorSkyBlue400Alpha75:h,colorSkyBlue500:c}=i.colors,d={val:[o,r],poc:[o,r],vah:[o,r],developingPoc:[o,r],developingVA:[c,c],valuesColor:[o,r],volumeColorUp:[l,l],volumeColorDown:[n,n],valueAreaColorUp:[h,h],valueAreaColorDown:[a,a],histogramBoxColor:[u,u]};function _(e){const t="graphics.horizlines",s="graphics.hhists",i=[{path:`${t}.pocLines.color`,
colors:d.poc},{path:`${t}.vahLines.color`,colors:d.vah},{path:`${t}.valLines.color`,colors:d.val},{path:`${s}.histBars2.colors.0`,colors:d.volumeColorUp},{path:`${s}.histBars2.colors.1`,colors:d.volumeColorDown},{path:`${s}.histBars2.valuesColor`,colors:d.valuesColor},{path:`${s}.histBarsVA.colors.0`,colors:d.valueAreaColorUp},{path:`${s}.histBarsVA.colors.1`,colors:d.valueAreaColorDown},{path:`${s}.histBarsVA.valuesColor`,colors:d.valuesColor},{path:"styles.developingPoc.color",colors:d.developingPoc},{path:"styles.developingVAHigh.color",colors:d.developingVA},{path:"styles.developingVALow.color",colors:d.developingVA}];return e&&i.push({path:"graphics.polygons.histBoxBg.color",colors:d.histogramBoxColor}),i}},42212:(e,t,s)=>{"use strict";s.r(t),s.d(t,{VolumeStudy:()=>o});var i=s(631114),r=s(412338);class o extends i.Study{base(){return 1}destroy(){super.destroy()}showOnTopOnHovering(){return!1}chartFloatingTooltipView(){return this._model.paneForSource(this)===this._model.mainPane()?null:super.chartFloatingTooltipView()}_titleInParts(e,t,s,i,r,o){const n=super._titleInParts(e,t,s,i,r),a=this._getVolumeUnit();return a&&!o&&(n[0]+=` Â· ${a}`),n}_skippedTitleInputs(){const e=super._skippedTitleInputs();0===this._getPlotDisplayValue("vol_ma")&&!e.includes("length")&&e.push("length");return e}_getVolumeUnit(){const e=this.symbolSource().symbolInfo();return e?(0,r.getVolumeUnit)({...e,currency:e.original_currency_code||e.currency_code}):void 0}}},338741:(e,t,s)=>{"use strict";s.r(t),s.d(t,{study_Overlay:()=>Me});var i=s(650151),r=s(517241),o=s(638456),n=s(735566),a=s(631114),l=s(766409),u=s(756163),h=s(326488),c=s(388741),d=s(905520),_=s(955722),p=s(931924),y=s(14767),f=s(616427),m=s(641208),S=s(132565),g=s(584785),v=s(536794),b=s(397535),w=s(820028),C=s(191914),x=s(197860),D=s(973592),P=s(597331),I=s(980057),T=s(316250),A=s(534328);const R=p.enabled("force_exchange_as_title");class V extends P.PriceAxisView{constructor(e){super(),this._source=e}_updateRendererData(e,t,s){e.visible=!1,t.visible=!1;const r=this._source.lastValueData("close",!1);if(r.noData)return;const o=this._source.model(),n=this._source.priceScale();if(null===n)return;if(!o.isPriceScaleVisible(n))return;const a=o.timeScale().visibleBarsStrictRange(),l=o.mainSeries().bars().lastIndex();if(null===a||null===l)return;if(l<=a.lastBar())s.background=(0,A.resetTransparency)(r.color),s.textColor=this.generateTextColor(r.color),e.borderVisible=!1,t.borderVisible=!1;else{const n=o.backgroundColorAtYPercentFromTop(r.coordinate/(0,i.ensureNotNull)(o.paneForSource(this._source)).height());s.background=n,s.textColor=(0,A.resetTransparency)(r.color),s.borderColor=s.textColor,e.borderVisible=!0,t.borderVisible=!0}s.coordinate=r.coordinate,s.floatCoordinate=r.floatCoordinate;const u=this._source.model().properties().childs().scalesProperties.childs();u.showSeriesLastValue.value()&&(e.text=(0,T.getCurrentModePriceText)(n,r),u.seriesLastValueMode.value()!==I.PriceAxisLastValueMode.LastPriceAndPercentageValue?e.secondLine="":e.secondLine=(0,
T.getOppositeModePriceText)(n,r),e.visible=!0),t.text="",u.showSymbolLabels.value()&&(t.text=this._paneText(),t.visible=t.text.length>0)}_paneText(){let e="";const t=this._source.symbolInfo();return R?e=(0,c.displayedSymbolExchange)(t):this._source.model().properties().childs().scalesProperties.childs().showSymbolLabels.value()&&(e=(0,c.displayedSymbolName)(t)),e}}var M=s(514294);class E extends M.PriceLineAxisView{constructor(e){super(),this._study=e}_value(){return this._study.lastValueData("",!0)}_priceLineColor(e){return e}_lineWidth(){return 1}_isVisible(){const e=this._study.model().properties().childs().scalesProperties.childs().showSeriesLastValue.value();return this._study.properties().childs().showPriceLine.value()&&e}}var k=s(257145),L=s(654397);class N{constructor(e){this._lineRenderer=new L.HorizontalLineRenderer,this._visible=!1,this._source=e}update(){if(this._visible=!1,!this._source.properties().childs().showPriceLine.value())return;const e=this._source.lastValueData("",!0);e.noData||(this._visible=!0,this._lineRenderer.setData({y:e.coordinate,color:e.color,linewidth:1,linestyle:k.LINESTYLE_DOTTED,visible:this._visible}))}renderer(){return this._visible?this._lineRenderer:null}}var B=s(529751),O=s(87913),F=s(816433),U=s(150335),H=s(444372),Y=s(969680),z=s(951827),W=s(176749),q=s(830101),$=s(889858),G=s(909954),j=s(634969);const J=q.lastDayChangeAvailable||q.alwaysShowLastPriceAndLastDayChange,Q=o.CheckMobile.any(),Z=(0,z.getPercentageFormatter)(),K=j.notAvailable,X=`${K} (${K}%)`;class ee{constructor(e,t){this._study=e,this._model=t,this._emptyValues=[{title:H.t(null,void 0,s(16610)),visible:!1,value:"",index:0,id:""},{title:H.t(null,void 0,s(778254)),visible:!1,value:"",index:1,id:""},{title:H.t(null,void 0,s(165318)),visible:!1,value:"",index:2,id:""},{title:H.t(null,{context:"input"},s(51408)),visible:!1,value:"",index:3,id:""},{title:"",visible:!1,value:"",index:4,id:""},{title:"",visible:!1,value:"",index:5,id:""},{title:H.t(null,void 0,s(537276)),visible:!1,value:"",index:6,id:""},{title:H.t(null,void 0,s(463815)),visible:!1,value:"",index:7,id:""}]}getItems(){return this._emptyValues}getValues(e){const t=this._emptyValues.map((e=>({...e})));if(this._model.timeScale().isEmpty())return t;const s=this._study.data(),i=s.lastIndex();if(0===s.size()||null===i)return t;const r=s.search(i,g.PlotRowSearchMode.NearestLeft,1);if(null===r)return t;const o=this._showLastPriceAndChangeOnly();if((0,U.isNumber)(e)||(o?e=i:(e=this._model.crosshairSource().appliedIndex(),(0,U.isNumber)(e)||(e=i))),null===e||!(0,U.isNumber)(e))return t;const n=s.search(e,g.PlotRowSearchMode.NearestLeft,1),a=this._model.backgroundTopColor().value();if(null===n)return t;const l=n.index,u=n.value,h=u[1],c=u[2],d=u[3],_=u[4];t[0].value=K,t[1].value=K,t[2].value=K,t[3].value=K,t[7].value=X,t[6].value=X;for(const e of t)e.visible=!o;const p=t[4];p.visible=!1;const{barChange:y,lastDayChange:f}=(0,W.changesData)(s,this._study.quotes(),n.value,n.index,r.value),m=(0,G.getPriceValueFormatterForSource)(this._study);if((0,
G.shouldBeFormattedAsPercent)(this._study)||(0,G.shouldBeFormattedAsIndexedTo100)(this._study))t[7].value="",t[6].value="";else{const e=this._study.formatter(),s={signPositive:!0};if(void 0!==y){const{currentPrice:i,prevPrice:r,change:o}=y,n=e.formatChange?.(i,r,s)??e.format(o,s);t[6].value=(0,Y.forceLTRStr)(`${n} (${Z.format(y.percentChange,s)})`)}if(void 0!==f){const{currentPrice:i,prevPrice:r,change:o,percentChange:n}=f,a=e.formatChange?.(i,r,s)??e.format(o,s);t[7].value=(0,Y.forceLTRStr)(`${a} (${Z.format(n,s)})`)}}let S=null;if(o)t[5].value=null==_?K:m(_),t[5].visible=!0,S=this._getChangeColor(f?.change),t[6].visible=void 0!==y,t[7].visible=void 0!==f||J;else{t[0].value=null==h?K:m(h),t[1].value=null==c?K:m(c),t[2].value=null==d?K:m(d),t[3].value=null==_?K:m(_),p.value=m(this._study.barFunction()(u)),t[5].visible=!1;const e=this._model.mainSeries().intervalObj().value().is1Tick(),s=21!==this._study.properties().childs().style.value();t[0].visible=!e&&s,t[1].visible=!e,t[2].visible=!e,t[7].visible=void 0!==f||J,t[6].visible=void 0!==y;const i=this._study.barColorer().barStyle(l,!1),r=i.barBorderColor??i.barColor;S=(0,W.calculateColor)(a,r)}S=(0,A.resetTransparency)((0,W.calculateColor)(a,S));for(const e of t)e.color||(e.color=S);return t[7].visible&&(t[7].color=(0,A.resetTransparency)((0,W.calculateColor)(a,this._getChangeColor(f?.change)))),t}_mobileNonTrackingMode(){return Q&&(null===this._model.crosshairSource().pane||(0,B.isLineToolName)(O.tool.value())||null!==this._model.lineBeingEdited())}_showLastPriceAndChangeOnly(){return q.alwaysShowLastPriceAndLastDayChange||this._mobileNonTrackingMode()}_getChangeColor(e){const t=void 0===e||e>=0?$.SeriesBarColorer.upColor(this._study.properties()):$.SeriesBarColorer.downColor(this._study.properties());return t.barBorderColor??t.barColor}}var te=s(844859);const se=o.CheckMobile.any();class ie extends te.StudyDataWindowView{_updateImpl(){this._header=this._study.title(F.TitleDisplayTarget.DataWindow);let e;this._showLastPriceAndChangeOnly()?e=this._study.data().lastIndex():(e=this._model.crosshairSource().appliedIndex(),(null===e||isNaN(e))&&(e=this._study.data().lastIndex(),p.enabled("use_last_visible_bar_value_in_legend")&&(e=this._model.timeScale().visibleBarsStrictRange()?.lastBar()??NaN)));const t=this._valueProvider.getValues(e);for(let e=0;e<t.length;++e){const s=t[e],i=this._items[e];i.setValue(s.value),i.setVisible(s.visible),i.setColor(s.color)}}_showLastPriceAndChangeOnly(){return se&&(null===this._model.crosshairSource().pane||(0,B.isLineToolName)(O.tool.value())||null!==this._model.lineBeingEdited())}_createValuesProvider(e,t){return new ee(e,t)}}var re=s(437642);class oe extends ee{constructor(e,t){super(e,t);const s=t.properties().childs().paneProperties.childs().legendProperties.childs();this._showBarChangeProp=s.showBarChange,this._showLastDayChangeProp=s.showLastDayChange,this._showSeriesOHLCProp=s.showSeriesOHLC}getValues(e){
const t=super.getValues(e),s=this._study.properties().childs(),i=s.style.value(),r=12!==i,o=this._showSeriesOHLC(),n=r&&this._showBarChangeProp.value(),a=r&&this._showLastDayChangeProp.value();if(this._showLastPriceAndChangeOnly())return t[7].visible&&=n,t[6].visible=!1,t;const l=(0,c.isPriceSourceStyle)(i),u=12!==i&&16!==i&&21!==i,h=12!==i,d=this._model.mainSeries().intervalObj().value().is1Tick(),_=o&&!l,p=o&&l;if(t[0].visible=_&&u&&!d,t[1].visible=_&&!d,t[2].visible=_&&!d,t[3].visible=_&&h,t[7].visible&&=a,t[6].visible&&=n,t[4].visible=p,16===i){const e=s.hlcAreaStyle.childs();t[1].color=e.highLineColor.value(),t[2].color=e.lowLineColor.value(),t[3].color=e.closeLineColor.value()}return t}_showSeriesOHLC(){return this._showSeriesOHLCProp.value()}}var ne=s(288789),ae=s(326301);class le extends ie{constructor(e,t){super(e,t),this._additional=null,this._studyOverlay=e,this._backgroundColorSpawn=t.backgroundTopColor().spawn(),this._backgroundColorSpawn.subscribe(this.update.bind(this,(0,re.sourceChangeEvent)(e.id())));const s=t.properties().childs().paneProperties.childs().legendProperties.childs();this._visibilityProperty=(0,ne.combineProperty)(((e,t)=>e||t),s.showBarChange.weakReference(),s.showSeriesOHLC.weakReference()),this._visibilityProperty.subscribe(this,this.update.bind(this,(0,re.sourceChangeEvent)(e.id())))}areValuesVisible(){return this._visibilityProperty.value()}additional(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._additional}destroy(){this._backgroundColorSpawn.destroy(),this._visibilityProperty.destroy()}_updateImpl(){super._updateImpl();{const e=(0,ae.getDataVendorString)(this._studyOverlay.symbolInfo());this._additional=e?H.t(null,void 0,s(957131))+" "+e:null}}_createValuesProvider(e,t){return new oe(e,t)}}var ue=s(542301),he=s(5253),ce=s(616332),de=s(316661),_e=s(271747),pe=s(517742),ye=s(340104),fe=s(498969),me=s(351018),Se=s(735922),ge=s(296538),ve=s(681240);class be extends ve.StudyStatusProvider{getSplitTitle(){return this._source.titleInParts(F.TitleDisplayTarget.StatusLine,!0,void 0,!1,!1)}text(){return this._source.isActualInterval()?this._source.isFailed()?`${this._source.title(F.TitleDisplayTarget.StatusLine,!0,void 0,!1,!1)}: ${this.sourceStatusText()}`:`${this._source.title(F.TitleDisplayTarget.StatusLine,!0,void 0,!1,!1)} ${this.sourceStatusText()}`:this._source.title(F.TitleDisplayTarget.StatusLine,!0,void 0,!1,!1)}}var we=s(20019),Ce=s(490550);class xe extends oe{_showSeriesOHLC(){return!0}}var De=s(669110);p.enabled("legend_last_day_change");const Pe=(o.CheckMobile.any(),!0),Ie=p.enabled("study_overlay_compare_legend_option"),Te=(p.enabled("secondary_series_extend_time_scale"),p.enabled("hide_unresolved_symbols_in_legend")),Ae=!p.enabled("hide_study_overlay_legend_item"),Re=(0,n.getLogger)("Chart.StudyOverlay");function Ve(e,t){return null==e[t]}class Me extends a.Study{constructor(e,t,s,i,r,o){super(e,function(e){e.hasChild("currencyId")||e.addChild("currencyId",new d.Property(null)),e.hasChild("unitId")||e.addChild("unitId",new d.Property(null)),(0,
ge.allChartStyles)().includes(e.childs().style.value())||e.childs().style.setValueSilently(2);const t=e.childs();if(t.lineStyle.hasChild("styleType")){const e=t.lineStyle.childs(),s=e.styleType.value();let i,r;0===s&&(r=14,i=t.lineWithMarkersStyle.childs()),1===s&&(r=15,i=t.steplineStyle.childs()),i&&(i.color.setValueSilently(e.color.value()),i.linestyle.setValueSilently(e.linestyle.value()),i.linewidth.setValueSilently(e.linewidth.value()),i.priceSource.setValueSilently(e.priceSource.value())),void 0!==r&&2===t.style.value()&&t.style.setValueSilently(r),t.lineStyle.removeProperty("styleType")}return e.addExcludedKey("currencyId",1),e.addExcludedKey("unitId",1),e}(t),s,i,r,o),this._symbolResolvingActive=new w.WatchedValue(!1),this._symbolHibernated=new w.WatchedValue(!1),this._styleToRecover=null,this._isActingAsSymbolSource=new w.WatchedValue(!0),this._realignToolsLastParams=null,this._precomputedBarStyles=new WeakMap,this._lastResolvedSymbolSource="",this._data=new S.PlotList((0,h.seriesPlotFunctionMap)(),Ve),this._quotesProvider=new y.QuotesProvider(void 0,e.collapsed().spawnOwnership()),Pe&&this._quotesProvider.quotesUpdate().subscribe(this,this._onQuotesUpdate);const n=this.properties().childs();n.currencyId.subscribe(this,this._onCurrencyChanged),n.unitId.subscribe(this,this._onUnitChanged),n.allowExtendTimeScale.subscribe(this,this._onAllowExtendTimeScaleChanged),this._onAllowExtendTimeScaleChanged(),this._model.mainSeries().properties().childs().dividendsAdjustment.subscribe(this,(()=>{this._tryChangeInputs()})),n.style.subscribe(this,this._onChartStyleChanged),n.lineStyle.childs().priceSource.subscribe(this,this._updateBarFunction),n.lineWithMarkersStyle.childs().priceSource.subscribe(this,this._updateBarFunction),n.steplineStyle.childs().priceSource.subscribe(this,this._updateBarFunction),n.areaStyle.childs().priceSource.subscribe(this,this._updateBarFunction),n.baselineStyle.childs().priceSource.subscribe(this,this._updateBarFunction),n.columnStyle.childs().priceSource.subscribe(this,this._updateBarFunction),this._updateBarFunction(),n.minTick.subscribe(this,this._onMinTickChanged),this._formatter=null,this._defaultFormatter=null,e.mainSeries().onIntervalChanged().subscribe(this,(()=>e.realignLineTools(this))),e.mainSeries().onIntervalChanged().subscribe(this,(()=>this._checkStyle())),this._conflatedChunksBuilder=new we.ConflatedChunksBuilder(this._data,(e=>h.barFunctions[e])),this._overlayValuesProvider=new ee(this,e),this._overlayLegendValuesProvider=new oe(this,e),this._overlayChartFloatingTooltipValuesProvider=new xe(this,e)}destroy(){this._model.mainSeries().properties().childs().dividendsAdjustment.unsubscribeAll(this),this._model.mainSeries().onIntervalChanged().unsubscribeAll(this),this._quotesProvider.destroy(),super.destroy()}isActingAsSymbolSource(){return this._isActingAsSymbolSource.readonly()}precomputedBarStyle(e){return this._precomputedBarStyles.get(e)}setPrecomputedBarStyle(e,t){this._precomputedBarStyles.set(e,t)}properties(){return this._properties}barColorer(){
return new $.SeriesBarColorer({data:()=>this.data(),bars:()=>this.data(),nsBars:()=>new S.PlotList,priceScale:()=>(0,i.ensureNotNull)(this.priceScale()),properties:()=>this.properties(),firstValue:()=>this.firstValue(),barFunction:()=>this.barFunction(),lineColorAtYPercentFromTop:e=>this.lineColorAtYPercentFromTop(e)})}symbolParams(){return(0,f.symbolParams)(this)}compareSymbolParams(e){return(0,f.compareSymbolParams)(this,e,this._model.unitConversionEnabled())}async setSymbolParams(e){this._setSymbolParamsInternal(e)}symbol(){return this.properties().childs().inputs.childs().symbol.value()}symbolChanged(){return this.properties().childs().inputs.childs().symbol}onSymbolIntervalChanged(){return this.symbolChanged()}setSymbol(e){this.setSymbolParams({symbol:e})}symbolInfo(){if(!this._resolvedSymbols)return null;const e=this._properties.childs().inputs.childs().symbol.value();if(!e)return null;let t;return t=this._model.isSnapshot()?this._resolvedSymbols.___snapshot||null:this._resolvedSymbols[this._getSymbolForResolve(e)]||null,this._model.isSnapshot()&&null===t&&(t=(0,r.getObsoleteIdeaSymbolInfo)(this._resolvedSymbols,e,this.currency()),null!==t&&(this._resolvedSymbols.___snapshot=t)),t}supportsConflatedChunks(){return!0}conflatedChunks(e,t){return this._conflatedChunksBuilder.conflatedChunks(e,t)}symbolResolved(){return this.symbolsResolved()}symbolResolvingActive(){return this._symbolResolvingActive}symbolHibernated(){return this._symbolHibernated}isVisible(){const e=super.isVisible();return this._symbolHibernated.setValue(!e),e}symbolSameAsCurrent(e){return(0,f.symbolSameAsCurrent)(e,this.symbolInfo())}symbolSameAsResolved(e){return(0,m.symbolSameAsResolved)(e,this._lastResolvedSymbolSource,this.symbol())}priceSource(){const e=this.properties().childs();switch(e.style.value()){case 2:return e.lineStyle.childs().priceSource.value();case 14:return e.lineWithMarkersStyle.childs().priceSource.value();case 15:return e.steplineStyle.childs().priceSource.value();case 3:return e.areaStyle.childs().priceSource.value();case 10:return e.baselineStyle.childs().priceSource.value();case 13:return e.columnStyle.childs().priceSource.value()}return null}barFunction(){return this._barFunction}quotesProvider(){return this._quotesProvider}quotes(){return this._quotesProvider.quotes()}currency(){return this.properties().childs().currencyId.value()||null}setCurrency(e){this.setSymbolParams({currency:e})}isConvertedToOtherCurrency(){return(0,c.isConvertedToOtherCurrency)(this.symbolInfo())}unit(){return this.properties().childs().unitId.value()||null}setUnit(e){this.setSymbolParams({unit:e})}isConvertedToOtherUnit(){return(0,c.isConvertedToOtherUnit)(this.symbolInfo(),this._model.unitConversionEnabled())}style(){return this.properties().childs().style.value()}setStyle(e){this.setSymbolParams({style:e})}interval(){return this._model.mainSeries().interval()}setInterval(e){}valueAt(e,t){return this.data().search(e)?.value[t]??null}symbolSource(){return this}barsProvider(){return this}state(e,t){const s=super.state(e,t)
;this._model.unitConversionEnabled()||delete s.state.unitId;const r=this.symbol();return s.state.inputs.symbol=(0,c.symbolToSaveInState)(this.symbolInfo()??this._model.chartApi().lastSymbolResolveInfo(r),r),e&&((0,i.ensureDefined)(s.data).symbols={___snapshot:this.symbolInfo()||void 0}),s}symbolTitle(e,t,s){return this.title(e,!0,{},!1,t)}title(e,t,s,i,r){const o=this._titleInParts(e,t,s,i,r);return[o[0],...o[1]??[]].join(` ${c.symbolTitleSeparator} `)}titleInParts(e,t,s,i,r){return[this.title(e,t,s,i,r)]}firstValue(){const e=this._model.timeScale().visibleBarsStrictRange();if(null===e)return null;const t=e.firstBar();if(0===this.data().size())return this._ownFirstValue;const s=this.data().search(t,g.PlotRowSearchMode.NearestRight,1);return this._ownFirstValue=null!==s?this._barFunction(s.value,0):null,this._ownFirstValue}lineColorAtYPercentFromTop(e){switch(this.style()){case 2:return this.properties().childs().lineStyle.childs().color.value();case 14:return this.properties().childs().lineWithMarkersStyle.childs().color.value();case 15:return this.properties().childs().steplineStyle.childs().color.value()}return null}lastValueData(e,t,s){const i={noData:!0},r=this.priceScale();if(this._model.timeScale().isEmpty()||null===r||r.isEmpty()||this.data().isEmpty())return i;const o=this._model.timeScale().visibleBarsStrictRange();if(null===o)return i;const n=this.properties().childs();if(!n.visible.value())return i;const a=this.nearestIndex(o.lastBar(),g.PlotRowSearchMode.NearestLeft,1);if(void 0===a)return i;const l=this.firstValue();if(null===l)return i;const u=this._lastNonEmptyPlotRow(4),h=null!==u&&o.contains(u.index),c=null!==u?u.value:null,d=t||h?c:this.data().valueAt(a);if(null===d)return i;const _=this._barFunction(d,2);if(!(0,v.isNumber)(_))return i;const p=r.priceToCoordinate(_,l);let y;switch(n.style.value()){case 0:y=d[1]<=d[4]?n.barStyle.childs().upColor.value():n.barStyle.childs().downColor.value();break;case 1:y=d[1]<=d[4]?n.candleStyle.childs().upColor.value():n.candleStyle.childs().downColor.value();break;case 9:y=d[1]<=d[4]?n.hollowCandleStyle.childs().upColor.value():n.hollowCandleStyle.childs().downColor.value();break;case 13:y=d[1]<=d[4]?n.columnStyle.childs().upColor.value():n.columnStyle.childs().downColor.value();break;case 2:y=n.lineStyle.childs().color.value();break;case 14:y=n.lineWithMarkersStyle.childs().color.value();break;case 15:y=n.steplineStyle.childs().color.value();break;case 3:y=n.areaStyle.childs().linecolor.value();break;case 16:y=n.hlcAreaStyle.childs().closeLineColor.value();break;case 10:{const e=n.baselineStyle.childs();y=p<Math.round(r.height()*(Math.abs(100-e.baseLevelPercentage.value())/100))?e.topLineColor.value():e.bottomLineColor.value();break}case 12:y=n.hiloStyle.childs().color.value();break;case 21:y=n.hlcBarsStyle.childs().color.value();break;default:throw new Error("Not supported overlay style")}const f={...r.getFormattedValues(_,l,!0),noData:!1,floatCoordinate:p,coordinate:p,color:y};return s&&(f.price=_),f}priceRange(e,t,s){if(s.forceOverlayOnly)return null;if(!(0,
v.isInteger)(e))return Re.logDebug("priceRange: incorrect startBar"),null;if(!(0,v.isInteger)(t))return Re.logDebug("priceRange: incorrect endBar"),null;if(0===this.data().size())return null;const i=this.priceSource();let r;r=null!==i?this.data().minMaxOnRangeCached(e,t,[{name:i,offset:0}]):this.data().minMaxOnRangeCached(e,t,[{name:"low",offset:0},{name:"high",offset:0}]);const o=null!==r?new b.PriceRange(r.min,r.max):null;return this._postProcessPriceRange(o,s)}bars(){return this.data()}open(e){return(0,i.ensureNotNull)(this.bars().valueAt(e))[1]}high(e){return(0,i.ensureNotNull)(this.bars().valueAt(e))[2]}low(e){return(0,i.ensureNotNull)(this.bars().valueAt(e))[3]}close(e){return(0,i.ensureNotNull)(this.bars().valueAt(e))[4]}hl2(e){return(this.high(e)+this.low(e))/2}hlc3(e){return(this.high(e)+this.low(e)+this.close(e))/3}ohlc4(e){return(this.open(e)+this.high(e)+this.low(e)+this.close(e))/4}canBeHiddenByGlobalFlag(){return!1}async start(e,t){this._formatter=null,this._defaultFormatter=null;const s=super.start(e,t);return this.priceScale()?.updateFormatter(),Pe&&this._setQuotesSymbol((0,_.encodeExtendedSymbolOrGetSimpleSymbolString)(this._getSymbolObject(this.symbol()))),s}stop(e){super.stop(e),this._quotesProvider.setQuotesSessionSymbol(null)}formatter(){return this._formatter||this._recreateFormatter(),(0,i.ensureNotNull)(this._formatter)}statusView(){return Ae?super.statusView():null}moveItem(e,t,s){if(10===this.style()&&0===t){const t=(0,i.ensureNotNull)(this.priceScale()),s=this.properties().childs().baselineStyle,r=t.height(),o=100-e.y/r*100,n=o<0?0:Math.round(10*o)/10;s.childs().baseLevelPercentage.setValue(Math.max(Math.min(n,100),0))}}measureUnitId(){return(0,c.measureUnitId)(this.symbolInfo())}dataUpdated(){return this._dataUpdated}alertCreationAvailable(){return new w.WatchedValue(!this.priceScale()?.isPercentage()&&super.alertCreationAvailable().value()).readonly()}legendValuesProvider(){return this._overlayLegendValuesProvider}valuesProvider(){return this._overlayValuesProvider}chartFloatingTooltipValuesProvider(){return this._overlayChartFloatingTooltipValuesProvider}defaultPlotIdForAlert(){return""}tags(){const e=[],t=this.symbolInfo();if(t)e.push(t.name);else{const t=this.symbol();t&&e.push(t)}return e}statusProvider(e){return new be(this)}inputsInParts(e,t,s,i,r){return null}_onPropertiesChanged(){super._onPropertiesChanged(),this._precomputedBarStyles=new WeakMap}async _tryChangeInputs(){await super._tryChangeInputs(),this._formatter=null,this._defaultFormatter=null,this.priceScale()?.updateFormatter()}_tryCreateFormatter(){C.customFormatters?.priceFormatterFactory?.(this.symbolInfo(),this.properties().childs().minTick.value());return(0,c.createSeriesFormatter)(this.symbolInfo(),this.properties().childs().minTick.value())}_tryCreateDefaultFormatter(){return(0,c.createSeriesFormatter)(this.symbolInfo(),"default")}_onUnitChanged(){"alwaysOff"!==(0,u.currencyUnitVisibilityProperty)().value()&&this._model.fullUpdate(),this._model.unitConversionEnabled()&&this.isStarted()&&this._tryChangeInputs(),
this._unitChanged.fire()}_getSymbolObject(e){const t=super._getSymbolObject(e),s=this.currency();null!==s&&(t["currency-id"]=s);const i=this.unit();return this._model.unitConversionEnabled()&&null!==i&&(t["unit-id"]=i),t.adjustment=this._model.mainSeries().properties().childs().dividendsAdjustment.value()?"dividends":"splits",t}_onSymbolResolvingStart(e,t){this._lastResolvedSymbolSource=t,super._onSymbolResolvingStart(e,t),this._symbolResolvingActive.setValue(!0)}_onSymbolError(){super._onSymbolError(),this._symbolResolvingActive.setValue(!1)}_onSymbolResolved(e,t,s){super._onSymbolResolved(e,t,s),this._recreatePriceFormattingDependencies();const i=t===this.symbol()?(0,c.extractSymbolNameFromSymbolInfo)(s,this.symbol()):null,r=(0,c.symbolCurrency)(s),o=(0,c.symbolUnit)(s,this._model.unitConversionEnabled());this._setSymbolParamsInternal({symbol:i??void 0,currency:r,unit:o},s),Pe&&this._setQuotesSymbol((0,_.encodeExtendedSymbolOrGetSimpleSymbolString)(this._getSymbolObject(this.symbol()))),this._checkStyle(),this._symbolResolvingActive.setValue(!1)}async _changeInputsImpl(e,t){await super._changeInputsImpl(e,t),this._realignLineToolsIfParamsChanged()}_getPropertyDefinitionsViewModelClass(){return Promise.all([s.e(86562),s.e(2033),s.e(9263),s.e(62040),s.e(60607)]).then(s.bind(s,779648)).then((e=>e.StudyOverlayDefinitionsViewModel))}_setQuotesSymbol(e){const t=this.symbolInfo(),s=(0,c.extractSymbolNameFromSymbolInfo)(t,e),i=s&&this.getSymbolString(s);this._quotesProvider.setQuotesSessionSymbol(i)}_onQuotesUpdate(e,t){!this._legendView||void 0===t.values.change&&void 0===t.values.change_percent||(this._legendView.update((0,re.sourceChangeEvent)(this.id())),this._model.updateSource(this))}_createViews(){this._priceAxisViews=[];const e=new V(this);this._priceAxisViewsBase=[e];const t=new E(this);this._priceLinesAxisViews=[t],this._paneViews=[],this._labelPaneViews=[];let s=null,r=null;switch(this.properties().childs().style.value()){case 0:r=new he.SeriesBarsPaneView(this,this._model);break;case 1:r=new ce.SeriesCandlesPaneView(this,this._model);break;case 9:r=new fe.SeriesHollowCandlesPaneView(this,this._model);break;case 13:r=new me.SeriesColumnsPaneView(this,this._model);break;case 2:case 14:case 15:r=new de.SeriesLinePaneView(this,this._model);break;case 3:r=new _e.SeriesAreaPaneView(this,this._model);break;case 16:r=new pe.SeriesHLCAreaPaneView(this,this._model);break;case 10:{r=new ye.SeriesBaselinePaneView(this,this._model);const e=this.properties().childs().baselineStyle.childs();s=new D.SeriesWaterlinePaneView({paneHeight:()=>(0,i.ensureNotNull)(this.priceScale()).height(),color:()=>e.baselineColor.value(),baseLevelPercentage:()=>e.baseLevelPercentage.value()});break}case 12:r=new Se.SeriesHiLoPaneView(this,this._model);break;case 21:r=new De.SeriesHLCBarsPaneView(this,this._model)}r&&this._paneViews.push(r),null!==s&&this._paneViews.push(s),this._paneViews.push(new N(this)),this._dataWindowView||(this._dataWindowView=new ie(this,this._model)),this._legendView||(this._legendView=new le(this,this._model)),
this._statusView||(this._statusView=new x.StudyStatusView(this)),this._floatingTooltipView||(this._floatingTooltipView=new Ce.StudyChartFloatingTooltipView(this,this._model)),this._priceAxisViews=[...this._priceAxisViewsBase],this._labelPaneViews.push(new ue.PanePriceAxisView(e,this,this._model))}_createStudyOnServer(){const e=super._createStudyOnServer();return this._realignLineToolsIfParamsChanged(),e}_modifyStudyOnServer(e){super._modifyStudyOnServer(e,0)}_titleInParts(e,t,s,i,r){const o=this.symbolInfo();return[this._getSymbolTitlePart(o),[this._getExchangeTitlePart(o,r),this._getPriceSourceTitlePart(o)].filter((e=>null!==e))]}_mergeData(e){return this._invalidateLastNonEmptyPlotRowCache(),this._conflatedChunksBuilder.mergeData(e)}_clearData(){this._conflatedChunksBuilder.clearData()}_moveData(e){this._conflatedChunksBuilder.moveData(e)}_getSymbolTitlePart(e){if(null===e)return Te?"":this.properties().childs().inputs.childs().symbol.value();if(Ie)switch(this._model.mainSeries().symbolTextSourceProxyProperty().value()){case"description":return e.description;case"ticker-and-description":return`${e.name}, ${e.description}`;case"long-description":return e.long_description??e.description}return e.name}_getExchangeTitlePart(e,t){return null===e||t?null:(0,c.getSymbolExchange)(e)}_getPriceSourceTitlePart(e){return null}_onAllowExtendTimeScaleChanged(){}_setSymbolParamsInternal(e,t){const{symbol:s,currency:i,unit:r,style:o}=e,n=this.properties().childs(),a=n.inputs.childs().symbol.value(),l=n.currencyId.value(),u=n.unitId.value(),h=n.style.value();if(void 0!==s&&n.inputs.childs().symbol.setValueSilently(s),void 0!==i&&n.currencyId.setValueSilently(i),void 0!==r&&n.unitId.setValueSilently(r),void 0!==o&&n.style.setValueSilently(o),t)this._resolvedSymbolsByInput[this.symbol()]=t,this._resolvedSymbols[this._getSymbolForResolve(this.symbol())]=t,this._realignToolsLastParams=null;else{const e=this.symbolInfo();null!==e&&(n.currencyId.setValueSilently((0,c.symbolCurrency)(e)),n.unitId.setValueSilently((0,c.symbolUnit)(e,this._model.unitConversionEnabled())))}n.inputs.childs().symbol.value()!==a&&n.inputs.childs().symbol.fireChanged(),n.currencyId.value()!==l&&n.currencyId.fireChanged(),n.unitId.value()!==u&&n.unitId.fireChanged(),n.style.value()!==h&&n.style.fireChanged(),this._checkStyle(),this._realignLineToolsIfParamsChanged()}_updateBarFunction(){this._barFunction=(0,l.barFunctionByStyle)(this.style(),this.priceSource())}_onMinTickChanged(){this._recreatePriceFormattingDependencies(),this.updateAllViews({type:"global-change"}),this._model.fullUpdate()}_onChartStyleChanged(){this._updateBarFunction(),this._styleToRecover?.originalStyle!==this.style()&&(this._styleToRecover=null)}_checkStyle(){const e=this.style();(0,c.isCloseBasedSymbol)(this.symbolInfo())||this.model().mainSeries().intervalObj().value().is1Tick()?(0,c.isSingleValueBasedStyle)(e)||(this.setStyle(2),this._styleToRecover={correctedStyle:this.style(),originalStyle:e}):null!==this._styleToRecover&&(this.setStyle(this._styleToRecover.originalStyle),
this._styleToRecover=null)}_realignLineToolsIfParamsChanged(){let e=null===this._realignToolsLastParams;if(null!==this._realignToolsLastParams){const t=this.compareSymbolParams(this._realignToolsLastParams);e=t.symbolChanged||t.intervalChanged||t.currencyChanged||t.unitChanged}e&&(this._model.realignLineTools(this),this._realignToolsLastParams=this.symbolParams())}}},252010:(e,t,s)=>{"use strict";s.r(t),s.d(t,{StudyStrategy:()=>L});var i=s(650279),r=s(650151),o=s(820028),n=s(631114),a=s(790188),l=s(86441),u=s(724377),h=s(731974),c=s(278688),d=s(688857),_=s(982367);function p(e,t,s){return s?Math.sign(e)*(Math.round(Math.abs(e))+t):Math.round(e)+t}class y{constructor(e,t){this._data=e,this._textWidths=t}draw(e,t){const{horizontalPixelRatio:s,verticalPixelRatio:i}=t;void 0!==this._textWidths.renderingInfo&&(0,c.equalRenderingInfos)(this._textWidths.renderingInfo,t)||(this._textWidths.renderingInfo=t,this._textWidths.width.clear());const r=this._data;e.lineJoin="miter",e.miterLimit=Math.round(2*s),e.strokeStyle=r.bgColor,e.lineWidth=Math.max(2,(0,_.ceiledEven)(2*s));for(const s of r.items){e.beginPath();const o="lower"===s.pos;e.save();const n=Math.round(r.orderArrow.vMargin*i);e.translate(0,o?n:-n),this._drawOrderArrow(e,s.orderPoint,r.orderArrow,r.exitLineWidth,o,t),e.restore(),e.save(),this._drawPriceArrow(e,s.pricePoint,r.priceArrow,!o,t),e.restore(),e.closePath(),e.stroke(),e.fillStyle=r.exitLineWidth?r.exitColor:"buy"===s.type?r.buyColor:r.sellColor,e.fill()}const o=r.text;o.visible&&(0,d.drawScaled)(e,s,i,(()=>{e.font=o.fontSize+"px "+o.font,e.textAlign="center",e.textBaseline="top",e.fillStyle=r.labelColor,e.strokeStyle=r.bgColor,e.lineWidth=Math.min(2,Math.floor(2*s));for(const t of r.items){const s="lower"===t.pos;e.save();const i=s?1:-1,n=r.orderArrow;e.translate(0,(n.height+n.vMargin+r.exitLineWidth)*i);const a=s?o.vMargin:-o.fontSize-o.vMargin,l=i*(o.fontSize+o.lineSpacing);if(t.label&&(e.translate(0,a),e.strokeText(t.label,Math.ceil(t.orderPoint.x),t.orderPoint.y),e.fillText(t.label,Math.ceil(t.orderPoint.x),t.orderPoint.y),this._textWidths.width.has(t.label)||this._textWidths.width.set(t.label,e.measureText(t.label).width)),t.qty){const s=Boolean(t.label)?l:a;e.translate(0,s),e.strokeText(t.qty,Math.ceil(t.orderPoint.x),t.orderPoint.y),e.fillText(t.qty,Math.ceil(t.orderPoint.x),t.orderPoint.y),this._textWidths.width.has(t.qty)||this._textWidths.width.set(t.qty,e.measureText(t.qty).width)}e.restore()}}))}hitTest(e){const t=this._testOrderArrows(e),s=!t&&this._data.text&&this._testText(e);return t||s?new h.HitTestResult(h.HitTarget.Regular):null}_drawOrderArrow(e,t,s,i,r,o){let n,a;r?(e.rotate(Math.PI),n=-t.x,a=-t.y):(n=t.x,a=t.y),a-=s.height+i;const{horizontalPixelRatio:l,verticalPixelRatio:u}=o,h=Math.max(1,Math.floor(l)),c=h%2?.5:0,d=r?"floor":"ceil";n=p(n*l,c,r),a=Math.round((Math[d](a)+.5)*u),e.translate(n,a);const y=(0,_.ceiledEven)(s.width*l)/2+c,f=(0,_.ceiledEven)(s.tailWidth*l)/2+c,m=Math.round(s.tailHeight*u);if(e.moveTo(-f,0),e.lineTo(f,0),e.lineTo(f,m),e.lineTo(y,m),
e.lineTo(0,Math.round(s.height*u)),i){const t=Math.floor(h/2);e.lineTo(y+t,Math.round(s.height*u)),e.lineTo(y+t,Math.round((s.height+i)*u)),e.lineTo(-y-t,Math.round((s.height+i)*u)),e.lineTo(-y-t,Math.round(s.height*u)),e.lineTo(0,Math.round(s.height*u))}e.lineTo(-y,m),e.lineTo(-f,m),e.lineTo(-f,0),e.lineTo(f,0)}_drawPriceArrow(e,t,s,i,r){let o,n;i?(e.rotate(Math.PI),o=-t.x,n=-t.y):(o=t.x,n=t.y);const{horizontalPixelRatio:a,verticalPixelRatio:l}=r,u=Math.max(1,Math.floor(a)),h=u%2?.5:0;o=p(o*a,h,i)-u,n=p(n*l,h,i);const c=(0,_.ceiledEven)(2*s.width*l)/2,d=-(Math.round(s.width*a)+h);e.translate(o,n),e.moveTo(0,0),e.lineTo(d,-c),e.lineTo(d,c),e.lineTo(0,0),e.lineTo(d,-c)}_testOrderArrows(e){const t=this._data,s=t.orderArrow.width/2;for(const i of t.items){const r=i.orderPoint;if(e.x<r.x-s||e.x>r.x+s)continue;const o="lower"===i.pos;let n=t.orderArrow.height+t.exitLineWidth;o||(n=-n);const a=r.y+(o?t.orderArrow.vMargin:-t.orderArrow.vMargin),l=Math.min(a,a+n),u=Math.max(a,a+n);if(!(e.y<l||e.y>u))return!0}return!1}_testText(e){const t=this._data,s=t.text;if(!s.visible)return!1;for(const i of t.items){const r=i.orderPoint,o="lower"===i.pos;let n=t.orderArrow.vMargin+t.orderArrow.height+t.exitLineWidth;o||(n=-n);const a=r.y+n,l=(i.label?1:0)+(i.qty?1:0);let u=s.vMargin+s.fontSize*l+s.lineSpacing*Math.max(0,l-1);o||(u=-u);const h=Math.min(a,a+u),c=Math.max(a,a+u);if(e.y<h||e.y>c)continue;const d=i.label&&i.qty?o&&e.y<a+s.fontSize||!o&&e.y>a-s.fontSize?i.label:i.qty:i.label||i.qty,_=this._textWidths.width.get(d);if(!(void 0===_||e.x<r.x-_/2||e.x>r.x+_/2))return!0}return!1}}var f=s(910282),m=s(584785),S=s(708162);const g={BuyColor:(0,a.getHexColorByName)("color-tv-blue-500"),SellColor:"#FF1744",ExitColor:"#D500F9",LabelDarkColor:(0,a.getHexColorByName)("color-cold-gray-300"),LabelLightColor:(0,a.getHexColorByName)("color-cold-gray-900")};function v(e){return!1===e.e?"exit":e.b?"entryBuy":"entrySell"}function b(e){return e.b?"buy":"sell"}function w(e,t){return t?!e.b:e.b}function C(e,t){return w(e,t)?"lower":"upper"}function x(e,t,s){let i=e[t].get(s);return void 0===i&&(i=0,e[t].set(s,i)),i}function D(e,t,s,i){const o=(0,r.ensureDefined)(e[t].get(s));e[t].set(s,o+i)}function P(e,t){return t&&(e.c||e.id||"Untitled")||""}function I(e,t){return t&&(e.b?"+":"-")+e.q||""}function T(e,t,s){return(0,r.ensureNotNull)(e.b?s.valueAt(t,3):s.valueAt(t,2))}function A(e,t){return("exit"===v(e)?2:0)+t.vMargin+t.height}class R{constructor(e,t,s){this._invalidated=!0,this._textWidths={width:new Map},this._study=e,this._series=t,this._model=s,this._orderArrow={vMargin:11,width:10,height:15,tailWidth:2,tailHeight:10},this._priceArrow={width:5},this._text={vMargin:7,font:f.CHART_FONT_FAMILY,fontSize:12,lineSpacing:2,visible:!0},this._items={entryBuy:[],entrySell:[],exit:[]},this._study.properties().childs().strategy.childs().orders.subscribe(this,this.update)}update(){this._invalidated=!0}clearItems(){this._items.entryBuy=[],this._items.entrySell=[],this._items.exit=[]}renderer(){const e=this._study.properties().childs()
;if(!e.visible.value()||!e.strategy.childs().orders.childs().visible.value())return null;if(this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._items.entryBuy.length||this._items.entrySell.length||this._items.exit.length){const e=new S.CompositeRenderer;return this._items.entryBuy.length&&e.append(this._strategyOrdersRenderer(this._items.entryBuy,!1)),this._items.entrySell.length&&e.append(this._strategyOrdersRenderer(this._items.entrySell,!1)),this._items.exit.length&&e.append(this._strategyOrdersRenderer(this._items.exit,!0)),e}return null}_strategyOrdersRenderer(e,t){const s=this._model.backgroundColor().value(),i="black"===(0,u.rgbToBlackWhiteString)((0,u.parseRgb)(s),150);return new y({items:e,buyColor:g.BuyColor,sellColor:g.SellColor,exitColor:g.ExitColor,labelColor:i?g.LabelDarkColor:g.LabelLightColor,bgColor:s,orderArrow:this._orderArrow,exitLineWidth:t?2:0,priceArrow:this._priceArrow,text:this._text},this._textWidths)}_updateImpl(){this.clearItems();const e=this._study.ordersData();if(!e||!e.length)return;const t=this._model.timeScale(),s=this._series.priceScale(),i=t.visibleBarsStrictRange();if(t.isEmpty()||s.isEmpty()||null===i)return;const o=this._study.barsIndexes(),n=this._series.nearestIndex(i.firstBar(),m.PlotRowSearchMode.NearestRight),a=this._series.nearestIndex(i.lastBar(),m.PlotRowSearchMode.NearestLeft);if(void 0===n||void 0===a)return;const[u,h]=function(e,t,s,i){const r=[],o=[];for(let n=0;n<e.length;++n){const a=i[n];a<t||a>s||(r.push(e[n]),o.push(a))}return[r,o]}(e,n,a,o),[c,d]=this._labelAndQtyVisibility(u.length),_=c||d,p=this._textHeight(c,d),y=(0,r.ensureNotNull)(this._series.firstValue()),f=s.isInverted(),S={upper:new Map,lower:new Map};for(let e=0;e<u.length;e++){const i=u[e],r=w(i,f),o=h[e],n=t.indexToCoordinate(o),a=T(i,o,this._series);let _=s.priceToCoordinate(a,y);const m=C(i,f),g=x(S,m,o);_+=r?g:-g;D(S,m,o,A(i,this._orderArrow)+p);const R=s.priceToCoordinate(i.p,y),V=v(i);this._items[V].push({orderPoint:new l.Point(n,_),pricePoint:new l.Point(n,R),label:P(i,c),qty:I(i,d),pos:m,type:b(i)})}this._text.visible=_}_labelAndQtyVisibility(e){const t=this._model.timeScale();if(t.barSpacing()<10&&this._orderArrow.width*e*2>t.width())return[!1,!1];const s=this._study.properties().childs().strategy.childs().orders.childs();return[s.showLabels.value(),s.showQty.value()]}_textHeight(e,t){return e||t?e&&t?2*this._text.fontSize+this._text.vMargin+this._text.lineSpacing:this._text.fontSize+this._text.vMargin:0}}var V=s(461820),M=s(547465),E=s(44049);const k=["strategy_props"];class L extends n.Study{constructor(e,t,s,i,r,n,a){super(e,t,s,i,r,n),this.watchedData=new o.WatchedValue,this._reportData=null,this._reportChanged=new M.Delegate,this._barsIndexes=[],this._srcBarsIndexes=[],this._reportDataBuffer=null,this._activeState=!1,a||(t.childs().visible.subscribe(this,(()=>{this._processChangeVisibility()})),this.onIsActualIntervalChange().subscribe(this,(()=>this._processChangeVisibility())),this._processChangeVisibility(n))}destroy(){
this._properties.childs().visible.unsubscribeAll(this),this.model().removeStrategySource(this,0),super.destroy()}properties(){return this._properties}hasStateForAlert(){return V.alertsAvailable&&this._series.alertCreationAvailable().value()}canHasAlertOnLineTools(){return!1}inputsForAlertState(){const e=this.inputs();return this._metaInfo.value().inputs.forEach((t=>{const s=e[t.id];s&&t.internalID&&(s.internalID=t.internalID)})),e}reportData(){return this._reportData}ordersData(){return this._reportData?.filledOrders??null}barsIndexes(){return this._barsIndexes}clearData(){super.clearData(),this._reportDataBuffer=null,this._reportData=null,this._strategyOrdersPaneView&&this._strategyOrdersPaneView.clearItems(),this._reportChanged.fire({activeOrdersChanged:!0,filledOrdersChanged:!0,positionChanged:!0})}reportChanged(){return this._reportChanged}strategyOrdersPaneView(){return this.isSourceHidden()?null:this._strategyOrdersPaneView}restoreData(e){super.restoreData(e);const t=e;this.model().addStrategySource(this,0),t.reportData&&t.barsIndexes&&(this._reportData=t.reportData,this._barsIndexes=t.barsIndexes,this.watchedData.setValue({method:"data_update",nonSeriesData:{indexes_replace:!1,data:{report:this._reportData}}})),t.activeState&&(this._activeState=!0)}activeState(){return this._activeState}updateAllViews(e){super.updateAllViews(e),this._strategyOrdersPaneView&&this._strategyOrdersPaneView.update()}state(e,t){const s=super.state(e,t);return e&&this._reportData&&this._barsIndexes&&(s.data||(s.data={}),s.data.reportData=this._reportData,s.data.barsIndexes=this._barsIndexes,s.data.activeState=this.model().activeStrategySource().value()===this),s}isHibernationAllowed(){return!1}pineSourceCodeModel(){return this.metaInfo().pine?(this._pineSourceCodeModel||(this._pineSourceCodeModel=new E.AsyncResourceWrapper(Promise.all([s.e(34644),s.e(50687),s.e(75947),s.e(88741),s.e(85182),s.e(32565),s.e(7351),s.e(13498),s.e(78466),s.e(40309),s.e(96186),s.e(43477),s.e(95334),s.e(89199)]).then(s.bind(s,465675)).then((e=>this._isDestroyed?null:new e.PineStrategySourceCodeModel(this))),(e=>{e?.destroy()}))),this._pineSourceCodeModel.promise()):Promise.resolve(null)}_onData(e){e.method&&"data_update"!==e.method&&this.watchedData.setValue({method:e.method}),super._onData(e)}_onDataUpdated(e,t,s,o){let n=t&&!t.indexes_replace&&t.data&&t.data.report;if(n){const e=!(0,i.default)(n.activeOrders,this._reportData?.activeOrders),s=!(0,i.default)(n.filledOrders,this._reportData?.filledOrders),o=!(0,i.default)(n.position,this._reportData?.position);t&&!t.indexes_replace&&t.isUpdate&&this._reportDataBuffer&&(n={...this._reportDataBuffer,...n}),this._reportData={...this._reportDataBuffer,...n},this._reportDataBuffer=this._reportData,this.watchedData.setValue({method:"data_update",nonSeriesData:(0,r.ensureNotNull)(t)}),this._reportChanged.fire({activeOrdersChanged:e,filledOrdersChanged:s,positionChanged:o})}else this.watchedData.setValue({method:"data_update",nonSeriesData:{indexes_replace:!1,data:{report:this._reportDataBuffer}}})
;const a=!(!t||!t.indexes_replace);("nochange"!==s&&s.length>0||(this._reportData?.filledOrders?.length??0)!==this._barsIndexes.length)&&(n||a)&&this._collateBarsIndexes(Array.isArray(s)?s:this._srcBarsIndexes),super._onDataUpdated(e,t,s,o)}_createViews(){super._createViews(),this._strategyOrdersPaneView=new R(this,this._series,this._model)}_titleInputs(e,t,s){return this.inputs({symbolsForDisplay:!0,skipHiddenInputs:!0,skipFakeInputs:!1,fakeInputsForDisplay:!0,asObject:!0,skippedGroups:k,noExchanges:t,displayMask:e})}_getTelemetryObjectName(){return"strategy"}_collateBarsIndexes(e){this._srcBarsIndexes=e;const t=this._reportData?.filledOrders;if(t&&t.length){this._barsIndexes.length=0;for(let s=0;s<t.length;s++)this._barsIndexes[s]=e[t[s].tm]}}_processChangeVisibility(e){const t=!0===e?2:0;this.isSourceHidden()?this.model().removeStrategySource(this,t):this.model().addStrategySource(this,t)}}},616427:(e,t,s)=>{"use strict";s.d(t,{areEqualSymbols:()=>n,compareSymbolParams:()=>h,symbolParams:()=>u,symbolSameAsCurrent:()=>l});s(931924);var i=s(388741),r=s(477786);const o=!0;function n(e,t){return void 0===e?void 0===t:void 0!==t&&(o?e.toUpperCase()===t.toUpperCase():e===t)}function a(e,t){return e.some((e=>n(t,e)))}function l(e,t){if(null===t)return!1;if(t){if(n(t.full_name,e)||n(t.pro_name,e))return!0;if(n(t.ticker,e))return!0;if(t.aliases&&a(t.aliases,e))return!0;if(t.alternatives&&a(t.alternatives,e))return!0;if(0===e.indexOf("FRA:")&&n(t.pro_name,e.replace("FRA:","FWB:")))return!0}return!1}function u(e){return{symbol:e.symbol(),currency:e.currency(),unit:e.unit(),interval:e.interval(),style:e.style()}}function h(e,t,s){const{symbol:o,currency:n,unit:a,style:l,interval:u}=t,h=void 0!==o&&!e.symbolSameAsResolved(o);let c,d;const _=e.symbolInfo();null!==_?(c=void 0!==n&&!function(e,t){return null===e&&!(0,i.isConvertedToOtherCurrency)(t)||e===(0,i.symbolCurrency)(t)}(n,_),d=void 0!==a&&!function(e,t,s){return null===e&&!(0,i.isConvertedToOtherUnit)(t,s)||e===(0,i.symbolUnit)(t,s)}(a,_,s)):(c=void 0!==n&&n!==e.currency(),d=void 0!==a&&a!==e.unit());return{symbolChanged:h,intervalChanged:void 0!==u&&!r.Interval.isEqual(e.interval(),u),currencyChanged:c,unitChanged:d,styleChanged:void 0!==l&&l!==e.style(),styleChangeRequiresRestart:void 0!==l&&(0,i.styleChangeRequiresRestart)(l,e.style())}}},422063:(e,t,s)=>{"use strict";s.d(t,{UndoCommand:()=>r});var i=s(418450);class r{constructor(e,t=!0,s=!0){this._text=e||new i.TranslatedString("",""),this._executeOnPush=t,this._affectsState=s}text(){return this._text}executeOnPush(){return this._executeOnPush}affectsState(){return this._affectsState}canMerge(e){return!1}merge(e){throw new Error("Should be re-implemented in child classes")}}},262609:(e,t,s)=>{"use strict";s(142492);var i=s(324951),r=s(414879),o=r.WeekDays,n=r.Months,a=s(936410),l=a.monthsFullNames,u=a.monthsShortNames,h=a.weekDaysFullNames,c=a.weekDaysShortNames,d=a.weekDaysMiniNames;window.language&&(i.locale(window.language,{
months:[l[n.JANUARY],l[n.FEBRUARY],l[n.MARCH],l[n.APRIL],l[n.MAY],l[n.JUNE],l[n.JULY],l[n.AUGUST],l[n.SEPTEMBER],l[n.OCTOBER],l[n.NOVEMBER],l[n.DECEMBER]],monthsShort:[u[n.JANUARY],u[n.FEBRUARY],u[n.MARCH],u[n.APRIL],u[n.MAY],u[n.JUNE],u[n.JULY],u[n.AUGUST],u[n.SEPTEMBER],u[n.OCTOBER],u[n.NOVEMBER],u[n.DECEMBER]],weekdays:[h[o.SUNDAY],h[o.MONDAY],h[o.TUESDAY],h[o.WEDNESDAY],h[o.THURSDAY],h[o.FRIDAY],h[o.SATURDAY]],weekdaysShort:[c[o.SUNDAY],c[o.MONDAY],c[o.TUESDAY],c[o.WEDNESDAY],c[o.THURSDAY],c[o.FRIDAY],c[o.SATURDAY]],weekdaysMin:[d[o.SUNDAY],d[o.MONDAY],d[o.TUESDAY],d[o.WEDNESDAY],d[o.THURSDAY],d[o.FRIDAY],d[o.SATURDAY]],longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"MMM D",l:"M/D/YYYY",LL:"MMM D, YYYY",ll:"MMM D LT",LLL:"LT - LL",lll:"MMM D, YYYY LT",LLLL:"ddd D MMMM YYYY LT",llll:"ddd D MMM YYYY LT"},calendar:{sameDay:s.i18next(null,void 0,s(689399)).format({specialSymbolOpen:"[",specialSymbolClose:"]",dayTime:"LT"}),nextDay:s.i18next(null,void 0,s(534437)).format({specialSymbolOpen:"[",specialSymbolClose:"]",dayTime:"LT"}),nextWeek:s.i18next(null,void 0,s(71460)).format({specialSymbolOpen:"[",specialSymbolClose:"]",dayTime:"LT",dayName:"dddd"}),lastDay:s.i18next(null,void 0,s(285799)).format({specialSymbolOpen:"[",specialSymbolClose:"]",dayTime:"LT"}),lastWeek:s.i18next(null,void 0,s(632811)).format({specialSymbolOpen:"[",specialSymbolClose:"]",dayTime:"LT",dayName:"dddd"}),sameElse:"L"},relativeTime:{future:function(e){return e===s.i18next(null,void 0,s(464017))?e:s.i18next(null,{context:"time_range"},s(326715)).replace("%s",e)},past:function(e){return e===s.i18next(null,void 0,s(464017))?e:s.i18next(null,{context:"time_range"},s(820864)).replace("%s",e)},s:s.i18next(null,void 0,s(464017)),m:function(e){return s.i18next(null,{plural:"%d minutes",count:e},s(584890)).replace("%d",e)},mm:function(e){return s.i18next(null,{plural:"%d minutes",count:e},s(584890)).replace("%d",e)},h:s.i18next(null,void 0,s(105756)),hh:function(e){return s.i18next(null,{plural:"%d hours",count:e},s(817856)).replace("%d",e)},d:s.i18next(null,void 0,s(426940)),dd:function(e){return s.i18next(null,{plural:"%d days",count:e},s(851068)).replace("%d",e)},M:s.i18next(null,void 0,s(2046)),MM:function(e){return s.i18next(null,{plural:"%d months",count:e},s(515185)).replace("%d",e)},y:s.i18next(null,void 0,s(403823)),yy:function(e){return s.i18next(null,{plural:"%d years",count:e},s(909806)).replace("%d",e)}},week:{dow:1,doy:4}}),i.locale(window.language)),e.exports=i},149204:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" width="25" height="25" fill="none"><circle stroke="currentColor" stroke-width="1.5" cx="12.5" cy="12.5" r="11.75"/><path fill="currentColor" d="M8.25 18V7.43h3.96c1.05 0 1.95.2 2.68.62.75.4 1.31 1 1.7 1.78.4.78.6 1.73.6 2.83v.02a6.5 6.5 0 0 1-.59 2.88c-.39.8-.96 1.4-1.7 1.82a5.4 5.4 0 0 1-2.69.62H8.25Zm1.9-1.59h1.82c.7 0 1.29-.14 1.78-.43.5-.29.87-.71 1.12-1.26.26-.55.4-1.22.4-2.02v-.01c0-.77-.14-1.43-.4-1.98a2.78 2.78 0 0 0-1.13-1.26 3.45 3.45 0 0 0-1.77-.43h-1.83v7.4Z"/></svg>'},226235:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" width="25" height="25" fill="none"><rect width="21.5" height="21.5" stroke="currentColor" stroke-width="1.5" rx="1.25" x=".75" y="2.75"/><path fill="currentColor" d="M8.21 19V8.43h6.84v1.6H10.1v2.85h4.68v1.5H10.1v3.03h4.95V19H8.21Z"/></svg>'},183800:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" width="25" height="25" fill="none"><path stroke="currentColor" stroke-width="1.5" d="M10.85 23.72c.4.25.9.25 1.3 0l9.5-5.82c.37-.22.6-.63.6-1.06V2c0-.69-.56-1.25-1.25-1.25H2C1.31.75.75 1.31.75 2v14.84c0 .43.23.84.6 1.06l9.5 5.82Z"/><path fill="currentColor" d="M8.21 17V6.43h6.84v1.6H10.1v2.85h4.68v1.5H10.1v3.03h4.95V17H8.21Z"/></svg>'},472134:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" width="25" height="25" fill="none"><path stroke="currentColor" stroke-width="1.5" d="M10.87 1.23c.39-.22.87-.22 1.26 0l9.5 5.52c.38.23.62.64.62 1.08V23c0 .69-.56 1.25-1.25 1.25H2c-.69 0-1.25-.56-1.25-1.25V7.83c0-.44.24-.85.62-1.08l9.5-5.52Z"/><path fill="currentColor" d="M8.21 19V8.43h6.84v1.6H10.1v2.85h4.68v1.5H10.1v3.03h4.95V19H8.21Z"/></svg>'},85752:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" width="25" height="25" fill="none"><circle stroke="currentColor" stroke-width="1.5" cx="12.5" cy="12.5" r="11.75"/><path fill="currentColor" d="m19.27 13.25.53-.53-.53-.53-3.5-3.5-1.06 1.06 2.22 2.22h-5.38L7.27 7.7 6.2 8.75l4.5 4.5.22.22h6L14.7 15.7l1.06 1.06 3.5-3.5Zm-10.56.44-3 3 1.06 1.06 3-3L8.7 13.7Z"/></svg>'},682345:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" width="25" height="25" fill="none"><circle stroke="currentColor" stroke-width="1.5" cx="12.5" cy="12.5" r="11.75"/><path fill="currentColor" d="M12.51 18.26a5.5 5.5 0 0 1-2.13-.38c-.6-.25-1.08-.6-1.43-1.06a2.9 2.9 0 0 1-.58-1.59v-.1h1.82l.01.07c.03.3.15.56.35.78.21.22.49.4.84.52a3.56 3.56 0 0 0 2.31-.02c.33-.13.58-.3.77-.54.19-.23.28-.5.28-.8v-.01c0-.38-.15-.7-.45-.93-.3-.25-.79-.44-1.47-.59l-1.14-.23a5.8 5.8 0 0 1-1.76-.64c-.46-.28-.8-.62-1.01-1.02-.22-.4-.32-.86-.32-1.38 0-.64.16-1.19.5-1.66.33-.48.8-.85 1.38-1.11.59-.27 1.27-.4 2.03-.4.78 0 1.45.13 2.03.4.57.25 1.02.6 1.34 1.05.33.45.51.96.55 1.53l.01.1h-1.8l-.02-.1a1.38 1.38 0 0 0-.34-.72 1.85 1.85 0 0 0-.73-.5c-.3-.12-.65-.18-1.06-.18-.38 0-.73.06-1.03.18-.3.12-.54.29-.72.5a1.2 1.2 0 0 0-.25.78c0 .25.06.47.19.66.12.2.32.36.6.5.27.13.63.24 1.07.34l1.13.24c.74.16 1.35.36 1.81.62.46.26.8.58 1.02.97.22.38.33.84.33 1.38 0 .69-.17 1.28-.5 1.78-.34.5-.82.88-1.44 1.15-.61.28-1.34.41-2.19.41Z"/></svg>'}}]);