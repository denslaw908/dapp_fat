"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[56657,15483],{564894:(e,t,n)=>{n.d(t,{hasService:()=>a,registerService:()=>s,service:()=>u,unregisterService:()=>l,waitServiceRegistered:()=>c});var o=n(925049);const i={},r=new Map;function s(e,t){if(a(e))throw new Error("Service already registered");i[e.id]=t;const n=r.get(e.id);void 0!==n&&(r.delete(e.id),n.resolve(t))}function l(e){if(!a(e))throw new Error("Service not found");i[e.id]=void 0}function a(e){return void 0!==i[e.id]}function u(e){const t=i[e.id];if(void 0===t)throw new Error("ServiceLocator: Service "+e.id+" not found");return t}function c(e){if(a(e))return Promise.resolve(u(e));let t=r.get(e.id);return void 0===t&&(t=(0,o.createDeferredPromise)(),r.set(e.id,t)),t.promise}},72368:(e,t,n)=>{n.d(t,{canShowNewSymbolSearch:()=>a,getCurrentLocaleInfoCountry:()=>u,isMobile:()=>s,isPlatformMobile:()=>l});var o=n(314802),i=n(931924),r=n(638456);function s(){const e=window.matchMedia("(min-width: 602px) and (min-height: 445px)").matches;return r.CheckMobile.any()&&!e}function l(){return!(0,o.isOnMobileAppPage)("any")&&s()}function a(){return!i.enabled("widget")&&!(0,o.isOnMobileAppPage)("any")}function u(){return window.initData?.currentLocaleInfo?.flag.toUpperCase()}},515828:(e,t,n)=>{n.d(t,{MINDS_GROUP_PATH_PATTERN:()=>o,createMindsPath:()=>i});const o="/minds/groups/:symbol/";function i(e,t,n){let i=o.replace(":symbol",encodeURIComponent(e));if(!t)return i;const r=new URLSearchParams;return r.set("mind",t),n&&r.set("editable","true"),i+=`?${r.toString()}`,i}},951713:(e,t,n)=>{n.d(t,{getHideOptions:()=>c,getSavedHideMode:()=>f,toggleHideMode:()=>d});var o=n(650151),i=n(444372),r=n(62802),s=n(699576),l=n(87913),a=n(597101);let u=null;function c(){if(null!==u)return u;const e=(0,s.tradingService)();return u=new Map([["drawings",{label:i.t(null,void 0,n(703217)),dataName:"hide-drawing-tools",tooltip:{active:i.t(null,void 0,n(185891)),inactive:i.t(null,void 0,n(752563))},getBoxedValue:()=>(0,l.hideAllDrawings)(),trackLabel:"hide drawings"}],["indicators",{label:i.t(null,void 0,n(72351)),dataName:"hide-indicators",tooltip:{active:i.t(null,void 0,n(598753)),inactive:i.t(null,void 0,n(178525))},getBoxedValue:()=>(0,l.hideAllIndicators)(),trackLabel:"hide indicators"}],["positions",{label:i.t(null,void 0,n(492226)),dataName:"hide-positions-and-orders",tooltip:{active:i.t(null,void 0,n(420506)),inactive:i.t(null,void 0,n(842164))},getBoxedValue:()=>(0,o.ensureNotNull)(e).showTradedSources,inverted:!0,trackLabel:"hide positions"}],["all",{label:i.t(null,void 0,n(47074)),dataName:"hide-all",tooltip:{active:e?i.t(null,void 0,n(686738)):i.t(null,void 0,n(225881)),inactive:e?i.t(null,void 0,n(418216)):i.t(null,void 0,n(90763))},trackLabel:"hide all"}]]),e||u.delete("positions"),u}function d(e){e?r.setValue("ChartToolsHideMode",e):e=f();const t=h();let n=!t;return"all"===e?(p(((e,t,o)=>{e.setValue(o?!n:n)})),a.hideStateChange.fire({hideMode:e,isActive:n}),n):(p(((o,i,r)=>{if(i===e){const e=t?!r:!o.value();o.setValue(e),n=r?!e:e
}else o.setValue(Boolean(r))})),a.hideStateChange.fire({hideMode:e,isActive:n}),n)}function f(){const e=r.getValue("ChartToolsHideMode","drawings");return c().has(e)?e:"drawings"}function h(){let e=!0;return p(((t,n,o)=>{const i=t.value();e=e&&(o?!i:i)})),e}function p(e){c().forEach(((t,n)=>{const o=t.getBoxedValue?.();o&&e(o,n,t.inverted)}))}},651231:(e,t,n)=>{n.d(t,{getChartWidgetApiTimeConverter:()=>s});var o=n(650151),i=n(482707);const r=n(931924).enabled("end_of_period_timescale_marks");function s(e,t,n){return new a(function(e,t){const n=function(e,t){return e+t.session+t.timezone+(t.corrections||"")+(t.session_holidays||"")}(e,t);let o=l.get(n);void 0===o&&(o=(0,i.createDwmAligner)(e,t),l.set(n,o));return o}(e,t),n)}const l=new Map;class a{constructor(e,t){this._dwmAligner=e,this._chartModel=t}convertPublicTimeToInternalTime(e){return null!==this._dwmAligner?this._dwmAligner.timeToSessionStart(1e3*e)/1e3:e}convertInternalTimeToPublicTime(e){return null!==this._dwmAligner?this._dwmAligner.timeToExchangeTradingDay(1e3*e)/1e3:e}convertTimePointIndexToPublicTime(e){const t=this._chartModel.timeScale();if(t.isEmpty())return null;let n=r?function(e,t){const n=e.indexToUserTime(t);if(null===n)return null;return n.getTime()/1e3}(t,e):this.convertTimePointIndexToInternalTime(e);return null!==n&&(n=this.convertInternalTimeToPublicTime(n)),n}convertTimePointIndexToInternalTime(e){const t=this._chartModel.timeScale();if(t.isEmpty())return null;const n=t.points(),{firstIndex:i,lastIndex:r}=(0,o.ensureNotNull)(n.range().value());let s=null;if(i<=e&&e<=r)s=n.valueAt(e);else if(e>r){const n=this._chartModel.mainSeries().syncModel();if(null!==n){const i=(0,o.ensureNotNull)(t.indexToTimePoint(r));s=n.projectTime(i,e-r)}}return s}}},61e3:(e,t,n)=>{n.r(t),n.d(t,{addSymbolDialogHasOpenedKey:()=>s,showAddSymbolDialog:()=>l});var o=n(810978),i=n(305514),r=n(251954);const s="addSymbolDialogHasOpenedKey";function l(e){(0,o.runOrSigninWithFeature)((()=>{(0,i.showWatchListsDialog)({addSymbols:e,onOpen:a})}),{feature:"watchList",source:"add symbol to watchlist"})}function a(){r.emit(s)}},482707:(e,t,n)=>{n.d(t,{createDwmAligner:()=>u,createTimeToBarTimeAligner:()=>d});var o=n(493239),i=n(931924),r=n(477786),s=n(831116),l=n(807780);const a=new s.SessionInfo("Etc/UTC","0000-0000:1234567");function u(e,t){if(!c()||!r.Interval.isDWM(e))return null;const n=new s.SessionInfo(t.timezone,t.session,t.session_holidays,t.corrections),i=(0,l.newBarBuilder)(e,n,a);return{timeToSessionStart:e=>i.tradingDayToSessionStart(e),timeToExchangeTradingDay:e=>{const t=(0,o.utc_to_cal)(n.timezone,e),i=n.spec.correctTradingDay(t);return(0,o.set_hms)(i,0,0,0,0,(0,o.get_timezone)("Etc/UTC")),i.getTime()}}}function c(){return!i.enabled("disable_resolution_rebuild")}function d(e,t){if(!c())return e=>e;const n=new s.SessionInfo(t.timezone,t.session,t.session_holidays,t.corrections),o=(0,l.newBarBuilder)(e,n,n,!1);return e=>o.alignTimeIfPossible(e)}},87913:(e,t,n)=>{n.r(t),n.d(t,{SelectPointMode:()=>o,activePointSelectionMode:()=>X,alignTo45Degrees:()=>Pe,
barTimesUnderCursor:()=>Z,beenSetLineToolLastPoint:()=>O,cancelLineTool:()=>ie,cancelledLineTool:()=>k,changeLineStyle:()=>pe,changeLineTool:()=>ce,changedLineStyle:()=>z,changedLineTool:()=>j,continueLineTool:()=>oe,continuedLineTool:()=>E,copiedLineTool:()=>G,copyLineTool:()=>ge,createLineTool:()=>ne,createdLineTool:()=>A,crosshairLock:()=>_,cursorTool:()=>D,drawOnAllCharts:()=>Re,drawOnAllChartsMode:()=>Ve,emojiTool:()=>R,finishChangingLineTool:()=>de,finishLineTool:()=>he,finishMovingLineTool:()=>ae,finishedChangingLineTool:()=>U,finishedLineTool:()=>H,finishedMovingLineTool:()=>K,hideAllDrawings:()=>Me,hideAllIndicators:()=>Le,hideMarksOnBars:()=>be,iconTool:()=>P,init:()=>we,isDirectionalMovementActive:()=>B,isStudyEditingNow:()=>Y,isToolCreatingNow:()=>N,isToolEditingNow:()=>x,isToolMovingNow:()=>C,lockDrawings:()=>_e,moveLineTool:()=>le,movedLineTool:()=>W,properties:()=>Ie,removeLineTool:()=>fe,removedLineTool:()=>q,resetToCursor:()=>y,restoreLineTool:()=>me,restoreLineToolState:()=>ve,restoredLineTool:()=>J,restoredLineToolState:()=>Q,runOnDrawingStateReady:()=>Se,setLineToolLastPoint:()=>re,startChangingLineTool:()=>ue,startMovingLineTool:()=>se,startedChangingLineTool:()=>$,startedMovingLineTool:()=>F,stickerTool:()=>V,tool:()=>b,toolIsCursor:()=>p,toolIsDemonstration:()=>m,toolIsEraser:()=>g,toolIsMeasure:()=>v});var o,i=n(650151),r=n(781567),s=n(890390),l=n(820028),a=n(751094),u=n(547465),c=n(62802),d=n(251954),f=n(345848);!function(e){e[e.None=0]="None",e[e.Replay=1]="Replay",e[e.Study=2]="Study"}(o||(o={}));const h=new Set(["cursor","arrow","dot","performance","demonstration"]);function p(e){return h.has(e)}function g(e){return"eraser"===e}function m(e){return"demonstration"===e}function v(e){return"measure"===e}function y(e=!1){if(!e&&T){if(T.childs().stayInDrawingMode.value())return}b.setValue(D.value())}let T=null,w=null,S=null,I=null,M=null,L=null;const _=new a.WatchedObject(null),b=new l.WatchedValue,P=new l.WatchedValue,R=new l.WatchedValue,V=new l.WatchedValue,D=new l.WatchedValue,N=new l.WatchedValue(!1),x=new l.WatchedValue(!1),C=new l.WatchedValue(!1),B=new l.WatchedValue(!1),A=new u.Delegate,E=new u.Delegate,k=new u.Delegate,O=new u.Delegate,F=new u.Delegate,W=new u.Delegate,K=new u.Delegate,$=new u.Delegate,j=new u.Delegate,U=new u.Delegate,q=new u.Delegate,H=new u.Delegate,z=new u.Delegate,G=new u.Delegate,J=new u.Delegate,Q=new u.Delegate,X=new l.WatchedValue(o.None),Y=new l.WatchedValue(!1),Z=new Map;function ee(e,t){const n=t||{value:!1};return t=>{n.value||(n.value=!0,e.fire(t),n.value=!1)}}const te={value:!1},ne=ee(A,te),oe=ee(E,te),ie=ee(k,te),re=ee(O,te),se=ee(F),le=ee(W),ae=ee(K),ue=ee($),ce=ee(j),de=ee(U),fe=ee(q),he=ee(H),pe=ee(z,te),ge=ee(G,te),me=ee(J),ve=ee(Q);let ye=!1,Te=[];function we(){if(ye)return;const e=c.getValue("chart.cursorPreference","cursor");b.setValue(p(e)?e:"cursor"),b.subscribe((e=>{p(e)?D.setValue(e):g(e)&&(0,f.trackEvent)("Chart cursors",e)}),{callWithLast:!0}),D.subscribe((e=>{(0,f.trackEvent)("Chart cursors",e),
e&&"performance"!==e&&!m(e)&&c.setValue("chart.cursorPreference",e)})),T=new s.DefaultProperty({defaultName:"drawings"}),w=(0,r.createPrimitiveProperty)(!1),S=(0,r.createPrimitiveProperty)(!1),I=(0,r.createPrimitiveProperty)(!1),M=(0,r.createPrimitiveProperty)(!c.getBool("BarsMarksContainer.visibile",!0)),L=(0,r.createPrimitiveProperty)(!1),b.subscribe((e=>{(0,d.emit)("onSelectedLineToolChanged")})),ye=!0,Te.forEach((e=>e())),Te=[]}function Se(e){ye?e():Te.push(e)}function Ie(){return(0,i.ensureNotNull)(T)}function Me(){return(0,i.ensureNotNull)(w)}function Le(){return(0,i.ensureNotNull)(S)}function _e(){return(0,i.ensureNotNull)(I)}function be(){return(0,i.ensureNotNull)(M)}function Pe(){return(0,i.ensureNotNull)(L)}function Re(){return Ie().childs().drawOnAllCharts}function Ve(){return Ie().childs().drawOnAllChartsMode}},702067:(e,t,n)=>{n.d(t,{LineToolCollectedProperty:()=>u,LineToolColorsProperty:()=>d,LineToolWidthsProperty:()=>c,MultipleLineColorsProperty:()=>p,MultipleLineWidthsProperty:()=>h});var o=n(735566),i=n(862150),r=n(421566);const s=(0,o.getLogger)("Chart.LineToolCollectedProperty");class l{applyValue(e,t){e.setValue(t)}}class a extends r.PropertyBase{constructor(e,t){super(),this._properties=e,e.forEach(((e,t)=>e.subscribe(this,((e,n)=>{this._listeners.fire(this,`${t}.${n}`)})))),this._showIfProperty=t}visible(){return!this._showIfProperty||this._showIfProperty?.value()}value(){if(0===this._properties.length)return s.logError("Incorrect call, should not request value of 0 properties"),"mixed";const e=this._properties[0].value();return 1===this._properties.length||this._properties.every((t=>t.value()===e))?e:"mixed"}setValueSilently(e){"mixed"!==e&&this._properties.forEach((t=>t.setValueSilently(e)))}hasChild(e){const t=parseInt(e,10);return!isNaN(t)&&t>=0&&t<this._properties.length}childCount(){return this._properties.length}childNames(){return this._properties.map(((e,t)=>t.toString()))}child(e){const t=parseInt(e,10);return!isNaN(t)&&t>=0&&t<this._properties.length?this._properties[t]:void 0}destroy(){this._properties.forEach((e=>e.unsubscribeAll(this))),this._listeners.destroy()}storeStateIfUndefined(){return!0}weakReference(){return(0,i.weakReference)(this)}ownership(){return(0,i.ownership)(this)}}class u extends a{setValue(e,t,n){if("mixed"===e)return;const o=n??new l;this._properties.forEach((t=>o.applyValue(t,e)))}}class c extends u{}class d extends u{firstColor(){return this._properties[0].value()}}class f extends(25242==n.j?a:null){setValue(e,t,n){if("mixed"===e)return;const o=n??new l;this._properties.forEach((t=>t.setValue(e,void 0,o)))}}class h extends(25242==n.j?f:null){}class p extends(25242==n.j?f:null){}},545372:(e,t,n)=>{n.d(t,{cloneLineTool:()=>O,createLineTool:()=>R,createLineToolProperties:()=>D,createStudyLineToolProperties:()=>N,ensureAllLineToolsLoadedForLayout:()=>b,initAllLineToolsFromContent:()=>P,initLineTool:()=>I,isBrushBasedLineTool:()=>C,isEditableTextLineTool:()=>E,isLineTool:()=>m.isLineTool,isTrading:()=>B,prepareLineToolPropertiesByOwnerSource:()=>V,
setNewToolProperties:()=>w,supportsPhantomMode:()=>x,tryFindStudyLineToolNameByStudyId:()=>k,unsetNewToolProperties:()=>S});var o=n(182433),i=n(650151),r=n(86441),s=n(735566),l=n(816541),a=n(700931),u=n(388741),c=n(529751),d=n(397007),f=n(323348),h=n(584878),p=n(349811),g=n(181227),m=n(63358);const v="DrawingCreations",y=.1;let T=null;function w(e,t,n){return null!==T&&T.tool===e&&T.toolData===t||(S(!0),T={properties:D(n.backgroundTheme().spawnOwnership(),e,!n.readOnly()),tool:e,toolData:t}),T.properties}function S(e){e&&T?.properties.destroy(),T=null}async function I(e){await(0,g.loadMetaInfoForLinetoolIfRequired)(e);const t=(0,g.asLineToolName)(e);(0,g.isLineToolLoaded)(t)||(0,c.isLineToolName)(t)&&await(0,g.loadLineTool)(t)}function M(e,t){const n="charts"in e?e.charts:[e];for(const e of n){for(const n of e.panes)for(const e of n.sources)t(e.type);e.lineToolsGroups?.groups.forEach((e=>{e.tools.forEach((e=>t(e)))}))}}class L extends Error{constructor(e,t){super(`Failed to load line tool: ${e}`),this.name="LineToolLoadError",this.toolName=e,this.originalError=t}}const _=(0,s.getLogger)("LineToolsSynchronizer");async function b(e){const t=new Set,n=e=>{(0,g.isAsyncGenericLineToolName)(e)&&t.add(e)};for(const t of e)M(t,n);const o=[...t],i=(await Promise.allSettled(o.map((e=>(0,g.ensureLineToolLoaded)(e).catch((t=>{throw new L(e,t)})))))).filter((e=>"rejected"===e.status));i.length>0&&i.forEach((e=>{const t=e.reason;_.logError(`Failed to load line tool: ${t.toolName}`)}))}async function P(e){if(!e)return;const t=new Set;M(e,(e=>{(0,c.isLineToolName)(e)&&t.add(e)})),await Promise.all(Array.from(t).map((e=>I(e))))}function R(e,t,n,o,r,s,l){(0,i.assert)((0,c.isLineToolName)(e),"Unknown line tool: "+e);const a=(0,g.asLineToolName)(e);let u;if((0,i.assert)((0,g.isLineToolLoaded)(a),`Line tool ${a} is not loaded`),r||n||null===T||T.tool!==e||(n=T.properties,S(!1)),(0,g.isAsyncStudyLineToolName)(a)){u=new((0,g.getLoadedLineTool)(a))(t,n,(0,i.ensureDefined)(o),r,s)}else{u=new((0,g.getLoadedLineTool)(a))(t,n,r,s)}return u.toolname=e,S(!0),void 0!==l&&(0,h.shouldAffectUser)(v,y)&&(0,f.trackChartDrawingCreation)(e,l),u}function V(e,t){const n=(0,i.ensureNotNull)(t.symbolSource()),o=n.symbolInfo(),r=o?(0,u.extractLineToolSymbolFromSymbolInfo)(o,n.symbol()):n.symbol();e.childs().symbol.setValue(r),n.model().currencyConversionEnabled()&&n.isConvertedToOtherCurrency()&&e.childs().currencyId.setValue(n.currency()),n.model().unitConversionEnabled()&&n.isConvertedToOtherUnit()&&e.childs().unitId.setValue(n.unit()),e.childs().symbolStateVersion.setValue(2),e.childs().zOrderVersion.setValue(2)}function D(e,t,n,o){(0,i.assert)((0,c.isLineToolName)(t),`${t} should be name of the line tool`);const r=(0,g.asLineToolName)(t);if((0,i.assert)((0,g.isLineToolLoaded)(r),`Line tool ${r} is not loaded`),(0,g.isAsyncStudyLineToolName)(r)){return(0,g.getLoadedLineTool)(r).createProperties(e,o)}return(0,g.getLoadedLineTool)(r).createProperties(e,o,n)}function N(e,t,n,o,r,s){(0,i.assert)((0,
c.isStudyLineToolName)(t),`${t} should be name of the study line tool`);const l=(0,g.asLineToolName)(t);if((0,g.isAsyncStudyLineToolName)(l)){return(0,g.getLoadedLineTool)(l).createPropertiesFromStudyMetaInfoAndState(n,o,r,s,e)}throw new Error(`Property creation is not implemented for study line tool ${t}`)}function x(e){(0,i.assert)((0,c.isLineToolName)(e),`${e} should be name of the line tool`);const t=(0,g.asLineToolName)(e);(0,i.assert)((0,g.isLineToolLoaded)(t),`Line tool ${t} is not loaded`);const n=(0,g.getLoadedLineTool)(t);return void 0!==n&&Boolean(n.supportPhantomMode)}function C(e){return e instanceof p.LineToolBrushBase}function B(e){return e instanceof a.LineToolTrading}const A=["editableTextStyle","editableText","editableTextProperties"];function E(e){return(0,o.default)(e)&&A.every((t=>t in e))}function k(e){let t=null;return e===d.lineToolsStudyIds.LineToolRegressionTrend?t="LineToolRegressionTrend":e===d.lineToolsStudyIds.LineToolVbPFixed?t="LineToolVbPFixed":e===d.lineToolsStudyIds.LineToolFixedRangeVolumeProfile&&(t="LineToolFixedRangeVolumeProfile"),t}function O(e,t,n,o,s){const a=t.toolname,u=t.properties().state();u.intervalsVisibilities=(0,l.mergeIntervalVisibilitiesDefaults)(u?.intervalsVisibilities);const c=D(e.backgroundTheme().spawnOwnership(),t.toolname,!e.readOnly(),u);c.childs().visible.setValue(!0);const d=(0,i.ensureNotNull)(t.ownerSource()),f=R(a,e,c,null,void 0,void 0,s);void 0!==o&&f.setId(o),f.setOwnerSource(d),f.toolname=a;const h=f.clonePositionOffset();if(t.isFixed()){const e=(0,i.ensureDefined)(t.fixedPoint()),o=n?e.add(new r.Point(h.xCoordOffset,h.yCoordOffset)):e;f.addFixedPoint(o)}const p=t.normalizedPoints(),g=n?function(e,t,n){const o=(0,i.ensureNotNull)(t.priceScale()),r=(0,i.ensureNotNull)(t.firstValue());return e.map((e=>{const t=e.price,i=o.priceToCoordinate(t,r)+n.yCoordOffset,s=o.coordinateToPrice(i,r),l=e.interval;return{time_t:e.time_t,price:s,offset:e.offset+n.barOffset,interval:l}}))}(p,d,h):p,m=t.points();return f.restorePoints(g,m),f.cloneData&&f.cloneData(t),f.recalculateStateByData&&f.recalculateStateByData(),f}},515072:(e,t,n)=>{n.d(t,{magnetEnabled:()=>m,magnetMode:()=>v,magnetSnapsToIndicators:()=>y,setIsMagnetEnabled:()=>T,setMagnetMode:()=>w,setMagnetSnapsToIndicators:()=>S});var o=n(890390),i=n(820028),r=n(590729),s=n(87913),l=n(529751),a=n(728136);const u=new i.WatchedValue(!1),c=new i.WatchedValue(r.MagnetMode.WeakMagnet),d=new i.WatchedValue(!1),f=(0,a.modifierPressed)(),h=(0,a.shiftPressed)();function p(){const e=f.value();if(h.value()&&(s.isToolEditingNow.value()||s.isToolCreatingNow.value()))return void u.setValue(!1);let t,n;if(s.activePointSelectionMode.value()===s.SelectPointMode.Replay)t=n=!1;else{const o=s.tool.value(),i=s.isStudyEditingNow.value()||s.activePointSelectionMode.value()===s.SelectPointMode.Study;t=e&&((0,l.isLineToolName)(o)||s.isToolEditingNow.value()||(0,s.toolIsMeasure)(o)||i),n=(0,s.properties)().childs().magnet.value()}c.setValue(!n&&t?r.MagnetMode.StrongMagnet:(0,s.properties)().childs().magnetMode.value()),
u.setValue(t?!n:n)}function g(){d.setValue((0,s.properties)().childs().magnetSnapsToIndicators.value())}function m(){return u}function v(){return c}function y(){return d}function T(e){(0,o.allowSavingDefaults)(!0),(0,s.properties)().childs().magnet.setValue(e),(0,o.allowSavingDefaults)(!1)}function w(e){(0,o.allowSavingDefaults)(!0),(0,s.properties)().childs().magnetMode.setValue(e),(0,s.properties)().childs().magnet.setValue(!0),(0,o.allowSavingDefaults)(!1)}function S(e){(0,o.allowSavingDefaults)(!0),(0,s.properties)().childs().magnetSnapsToIndicators.setValue(e),(0,o.allowSavingDefaults)(!1)}(0,s.runOnDrawingStateReady)((()=>{(0,s.properties)().childs().magnet.subscribe(null,p),(0,s.properties)().childs().magnetMode.subscribe(null,p),(0,s.properties)().childs().magnetSnapsToIndicators.subscribe(null,g),f.subscribe(p),h.subscribe(p),s.tool.subscribe(p),s.isToolEditingNow.subscribe(p),p(),g()}))},64262:(e,t,n)=>{n.d(t,{compareResolutions:()=>h.compareResolutions,convertResolutionsFromSettings:()=>_,getApplicableIntervalForFrequency:()=>h.getApplicableIntervalForFrequency,getDefaultResolution:()=>w,getMaxResolutionValue:()=>L,getResolutionByChartStyle:()=>S,getTranslatedResolution:()=>R,getTranslatedResolutionModel:()=>V,intervalIsSupported:()=>B,isAvailable:()=>y,isIntervalEnabled:()=>C,isResolutionMultiplierValid:()=>I,isSecondsEnabled:()=>N,mergeResolutions:()=>b,normalizeIntervalString:()=>v,setLastUsedResolution:()=>T,sortResolutions:()=>P});var o=n(536794),i=n(444372),r=n(477786),s=n(388741),l=n(62802),a=n(125226),u=n(167653),c=n(999102),d=n(931924),f=n(303999),h=n(321870);const p=[1,5,10,15,30,45],g=[1,10,100,1e3],m=(0,a.isFeatureEnabled)("custom_ticks");function v(e){return r.Interval.parse(e).value()}function y(e){const t=r.Interval.parse(e);if(t.isRange())return u.linking.range.value();if(!(0,f.isTicksEnabled)()&&t.isTicks())return!1;const n=t.value(),o=u.linking.dataFrequencyResolution.value();if(void 0!==o&&(0,h.compareResolutions)(n,o)<0)return!1;const i=u.linking.supportedResolutions.value();return void 0!==i?void 0!==i.find((e=>v(e)===n)):t.isTicks()?Boolean(u.linking.ticks.value()):t.isIntraday()?Boolean(u.linking.intraday.value()):t.isDWM()}function T(e){r.Interval.isValid(e)&&(r.Interval.isRange(e)?l.setValue("chart.lastUsedRangeResolution",e):l.setValue("chart.lastUsedTimeBasedResolution",e))}function w(e){return e?"100R":"1D"}function S(e,t,n){const o=s.isRangeStyle(e),i=r.Interval.isRange(t);return!o&&i?function(e){const t=l.getValue("chart.lastUsedTimeBasedResolution");if(void 0!==t&&r.Interval.isTimeBased(t))return t;let n="1D";for(const t of e){const e=r.Interval.parse(t);if(e.isTimeBased()){const t=e.value();if("1D"===t)return t;n=t}}return n}(n):o&&!i?function(e){const t=l.getValue("chart.lastUsedRangeResolution");if(void 0!==t&&r.Interval.isRange(t))return t;let n="100R";for(const t of e){const e=r.Interval.parse(t);if(e.isRange()){const t=e.value();if("100R"===t)return t;n=t}}return n}(n):t}function I(e){const{interval:t,guiResolutionKind:n}=r.Interval.parseExt(e);if(!t.isValid())return!1
;const o=t.multiplier();if(n===r.ResolutionKind.Seconds)return p.includes(o);if((0,f.isTicksEnabled)()&&n===r.ResolutionKind.Ticks)return!!m||g.includes(o);return(n===r.SpecialResolutionKind.Hours?o/60:o)<=M(n)}function M(e){const t=h.maxResolutionValues[e];return Number.isNaN(t)?1:t}function L(e){return M(r.Interval.parseExt(e).guiResolutionKind)}function _(e){return Array.isArray(e)?e:Object.keys(e).map(r.Interval.normalize).filter(o.notNull)}function b(...e){let t=[].concat(...e);return t=(0,c.uniq)(t.filter(I).map(v)),P(t)}function P(e){return e.sort(h.compareResolutions)}function R(e){const{multiplier:t,shortKind:n}=V(e);return`${t}${n}`}function V(e,t){const n=r.Interval.parse(e);let o=n.multiplier(),i=n.kind();if(!n.isValid()){if(t)return null;throw new TypeError(`Can't translate invalid interval: ${e}`)}return n.isMinuteHours()&&(o=Math.floor(o/60),i=r.SpecialResolutionKind.Hours),{multiplier:o.toString(),shortKind:D(i),hint:`${o} ${D(i,o)}`,mayOmitMultiplier:n.isDWM()&&1===o,mayOmitShortKind:n.isMinutes()&&!n.isMinuteHours()}}function D(e,t){if(!t)return{[r.ResolutionKind.Invalid]:"",[r.ResolutionKind.Ticks]:i.t(null,{context:"interval_short"},n(882901)),[r.ResolutionKind.Seconds]:i.t(null,{context:"interval_short"},n(968823)),[r.ResolutionKind.Minutes]:i.t(null,{context:"interval_short"},n(768430)),[r.SpecialResolutionKind.Hours]:i.t(null,{context:"interval_short"},n(438048)),[r.ResolutionKind.Days]:i.t(null,{context:"interval_short"},n(38691)),[r.ResolutionKind.Weeks]:i.t(null,{context:"interval_short"},n(307408)),[r.ResolutionKind.Months]:i.t(null,{context:"interval_short"},n(977995)),[r.ResolutionKind.Range]:i.t(null,{context:"interval_short"},n(993934))}[e];switch(e){case r.ResolutionKind.Ticks:return i.t(null,{plural:"ticks",count:t},n(111913));case r.ResolutionKind.Days:return i.t(null,{plural:"days",count:t},n(641807));case r.ResolutionKind.Weeks:return i.t(null,{plural:"weeks",count:t},n(448898));case r.ResolutionKind.Months:return i.t(null,{plural:"months",count:t},n(898393));case r.ResolutionKind.Seconds:return i.t(null,{plural:"seconds",count:t},n(33232));case r.ResolutionKind.Minutes:return i.t(null,{plural:"minutes",count:t},n(378318));case r.SpecialResolutionKind.Hours:return i.t(null,{plural:"hours",count:t},n(942328));case r.ResolutionKind.Range:return i.t(null,{plural:"ranges",count:t},n(189937));default:return e}}function N(){return!0}function x(e){return!(!(0,f.isTicksEnabled)()&&e.isTicks())}function C(e){return x(r.Interval.parse(e))}function B(e){if(d.enabled("allow_supported_resolutions_set_only")){const t=r.Interval.normalize(e);return null!==t&&y(t)}{const t=r.Interval.parse(e);if(!t.isValid()||!x(t))return!1;if(!d.enabled("custom_resolutions")){const t=r.Interval.normalize(e),n=window.ChartApiInstance.defaultResolutions().filter(C);if(!t||-1===n.indexOf(t))return!1}const n=u.linking.dataFrequencyResolution.value();if(void 0!==n&&(0,h.getApplicableIntervalForFrequency)(n,t.value())!==t.value())return!1;if(t.isRange())return u.linking.range.value()
;if(t.isTicks())return u.linking.ticks.value();if(t.isIntraday())return u.linking.intraday.value();{const e=u.linking.supportedResolutions.value();return!e||e.includes(t.value())}}}},87347:(e,t,n)=>{n.d(t,{emptyPineId:()=>g,isStudyDescriptor:()=>m,studyMetaInfoRepository:()=>w});var o=n(481251),i=n(444372),r=n(650151),s=n(807958),l=n(301320),a=n(886338),u=n(192809),c=n(870408),d=n(401843),f=n(735566),h=n(925049);const p=(0,f.getLogger)("Chart.Studies.StudyMetaInfoRepository",{color:"#606"}),g="";function m(e){return"object"==typeof e&&null!==e&&"type"in e&&("java"===e.type&&"studyId"in e||"pine"===e.type&&"pineId"in e)}class v{constructor(e){this._isReady=!1,this._studyVersioning=null,this._rawStudiesMetaInfo=[],this._rawStudiesMetaInfoDeferredPromise=null,this._javaStudiesMetaInfo=[],this._pineMetaInfoCache=[],this._compileErrors=new WeakMap,this._studiesMigrations=[],this._chartApi=e}async requestMetaInfo(){if(null===this._rawStudiesMetaInfoDeferredPromise){this._rawStudiesMetaInfoDeferredPromise=(0,h.createDeferredPromise)();const e=await this._chartApi.requestMetadata(),t=e.params[1].metainfo.slice();{const n=e.params[1].migrations.slice();this._processSiteMetaInfo(t,n)}this._studyVersioning=new u.StudyVersioning(this._javaStudiesMetaInfo,this._studiesMigrations),this._requestFinished(),this._rawStudiesMetaInfoDeferredPromise.resolve(this._rawStudiesMetaInfo)}return this._rawStudiesMetaInfoDeferredPromise.promise}async findById(e){this._isReady||await this.requestMetaInfo();const t=this._findStudyMetaInfo(e);if(null!==t){const e=this._compileErrors.get(t);return e?Promise.reject(e):Promise.resolve(t)}return"pine"===e.type?this._compilePine(e):Promise.reject(`unexpected study id=${e.studyId} with type=${e.type}`)}findByIdSync(e){return this._findStudyMetaInfo(e)}isReady(){return this._isReady}async findAllJavaStudies(){return this._isReady||await this.requestMetaInfo(),this._javaStudiesMetaInfo}studyVersioning(){return(0,r.ensureNotNull)(this._studyVersioning)}getInternalMetaInfoArray(){return this._javaStudiesMetaInfo}addPineMetaInfo(e,t){const n=T(this._pineMetaInfoCache,e);return t&&(!Array.isArray(t)||t.length>0)&&(t=Array.isArray(t)?new d.PineCompileFailErrorImpl({warnings:[],errors:t},e):t,this._compileErrors.set(n,t)),n}async getLatestMetaInfoForPineStudy(e,t){const n=await(0,c.requestUserScripts)();let o;if(n){const i=n.find((t=>t.scriptIdPart===e));if(i){const e=a.Version.parse(t),n=a.Version.parse(i.version);e.isLess(n)&&(o=i.version)}}if(void 0!==o){const t={type:"pine",pineId:e,pineVersion:o};return this.findById(t)}return null}_processMigrations(e){this._studiesMigrations=[];for(let t=0;e&&t<e.length;t++)this._studiesMigrations.push(e[t])}_processSiteMetaInfo(e,t){for(const t of e)u.StudyVersioning.verifyInputsMaxValue(t),y(t);this._rawStudiesMetaInfo=e,this._processMigrations(t);for(const e of this._rawStudiesMetaInfo)T(this._javaStudiesMetaInfo,e);s.StudyMetaInfo.overrideDefaults(this._javaStudiesMetaInfo)}_processLibraryMetaInfo(e){}_requestFinished(){this._isReady=!0}_findStudyMetaInfo(e){
return"java"===e.type?((0,r.assert)(0!==this._javaStudiesMetaInfo.length,"Java studies metainfo should be define here"),this._javaStudiesMetaInfo.find((t=>t.id===e.studyId))||null):this._pineMetaInfoCache.find((t=>t.scriptIdPart===e.pineId&&(void 0===e.pineVersion||(0,r.ensureDefined)(t.pine).version===e.pineVersion)))||null}_compilePine(e){p.logNormal(`Compiling ${e.pineId} script`);const t=(0,c.translateScriptAsync2)(e.pineId,e.pineVersion||"last").then((({metaInfo:t,compileErrors:n})=>(p.logNormal(`Compiling ${e.pineId} is successful`),this.addPineMetaInfo((0,r.ensureDefined)(t),n.errors))));return t.catch((t=>{t instanceof d.PineCompileFailErrorImpl&&this.addPineMetaInfo(t.metaInfo,t),p.logNormal(`Compiling ${e.pineId} is failed`)})),t}}function y(e){e.description_localized=i.t(e.description,{context:"study"},n(783477))}function T(e,t){const n=new s.StudyMetaInfo(t).state();(0,l.migrateMetaInfoAndPropState)(n);const o=new s.StudyMetaInfo(n);let i=!0;const r=e.findIndex((e=>e.id===o.id));if(-1===r)e.push(o);else{const t=e[r],n=void 0!==t.pine?a.Version.parse(t.pine.version):null,s=void 0!==o.pine?a.Version.parse(o.pine.version):null;null===s||null===n||s.isGreaterOrEqual(n)?(t.removeDefaults(),e[r]=o):i=!1}return i&&o.createDefaults(),o}const w=(0,o.default)((()=>new v(window.ChartApiInstance)))},960433:(e,t,n)=>{n.d(t,{TextWidthCache:()=>r,getMinTextMetrics:()=>i});var o=n(850117);function i(e){return{width:e.width,actualBoundingBoxAscent:e.actualBoundingBoxAscent,actualBoundingBoxDescent:e.actualBoundingBoxDescent,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}}class r{constructor(e=150){this._fontStyle="",this._cache=new o.CircularCacheBuffer(e,1.5)}reset(){this._cache.clear()}measureText(e,t){return this.getMetrics(e,t).width}yMidCorrection(e,t){const n=this.getMetrics(e,t);return void 0!==n.actualBoundingBoxAscent&&void 0!==n.actualBoundingBoxDescent?(n.actualBoundingBoxAscent-n.actualBoundingBoxDescent)/2:0}getMetrics(e,t){e.font!==this._fontStyle&&(this.reset(),this._fontStyle=e.font);const n=this._cache.get(t);if(void 0!==n)return n;const o=e.textBaseline;e.textBaseline="middle";const r=i(e.measureText(t));return e.textBaseline=o,0===r.width&&t.length||this._cache.set(t,r),r}}},374122:(e,t,n)=>{n.d(t,{setSupportPortalProblemsHost:()=>i,supportPortalProblemsHost:()=>o});let o="";function i(e){o=e}},904207:(e,t,n)=>{n.r(t),n.d(t,{getTranslatedSymbolDescription:()=>r});var o=n(444372);function i(e){const t=`#${e}-symbol-description`,i=o.t(t,void 0,n(956316));return i===t?null:i}function r(e){if(void 0!==e.pro_name){const t=i(e.pro_name);if(null!==t)return t;if(void 0!==e.short_name){const t=i(e.short_name);if(null!==t)return t}}return"en"!==e.language&&void 0!==e.local_description&&e.language===window.language||"en"===e.language&&void 0!==e.local_description&&e.language===window.language?e.local_description:e.description||""}}}]);